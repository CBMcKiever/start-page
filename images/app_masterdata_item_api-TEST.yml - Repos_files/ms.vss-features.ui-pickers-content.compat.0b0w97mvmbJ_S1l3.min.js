"use strict";define("VSSUI",["require","exports","react","OfficeFabric/DatePicker","OfficeFabric/Utilities","OfficeFabric/Persona","OfficeFabric/Pickers","VSS/Core/Util/String","OfficeFabric/Label","OfficeFabric/Callout","OfficeFabric/FocusZone","VSS/Core/TimerManagement","VSS/Core/Observable"],function(e,t,r,s,n,a,i,o,l,c,u,d,p){var m,g,f,h,y,v,S,P,C,b,k,E,x,F,T,_,N,D,I,R,V,w,A,U;m=t.ResourcesPickers={},Object.defineProperty(t,"__esModule",{value:!0}),t.ResourcesPickers.goToToday="Go to today",t.ResourcesPickers.invalidInputErrorMessage="Invalid date value specified.",t.ResourcesPickers.isRequiredErrorMessage="A valid date is required",t.ResourcesPickers.isOutOfBoundsErrorMessage="Selected date is not within the valid range",t.ResourcesPickers.sunday="Sunday",t.ResourcesPickers.monday="Monday",t.ResourcesPickers.tuesday="Tuesday",t.ResourcesPickers.wednesday="Wednesday",t.ResourcesPickers.thursday="Thursday",t.ResourcesPickers.friday="Friday",t.ResourcesPickers.saturday="Saturday",t.ResourcesPickers.sun="Sun",t.ResourcesPickers.mon="Mon",t.ResourcesPickers.tue="Tue",t.ResourcesPickers.wed="Wed",t.ResourcesPickers.thu="Thu",t.ResourcesPickers.fri="Fri",t.ResourcesPickers.sat="Sat",t.ResourcesPickers.january="January",t.ResourcesPickers.february="February",t.ResourcesPickers.march="March",t.ResourcesPickers.april="April",t.ResourcesPickers.may="May",t.ResourcesPickers.june="June",t.ResourcesPickers.july="July",t.ResourcesPickers.august="August",t.ResourcesPickers.september="September",t.ResourcesPickers.october="October",t.ResourcesPickers.november="November",t.ResourcesPickers.december="December",t.ResourcesPickers.jan="Jan",t.ResourcesPickers.feb="Feb",t.ResourcesPickers.mar="Mar",t.ResourcesPickers.apr="Apr",t.ResourcesPickers.jun="Jun",t.ResourcesPickers.jul="Jul",t.ResourcesPickers.aug="Aug",t.ResourcesPickers.sep="Sep",t.ResourcesPickers.oct="Oct",t.ResourcesPickers.nov="Nov",t.ResourcesPickers.dec="Dec",t.ResourcesPickers.prevMonthAriaLabel="Go to previous month",t.ResourcesPickers.nextMonthAriaLabel="Go to next month",t.ResourcesPickers.prevYearAriaLabel="Go to previous year",t.ResourcesPickers.nextYearAriaLabel="Go to next year",function(e){g=t.ComponentsDateTimePickerDateTimePicker={},Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function a(r){var s=e.call(this,r)||this;return s._value=new Date,s.onAdditionalInfoChange=function(e,t){var r=s.props.parseTimeFromString,n=void 0===r?s._defaultParseTimeFromString:r;s.setState({dateValue:t,dateErrorMessage:s._getErrorMessage(t)});var a=n(t);a&&(s._value.setHours(a.getHours(),a.getMinutes(),a.getSeconds()),s.props.onValueChanged&&s.props.onValueChanged(s._value))},s._getErrorMessage=function(e){var r=s.props.parseTimeFromString;return(void 0===r?s._defaultParseTimeFromString:r)(e)?"":t.VSSResourcesVSSUI.DateTimePicker_CannotParseTime},r&&("value"in r&&n.warn("'value' will be ignored. Use 'defaultValue'."),"onSelectDate"in r&&n.warn("'onSelectDate' will be ignored."),s._value=r.defaultValue,s.state={dateValue:s.props.formatTime?s.props.formatTime(s._value):s._defaultFormatTime(s._value),dateErrorMessage:""}),s}return __extends(a,e),a.prototype.render=function(){var e=this,n=this.state,a=n.dateValue,i=n.dateErrorMessage;return this.props.dateOnly?r.createElement(s.DatePicker,Object.assign({"aria-label":t.VSSResourcesVSSUI.DateTimePicker_DateFieldAriaLabel},this.props)):r.createElement("div",{className:"vss-DateTimePicker"},r.createElement("div",{className:"vss-DateTimePicker--dateField"},r.createElement(s.DatePicker,Object.assign({className:this.props.dateFieldClassName,isMonthPickerVisible:!1},this.props,{value:this._value,ariaLabel:this.props.dateAriaLabel||t.VSSResourcesVSSUI.DateTimePicker_DateFieldAriaLabel,maxDate:this.props.maxDate,minDate:this.props.minDate,onSelectDate:function(t){e._value&&e._value.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e.props.onValueChanged&&e.props.onValueChanged(e._value)}}))),r.createElement("div",{className:"vss-DateTimePicker--timeField"},r.createElement(t.TextField.TextFieldWithMessage,{className:this.props.timeFieldClassName,textFieldProps:{value:a,onChange:this.onAdditionalInfoChange,ariaLabel:this.props.timeAriaLabel||t.VSSResourcesVSSUI.DateTimePicker_TimeFieldAriaLabel},message:i,error:""!==i})))},a.prototype._defaultParseTimeFromString=function(e){var t=Date.parse(e);return t?new Date(t):null},a.prototype._defaultFormatTime=function(e){return e?e.toLocaleTimeString():""},a}(r.Component);t.ComponentsDateTimePickerDateTimePicker.DateTimePicker=a}(),function(e){f=t.ComponentsDateTimePickerDateTimePickerFilterBarItem={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=e.apply(this,arguments)||this;return t._onSelectionChanged=function(e){t.setFilterValue({value:e})},t}return __extends(t,e),t.prototype.focus=function(){return!1},t.prototype.componentWillMount=function(){this.props.filter.setFilterItemState(this.props.filterItemKey,{value:this.props.defaultValue})},t.prototype.render=function(){return r.createElement(g.DateTimePicker,{defaultValue:this.props.defaultValue,formatDate:this.props.formatDate,formatTime:this.props.formatTime,parseTimeFromString:this.props.parseTimeFromString,onValueChanged:this._onSelectionChanged})},t.prototype.onFilterChanged=function(e){},t}(t.FilterBarItem.FilterBarItem);t.ComponentsDateTimePickerDateTimePickerFilterBarItem.DateTimePickerFilterBarItem=s}(),function(e){h=t.ComponentsDateTimePickerHelpers={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsDateTimePickerHelpers.datePickerStrings=function(){return{months:[m.january,m.february,m.march,m.april,m.may,m.june,m.july,m.august,m.september,m.october,m.november,m.december],shortMonths:[m.jan,m.feb,m.mar,m.apr,m.may,m.jun,m.jul,m.aug,m.sep,m.oct,m.nov,m.dec],days:[m.sunday,m.monday,m.tuesday,m.wednesday,m.thursday,m.friday,m.saturday],shortDays:[m.sun,m.mon,m.tue,m.wed,m.thu,m.fri,m.sat],goToToday:m.goToToday,prevMonthAriaLabel:m.prevMonthAriaLabel,nextMonthAriaLabel:m.nextMonthAriaLabel,prevYearAriaLabel:m.prevYearAriaLabel,nextYearAriaLabel:m.nextYearAriaLabel}}}(),function(e){function r(r){for(var s in r)t[e].hasOwnProperty(s)||(t[e][s]=r[s])}y=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),r(g),r(f),r(h)}("ComponentsDateTimePickerindex"),function(e){v=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(r){for(var s in r)t[e].hasOwnProperty(s)||(t[e][s]=r[s])}(y)}("DateTimePicker"),function(e){function s(e,t){return e?t?e>t?e:t:e:t}S=t.ComponentsDateTimeRangePickerDateTimeRangePicker={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function n(t){var r=e.call(this,t)||this;return t&&(r._startTime=t.defaultStartTime,r._endTime=t.defaultEndTime),r}return __extends(n,e),n.prototype.render=function(){var e,n,a=this,i=this.props,o=i.maxDate,l=i.minDate;return r.createElement("div",{className:"vss-DateTimeRangePicker"},r.createElement("div",{className:"vss-DateTimeRangePicker--container"},r.createElement("span",{className:"vss-DateTimeRangePicker--label"},t.VSSResourcesVSSUI.DateTimeRangePicker_Start),r.createElement(v.DateTimePicker,{dateFieldClassName:"startDate",timeFieldClassName:"startTime",defaultValue:this._startTime,maxDate:(e=o,n=this._endTime,e?n?e<n?e:n:e:n),minDate:l,disableAutoFocus:!0,formatDate:this.props.formatDate,formatTime:this.props.formatTime,parseTimeFromString:this.props.parseTimeFromString,onValueChanged:function(e){a._startTime=e,a.props.onValueChanged&&a.props.onValueChanged(a._startTime,a._endTime)},dateAriaLabel:this.props.startDateAriaLabel||t.VSSResourcesVSSUI.DateTimeRangePicker_StartDate,timeAriaLabel:this.props.startTimeAriaLabel||t.VSSResourcesVSSUI.DateTimeRangePicker_StartTime})),r.createElement("div",{className:"vss-DateTimeRangePicker--container"},r.createElement("span",{className:"vss-DateTimeRangePicker--label"},t.VSSResourcesVSSUI.DateTimeRangePicker_End),r.createElement(v.DateTimePicker,{dateFieldClassName:"endDate",timeFieldClassName:"endTime",defaultValue:this._endTime,maxDate:o,minDate:s(l,this._startTime),disableAutoFocus:!0,formatDate:this.props.formatDate,formatTime:this.props.formatTime,parseTimeFromString:this.props.parseTimeFromString,onValueChanged:function(e){a._endTime=e,a.props.onValueChanged&&a.props.onValueChanged(a._startTime,a._endTime)},dateAriaLabel:this.props.endDateArialLabel||t.VSSResourcesVSSUI.DateTimeRangePicker_EndDate,timeAriaLabel:this.props.endTimeAriaLabel||t.VSSResourcesVSSUI.DateTimeRangePicker_EndTime})))},n}(r.Component);t.ComponentsDateTimeRangePickerDateTimeRangePicker.DateTimeRangePicker=n}(),function(e){P=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(r){for(var s in r)t[e].hasOwnProperty(s)||(t[e][s]=r[s])}(S)}("ComponentsDateTimeRangePickerindex"),function(e){function r(e){return{imageUrl:e.image,text:e.displayName,showSecondaryText:!!e.displayName&&""!==e.displayName,secondaryText:s(e),size:a.PersonaSize.extraExtraSmall}}function s(e){return!e.isHosted&&e.samAccountName&&e.samAccountName.trim()?(e.scopeName&&e.scopeName.trim()?e.scopeName+"\\":"")+e.samAccountName:e.signInAddress&&e.signInAddress.trim()?e.signInAddress:e.mail&&e.mail.trim()?e.mail:e.mailNickname&&e.mailNickname.trim()?e.mailNickname:""}C=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].convertIdentityToPersona=r,t[e].convertIdentityListToPersonaList=function(e){var t=e,s=e;return Array.isArray(t)?t.map(function(e){return r(e)}):s&&s.then?s.then(function(e){return e.map(function(e){return r(e)})}):null},t[e].getSignInAddress=s,t[e].isUser=function(e){return"user"===e.entityType.toLocaleLowerCase()}}("ComponentsPeoplePickerPeoplePickerUtils"),function(e){b=t.ComponentsPeoplePickerPeoplePicker={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function s(){var s=e.apply(this,arguments)||this;return s._peoplePicker=r.createRef(),s._getfilteredPersonas=function(e){return C.convertIdentityListToPersonaList(s.props.pickerProvider.onFilterIdentities(e))},s._resultsFooter=function(){return s._peoplePicker.current&&s._peoplePicker.current.items.length>0?r.createElement("div",{className:"vss-NoIdentitiesFound"},o.format(t.VSSResourcesVSSUI.PeoplePickerResultsFoundText,s._peoplePicker.current.items)):null},s._onRenderNoIdentitiesFound=function(){return r.createElement("div",{className:"vss-NoIdentitiesFound"},t.VSSResourcesVSSUI.PeoplePickerNoResultsText)},s}return __extends(s,e),s.prototype.render=function(){var e={onRenderNoResultFound:this._onRenderNoIdentitiesFound,resultsFooter:this._resultsFooter},s={placeholder:this.props.placeholder||t.VSSResourcesVSSUI.PeoplePickerPlaceholderText};return r.createElement(i.NormalPeoplePicker,{ref:this._peoplePicker,className:"vss-PeoplePicker",pickerSuggestionsProps:e,inputProps:s,resolveDelay:200,searchingText:t.VSSResourcesVSSUI.PeoplePickerLoadingText,onResolveSuggestions:this._getfilteredPersonas})},s}(r.Component);t.ComponentsPeoplePickerPeoplePicker.PeoplePicker=s}(),function(e){k=t.ComponentsPeoplePickerSuggestions={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return __extends(s,e),s.prototype.render=function(){var e=this.props,s=e.suggestionModel,n=e.renderSuggestion,a=e.onClick,i=e.className,o=e.onRemoveItem,l=e.isSelectedOverride,c=e.removeButtonAriaLabel;return r.createElement("div",{className:t.Util.css("vss-suggestionsItem","flex-row flex-grow",(s.selected||l)&&"is-suggested vss-suggestionsItemIsSuggested",i)},r.createElement("div",{onClick:a,className:"ms-Suggestions-itemButton itemButton flex-row flex-grow"},n(s.item,this.props)),this.props.showRemoveButton?r.createElement(t.Button.Button,{subtle:!0,iconProps:{iconName:"Cancel",style:{fontSize:"12px"}},ariaLabel:c,onClick:o,className:t.Util.css("ms-Suggestions-closeButton","closeButton")}):null)},s}(r.Component);t.ComponentsPeoplePickerSuggestions.SuggestionsItem=s;var n=function(e){function n(t){var n=e.call(this,t)||this;return n._forceResolveButton=r.createRef(),n._searchForMoreButton=r.createRef(),n._selectedElement=r.createRef(),n.SuggestionsItemOfProperType=s,n.tryHandleKeyDown=function(e,t){var r=!1,s=null,a=n.state.selectedActionType,i=n.props.suggestions.length;if(40===e)switch(a){case 1:i>0?(n._refocusOnSuggestions(e),s=0):s=n._searchForMoreButton.current?2:1;break;case 2:n._forceResolveButton.current?s=1:i>0?(n._refocusOnSuggestions(e),s=0):s=2;break;case 0:-1===t&&n._forceResolveButton.current&&(s=1)}else if(38===e)switch(a){case 1:n._searchForMoreButton.current?s=2:i>0&&(n._refocusOnSuggestions(e),s=0);break;case 2:i>0?(n._refocusOnSuggestions(e),s=0):n._forceResolveButton.current&&(s=1);break;case 0:-1===t&&n._searchForMoreButton.current&&(s=2)}return null!==s&&(n.setState({selectedActionType:s}),r=!0),r},n._getMoreResults=function(){n.props.onGetMoreResults&&n.props.onGetMoreResults()},n._forceResolve=function(){n.props.createGenericItem&&n.props.createGenericItem()},n._shouldShowForceResolve=function(){return!!n.props.showForceResolve&&n.props.showForceResolve()},n._onClickTypedSuggestionsItem=function(e,t){return function(r){n.props.onSuggestionClick(r,e,t)}},n._refocusOnSuggestions=function(e){"function"==typeof n.props.refocusSuggestions&&n.props.refocusSuggestions(e)},n._onRemoveTypedSuggestionsItem=function(e,t){return function(r){(0,n.props.onSuggestionRemove)(r,e,t),r.stopPropagation()}},n.state={selectedActionType:0},n}return __extends(n,e),n.prototype.componentDidMount=function(){this.scrollSelected(),this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null},n.prototype.componentDidUpdate=function(){this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current&&(this.scrollSelected(),this.activeSelectedElement=this._selectedElement.current)},n.prototype.render=function(){var e=this.props,s=e.forceResolveText,n=e.mostRecentlyUsedHeaderText,a=e.searchForMoreText,i=e.className,o=e.moreSuggestionsAvailable,l=e.noResultsFoundText,c=e.suggestions,u=e.isLoading,d=e.isSearching,p=e.loadingText,m=e.onRenderNoResultFound,g=e.searchingText,f=e.isMostRecentlyUsedVisible,h=e.resultsMaximumNumber,y=e.resultsFooterFull,v=e.resultsFooter,S=e.isResultsFooterVisible,P=void 0===S||S,C=e.suggestionsAvailableAlertText,b=function(){return l?r.createElement("div",{role:"alert",className:"ms-Suggestions-none vss-suggestionsNone"},l):null},k=e.suggestionsHeaderText;f&&n&&(k=n);var E=void 0;P&&(E=c.length>=h?y:v);var x=!(c&&c.length||u);return r.createElement("div",{className:t.Util.css("ms-Suggestions",i||"","vss-suggestions")},k?r.createElement("div",{className:t.Util.css("ms-Suggestions-title","vss-suggestionsTitle")},k):null,s&&this._shouldShowForceResolve()&&r.createElement(t.Button.Button,{ref:this._forceResolveButton,className:t.Util.css("ms-forceResolve-button actionButton",1===this.state.selectedActionType&&"is-selected buttonSelected"),onClick:this._forceResolve},s),u&&r.createElement(t.Spinner.Spinner,{className:"ms-Suggestions-spinner vss-suggestionsSpinner",label:p}),x?m?m(void 0,b):b():this._renderSuggestions(),a&&o&&r.createElement(t.Button.Button,{ref:this._searchForMoreButton,className:t.Util.css("ms-SearchMore-button","actionButton",2===this.state.selectedActionType&&"is-selected buttonSelected"),iconProps:{iconName:"Search"},onClick:this._getMoreResults},a),d?r.createElement(t.Spinner.Spinner,{className:"ms-Suggestions-spinner vss-suggestionsSpinner",label:g}):null,!E||o||f||d?null:r.createElement("div",{className:"ms-Suggestions-title vss-suggestionsTitle"},E(this.props)),r.createElement("span",{role:"alert","aria-live":"polite",className:"ms-Suggestions-suggestionsAvailable vss-suggestionsAvailable"},!u&&!d&&c&&c.length>0&&C?C:null))},n.prototype.hasSuggestedAction=function(){return void 0!==this._searchForMoreButton.current||void 0!==this._forceResolveButton.current},n.prototype.hasSuggestedActionSelected=function(){return 0!==this.state.selectedActionType},n.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case 1:this._forceResolve();break;case 2:this._getMoreResults()}},n.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:1}):this._searchForMoreButton.current&&this.setState({selectedActionType:2})},n.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:2}):this._forceResolveButton.current&&this.setState({selectedActionType:1})},n.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()},n.prototype.scrollSelected=function(){this._selectedElement.current&&void 0!==this._selectedElement.current.scrollIntoView&&this._selectedElement.current.scrollIntoView(!1)},n.prototype._renderSuggestions=function(){var e=this,t=this.props,s=t.onRenderSuggestion,n=t.removeSuggestionAriaLabel,a=t.suggestionsItemClassName,i=t.resultsMaximumNumber,o=t.showRemoveButtons,l=t.suggestionsContainerAriaLabel,c=this.props.suggestions,u=this.SuggestionsItemOfProperType;return i&&(c=c.slice(0,i)),r.createElement("div",{className:"ms-Suggestions-container vss-suggestionsContainer",id:"suggestion-list",role:"list","aria-label":l},c.map(function(t,i){return r.createElement("div",{ref:t.selected?e._selectedElement:"",key:t.item.key?t.item.key:i,id:"sug-"+i,role:"listitem","aria-label":t.ariaLabel},r.createElement(u,{id:"sug-item"+i,suggestionModel:t,renderSuggestion:s,onClick:e._onClickTypedSuggestionsItem(t.item,i),className:a,showRemoveButton:o,removeButtonAriaLabel:n,onRemoveItem:e._onRemoveTypedSuggestionsItem(t.item,i)}))}))},n}(r.Component);t.ComponentsPeoplePickerSuggestions.Suggestions=n}(),function(e){function r(r){for(var s in r)t[e].hasOwnProperty(s)||(t[e][s]=r[s])}E=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),r(b),r(C),r(k)}("ComponentsPeoplePickerindex"),function(e){x=t.ComponentsPersonaCardContactCard={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return r.createElement("div",null,r.createElement("div",{className:this.props.padTop?"contact-card-line-top":"contact-card-line"},r.createElement("div",{className:"contact-card-span-label"},this.props.label),r.createElement("div",{className:"contact-card-span-content"},this.props.link&&this.props.content&&r.createElement("a",{className:"profile-card-tab-element",href:this.props.link},this.props.content),!this.props.link&&this.props.content)),r.createElement("div",{style:{clear:"both"}}))},t}(r.Component);t.ComponentsPersonaCardContactCard.ContactCardContactLine=s;var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.render=function(){var e=this.props.identity;return r.createElement("div",{className:"contact-or-organization-card-wrapper"},r.createElement("div",{className:"contact-card-header-wrapper"},r.createElement("div",{className:"body-m"},r.createElement(l.Label,null,t.VSSResourcesVSSUI.PeoplePickerContactInfo))),r.createElement("div",{className:"contact-card-info-wrapper"},r.createElement(s,{label:t.VSSResourcesVSSUI.PeoplePickerEmail,content:e.mail,link:"mailto:"+e.mail}),r.createElement(s,{label:t.VSSResourcesVSSUI.PeoplePickerPhoneNumber,content:e.telephoneNumber,link:"mailto:"+e.telephoneNumber}),r.createElement(s,{label:t.VSSResourcesVSSUI.PeoplePickerLocation,content:e.physicalDeliveryOfficeName}),r.createElement(s,{label:t.VSSResourcesVSSUI.PeoplePickerTitle,content:e.jobTitle,padTop:!0}),r.createElement(s,{label:t.VSSResourcesVSSUI.PeoplePickerDepartment,content:e.department}),r.createElement(s,{label:t.VSSResourcesVSSUI.PeoplePickerAlias,content:e.mailNickname})))},n}(r.Component);t.ComponentsPersonaCardContactCard.ContactCard=n}(),function(e){F=t.ComponentsPersonaCardDefaultCard={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return __extends(s,e),s.prototype.render=function(){return r.createElement("div",{className:"default-card-contact-line-wrapper"},r.createElement(l.Label,{className:"default-card-contact-line"},r.createElement(t.VssIcon.VssIcon,{iconName:this.props.iconName,className:"default-card-contact-line-label"}),this.props.link&&r.createElement("a",{href:this.props.link,className:"default-card-contact-line-link profile-card-tab-element"},this.props.content),!this.props.link&&r.createElement("span",{className:"default-card-contact-line-no-link"},this.props.content)))},s}(r.Component);t.ComponentsPersonaCardDefaultCard.DefaultCardContactLine=s;var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.componentDidMount=function(){this.props.setFocus&&this.props.setFocus()},n.prototype.render=function(){var e=this,n=this.props,a=n.identity,i=n.isPreviousHeader,o={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.jobTitle,tertiaryText:this.props.identity.department},c=r.createElement("div",{className:"flex-row"},r.createElement(t.VssPersona.VssPersona,{className:"persona-main",displayName:o.primaryText,imageUrl:o.imageUrl?o.imageUrl+"?size=2":void 0,size:"extra-large",suppressPersonaCard:!0}),r.createElement("div",{className:"flex-column flex-grow persona-card-name"},r.createElement("div",{className:"persona-main-text-primary title-s"},o.primaryText),""===o.secondaryText?void 0:r.createElement("div",{className:"persona-main-text-secondary"},o.secondaryText),""===o.tertiaryText?void 0:r.createElement("div",{className:"persona-main-text-tertiary"},o.tertiaryText))),u=null;if(this.props.manager){var d=this.props.manager,p={imageUrl:d.image,primaryText:d.displayName,secondaryText:d.jobTitle,tertiaryText:d.department};u=r.createElement("div",{className:"persona-list-manager-element profile-card-tab-element flex-row","aria-label":d.displayName,key:d.entityId+d.signInAddress,onClick:function(){e.props.onClickEntity(d)},"data-is-focusable":!0,role:"button"},r.createElement(t.VssPersona.VssPersona,{displayName:p.primaryText,imageUrl:p.imageUrl,size:"medium-plus",suppressPersonaCard:!0}),r.createElement("div",{className:"flex-column flex-grow persona-card-name"},r.createElement("div",{className:"persona-list-element-text-primary"},p.primaryText),""===p.secondaryText?void 0:r.createElement("div",{className:"persona-list-element-text-secondary"},p.secondaryText)))}return r.createElement("div",{className:i?"default-card-with-header":"default-card-without-header"},c,r.createElement("div",null,(a.mail||a.telephoneNumber||a.physicalDeliveryOfficeName)&&r.createElement("div",{className:"default-card-contact-info-wrapper"},r.createElement("hr",{className:"hr-main"}),r.createElement("div",{className:"default-card-header-wrapper"},r.createElement("span",{className:"default-card-header pointer profile-card-tab-element",onClick:function(){e.props.showContactCard()},"aria-label":t.VSSResourcesVSSUI.PeoplePickerContact,"data-is-focusable":!0,role:"button"},r.createElement(l.Label,{className:"pointer"},r.createElement("b",{className:"default-card-header-space"},t.VSSResourcesVSSUI.PeoplePickerContact),r.createElement(t.VssIcon.VssIcon,{iconType:0,iconName:"ChevronRight"})))),r.createElement("div",{className:"default-card-contact-info-container"},a.mail&&r.createElement(s,{iconName:"Mail",content:a.mail,link:"mailto:"+a.mail}),a.mail&&r.createElement(s,{iconName:"Chat",content:t.VSSResourcesVSSUI.PeoplePickerStartChat,link:"sip:"+a.mail}),a.telephoneNumber&&r.createElement(s,{iconName:"Phone",content:a.telephoneNumber,link:"tel:"+a.telephoneNumber}),a.physicalDeliveryOfficeName&&r.createElement(s,{iconName:"POI",content:a.physicalDeliveryOfficeName}))),this._renderDirectManagerElement(u)))},n.prototype._renderDirectManagerElement=function(e){var s=this;return e?r.createElement("div",{className:"default-card-direct-manager-wrapper"},r.createElement("hr",{className:"hr-secondary"}),r.createElement("div",{className:"default-card-header-wrapper"},r.createElement("span",{className:"default-card-header pointer profile-card-tab-element",onClick:function(){s.props.showOrganizationCard()},"aria-label":t.VSSResourcesVSSUI.PeoplePickerOrganization,"data-is-focusable":!0,role:"button"},r.createElement(l.Label,{className:"pointer"},r.createElement("b",{className:"default-card-header-space"},t.VSSResourcesVSSUI.PeoplePickerOrganization),r.createElement(t.VssIcon.VssIcon,{iconType:0,iconName:"ChevronRight"})))),r.createElement("div",{className:"default-card-direct-manager"},r.createElement("div",{className:"default-card-header-reportsto"},t.VSSResourcesVSSUI.PeoplePickerReportsTo),e)):null},n}(r.Component);t.ComponentsPersonaCardDefaultCard.DefaultCard=n}(),function(e){T=t.ComponentsPersonaCardDefaultAbridgedCard={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return __extends(s,e),s.prototype.render=function(){var e={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName},s=r.createElement("div",{className:"flex-row"},r.createElement(t.VssPersona.VssPersona,{className:"persona-main",displayName:e.primaryText,imageUrl:e.imageUrl?e.imageUrl+"?size=2":void 0,size:"extra-large",suppressPersonaCard:!0}),r.createElement("div",{className:"flex-column flex-grow persona-card-name"},r.createElement("div",{className:"persona-main-text-primary"},e.primaryText)));return r.createElement("div",{className:"default-card-abridged flex-row"},s,this._verifySignInAddress()&&r.createElement("div",null,r.createElement("div",{className:"default-card-contact-info-wrapper"},r.createElement("hr",{className:"hr-main"}),r.createElement("div",{className:"default-card-header-wrapper"},r.createElement("span",{className:"default-card-header"},r.createElement(l.Label,null,r.createElement("b",{className:"default-card-header-space"},t.VSSResourcesVSSUI.PeoplePickerContact)))),r.createElement("div",{className:"default-card-contact-info-container"},r.createElement(F.DefaultCardContactLine,{iconName:"Mail",content:this.props.identity.signInAddress,link:"mailto:"+this.props.identity.signInAddress}),r.createElement(F.DefaultCardContactLine,{iconName:"Chat",content:t.VSSResourcesVSSUI.PeoplePickerStartChat,link:"sip:"+this.props.identity.signInAddress})))))},s.prototype._verifySignInAddress=function(){if(!this.props.identity.signInAddress)return!1;return!!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(this.props.identity.signInAddress)},s}(r.Component);t.ComponentsPersonaCardDefaultAbridgedCard.DefaultAbridgedCard=s}(),function(e){_=t.ComponentsPersonaCardDefaultSimpleCard={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return __extends(s,e),s.prototype.render=function(){var e={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.scopeName&&this.props.identity.signInAddress?this.props.identity.scopeName+"\\"+this.props.identity.signInAddress:this.props.identity.signInAddress?this.props.identity.signInAddress:""};return r.createElement("div",{className:"default-card-simple flex-row"},r.createElement("div",{className:"flex-row"},r.createElement(t.VssPersona.VssPersona,{className:"persona-main",displayName:e.primaryText,imageUrl:e.imageUrl?e.imageUrl+"?size=2":void 0,suppressPersonaCard:!0,size:"extra-large"}),r.createElement("div",{className:"flex-column flex-grow persona-card-name"},r.createElement("div",{className:"persona-main-text-primary"},e.primaryText),""===e.secondaryText?void 0:r.createElement("div",{className:"persona-main-text-secondary"},e.secondaryText))))},s}(r.Component);t.ComponentsPersonaCardDefaultSimpleCard.DefaultSimpleCard=s}(),function(e){N=t.ComponentsPersonaCardOrganizationCard={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return __extends(s,e),s.prototype.render=function(){var e=this.createManagerChainPersonaElements(),s=this.createDirectReportsPersonaElements();return r.createElement("div",{className:"contact-or-organization-card-wrapper"},r.createElement("div",{className:"organization-card-content"},r.createElement("div",{className:"organization-card-header-wrapper"},r.createElement(l.Label,null,t.VSSResourcesVSSUI.PeoplePickerOrganization)),r.createElement("div",{className:"organization-card-manager-chain-wrapper"},e),s.length>0&&r.createElement("div",{className:"organization-card-direct-reports-wrapper"},r.createElement(l.Label,{className:"organization-card-direct-reports-label"},o.format(t.VSSResourcesVSSUI.PeoplePickerReportingTo,this.props.identity.displayName,this.props.directReportList.length)),s)))},s.prototype.createManagerChainPersonaElements=function(){var e=this,s=this,n=this.props.managerList?this.props.managerList.map(function(e){var n={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return r.createElement("div",{className:"persona-list-element profile-card-tab-element flex-row","aria-label":e.displayName,key:e.entityId+e.signInAddress,onClick:function(){s.props.onClickEntity(e)},"data-is-focusable":!0,role:"button"},r.createElement(t.VssPersona.VssPersona,{displayName:n.primaryText,imageUrl:n.imageUrl,size:"medium-plus",suppressPersonaCard:!0}),r.createElement("div",{className:"flex-column flex-grow persona-card-name"},r.createElement("div",{className:"persona-list-element-text-primary"},n.primaryText),""===n.secondaryText?void 0:r.createElement("div",{className:"persona-list-element-text-secondary"},n.secondaryText)))}):[],a={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.jobTitle,tertiaryText:this.props.identity.department};return n.push(r.createElement("div",{className:"persona-list-element profile-card-tab-element flex-row","aria-label":this.props.identity.displayName,key:this.props.identity.entityId+this.props.identity.signInAddress,onClick:function(){s.props.onClickEntity(e.props.identity)},"data-is-focusable":!0,role:"button"},r.createElement(t.VssPersona.VssPersona,{displayName:a.primaryText,imageUrl:a.imageUrl,size:"medium-plus",suppressPersonaCard:!0}),r.createElement("div",{className:"flex-column flex-grow persona-card-name"},r.createElement("div",{className:"persona-list-element-text-primary"},a.primaryText),""===a.secondaryText?void 0:r.createElement("div",{className:"persona-list-element-text-secondary"},a.secondaryText)))),n},s.prototype.createDirectReportsPersonaElements=function(){var e=this;return this.props.directReportList?this.props.directReportList.map(function(s){var n={imageUrl:s.image,primaryText:s.displayName?s.displayName:"",secondaryText:s.jobTitle?s.jobTitle:"",tertiaryText:s.department?s.department:""};return r.createElement("div",{className:"persona-list-element profile-card-tab-element flex-row","aria-label":s.displayName,key:s.entityId+s.signInAddress,onClick:function(){e.props.onClickEntity(s)},"data-is-focusable":!0,role:"button"},r.createElement(t.VssPersona.VssPersona,{displayName:n.primaryText,imageUrl:n.imageUrl,size:"medium-plus",suppressPersonaCard:!0}),r.createElement("div",{className:"flex-column flex-grow persona-card-name"},r.createElement("div",{className:"persona-list-element-text-primary"},n.primaryText),""===n.secondaryText?void 0:r.createElement("div",{className:"persona-list-element-text-secondary"},n.secondaryText)))}):[]},s}(r.Component);t.ComponentsPersonaCardOrganizationCard.OrganizationCard=s}(),function(e){function r(e){return e&&e.originDirectory&&"aad"===e.originDirectory.trim().toLowerCase()}function s(e){return e&&e.originDirectory&&"ad"===e.originDirectory.trim().toLowerCase()}function n(e){return e&&e.originDirectory&&"vsd"===e.originDirectory.trim().toLowerCase()}function a(e){return e&&e.originDirectory&&"wmd"===e.originDirectory.trim().toLowerCase()}D=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].isCompleteIdentity=function(e,t){return!!(e&&(r(e)||s(e)?t&&e.mail||e.mailNickname||e.jobTitle||e.department||e.physicalDeliveryOfficeName||e.manager||e.surname||e.telephoneNumber:n(e)?e.signInAddress:a(e)&&(e.scopeName||e.signInAddress)))},t[e].isAadUser=r,t[e].isAdUser=s,t[e].isVsdUser=n,t[e].isWmdUser=a}("ComponentsPersonaCardPersonaCardIdentityUtils"),function(e){I=t.ComponentsPersonaCardPersonaCardHeaderElement={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return __extends(s,e),s.prototype.componentDidMount=function(){this.props.setFocus&&this.props.setFocus()},s.prototype.componentDidUpdate=function(){this.props.setFocus&&this.props.setFocus()},s.prototype.render=function(){var e=this;if(!this.props.identity)return null;var s=this.props.identity,n={imageUrl:s.image,primaryText:s.displayName,secondaryText:s.jobTitle,tertiaryText:s.department};return r.createElement("div",{className:"go-back-persona-wrapper",onClick:this.props.onClickFunction,"aria-label":t.VSSResourcesVSSUI.PeoplePickerHeaderButtonLabel,ref:function(t){e._personaElement=t},"data-is-focusable":!0,role:"button"},r.createElement("div",null,r.createElement(t.VssIcon.VssIcon,{iconType:0,iconName:"ChevronLeft"})),r.createElement("div",{className:"go-back-positioning flex-row"},r.createElement(t.VssPersona.VssPersona,{displayName:n.primaryText,imageUrl:n.imageUrl,className:"go-back-persona",size:"small",suppressPersonaCard:!0}),r.createElement("div",{className:"flex-column flex-grow persona-card-name"},r.createElement("div",{className:"persona-header-text-primary"},n.primaryText))))},s.prototype.setFocus=function(){this._personaElement&&this._personaElement.focus()},s}(r.Component);t.ComponentsPersonaCardPersonaCardHeaderElement.PersonaCardHeaderElement=s}(),function(e){R=t.ComponentsPersonaCardPersonaCardContent={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function s(){var t=e.apply(this,arguments)||this;return t._onFocusZoneRef=function(e){t._focusZone=e,t._focusOnUpdate()},t._focusOnUpdate=function(){var e=t.props.dataProps.directReportList;0===t.props.dataProps.cardType&&e?t._focusZone.focus():0!==t.props.dataProps.cardType&&t._focusZone.focus()},t._onDismissCallout=function(){t.props.onDismissCallback&&t.props.onDismissCallback()},t}return __extends(s,e),s.prototype.componentDidUpdate=function(){var e=D.isVsdUser(this.props.dataProps.identity);this.props.dataProps.header||e||this._focusOnUpdate()},s.prototype.render=function(){var e=this.props.referenceHTMLComponent?this.props.referenceHTMLComponent:this.props.target;return r.createElement("div",null,r.createElement(c.Callout,{onDismiss:this._onDismissCallout,target:e,ariaLabel:t.VSSResourcesVSSUI.PeoplePickerProfileCardAriaLabel,role:"alert",isBeakVisible:!1,gapSpace:10,className:"persona-card-callout",directionalHint:11},r.createElement("div",null,this._renderCard())))},s.prototype._renderCard=function(){if(this.props.working&&!D.isCompleteIdentity(this.props.dataProps.identity))return r.createElement("div",{className:t.Util.css("persona-card-styles","loading")},r.createElement(n.DelayedRender,{delay:300},r.createElement(t.Spinner.Spinner,{label:t.VSSResourcesVSSUI.Loading,size:"large",className:"persona-card-loading-spinner"})));var e=D.isAdUser(this.props.dataProps.identity)||D.isAadUser(this.props.dataProps.identity),s=this.props.dataProps.header||null;return r.createElement(u.FocusZone,{className:"persona-card-styles",handleTabKey:1,isCircularNavigation:!0,componentRef:this._onFocusZoneRef,direction:u.FocusZoneDirection.vertical},e&&s&&r.createElement(I.PersonaCardHeaderElement,{identity:s,onClickFunction:this.props.onHeaderClick,setFocus:this._focusOnUpdate}),this._renderInnerCard())},s.prototype._renderInnerCard=function(){var e=this.props.dataProps,t=e.identity,s=e.managerList,n=e.directReportList;if(!t)return null;var a=D.isVsdUser(t),i=D.isWmdUser(t),o=D.isAadUser(t),l=D.isAdUser(t);if(a)return r.createElement(T.DefaultAbridgedCard,{identity:t});if(i)return r.createElement(_.DefaultSimpleCard,{identity:t});if(o||l)switch(this.props.dataProps.cardType){case 1:return r.createElement(x.ContactCard,{identity:t});case 2:return r.createElement(N.OrganizationCard,{identity:t,managerList:s,directReportList:n,onClickEntity:this.props.onClickEntity});case 0:default:var c=s&&s.length>0?s[s.length-1]:null;return r.createElement(F.DefaultCard,{identity:t,manager:c,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,showContactCard:this.props.onShowContactCard,showOrganizationCard:this.props.onShowOrganizationCard,onClickEntity:this.props.onClickEntity,setFocus:this._focusOnUpdate})}return null},s}(r.Component);t.ComponentsPersonaCardPersonaCardContent.PersonaCardContent=s}(),function(e){V=t.ComponentsPersonaCardPersonaCard={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var r=e.call(this,t)||this;r._onDismissCallback=function(){r.props.onDismissCallback()},r._headerOnClickHandler=function(){r.state.dataState.previousDataState?r.setState({dataState:r.state.dataState.previousDataState,working:!1}):r.props.initialHeader&&r.props.initialHeader.onClickFunction&&r.props.initialHeader.onClickFunction()},r._onShowContactCard=function(){var e=Object.assign({},r.state.dataState,{previousDataState:r.state.dataState,cardType:1,header:r.state.dataState.identity});r.setState({dataState:e})},r._onShowOrganizationCard=function(){if(!r.state.working&&!r._dismissed){var e=r.state.dataState;if(e.managerList&&e.managerList.length<=1){var t=r.state.dataState,s=Object.assign({},t,{cardType:2,header:t.identity,previousDataState:t});r.setState({dataState:s,working:!0}),r._resolveIdentity(s,r.props.onRequestConnectionInformation(t.identity,!0))}else{var n=r.state.dataState;s=Object.assign({},n,{cardType:2,header:n.identity,previousDataState:n});r.setState({dataState:s,working:!1})}}},r._onClickEntity=function(e){if(!r.state.working){var t=r.state.dataState,s={identity:e,cardType:0,header:t.identity,directReportList:[],managerList:[],previousDataState:t,displayName:e.displayName,imageUrl:e.image,email:e.mail};r.setState({dataState:s,working:!0}),r._getIdentityByUniqueAttribute(e)}},r._updateConnections=function(e,t){r._dismissed||r.state.dataState&&e.identity===r.state.dataState.identity&&r.setState({dataState:Object.assign({},r.state.dataState,{managerList:t.managers&&t.managers.reverse(),directReportList:t.directReports}),working:!1})},r._updateEntity=function(e){var t=D.isCompleteIdentity(e,!0),s=D.isAadUser(e)||D.isAdUser(e),n=r.props.imageUrl?r.props.imageUrl:e.image,a=Object.assign({},r.state.dataState,{identity:e,displayName:e.displayName,imageUrl:n});t?s?(r.setState({dataState:a,working:!1}),r._resolveIdentity(a,r.props.onRequestConnectionInformation(a.identity))):r.setState({dataState:a,working:!1}):r.setState({working:!0})};var s={identity:t.identity,managerList:null,directReportList:null,previousDataState:null,cardType:0,header:t.initialHeader?t.initialHeader.identity:null,displayName:t.displayName,imageUrl:t.imageUrl,email:r._getEmail()},n=!0;return t.identity||t.uniqueAttribute||!t.displayName||(s.identity={entityId:"",entityType:"user",originDirectory:"vsd",originId:"",displayName:t.displayName,image:t.imageUrl,signInAddress:s.email},n=!1),r.state={dataState:s,working:n},r}return __extends(t,e),t.prototype.componentDidMount=function(){this.state.working&&this._setupInitialData(this.props.uniqueAttribute)},t.prototype.componentWillUnmount=function(){this._dismissed=!0},t.prototype.render=function(){return this.props.uniqueAttribute||this.props.identity||this.props.displayName?r.createElement(R.PersonaCardContent,Object.assign({},this.props,{dataProps:this.state.dataState,onClickEntity:this._onClickEntity,onDismissCallback:this._onDismissCallback,onShowContactCard:this._onShowContactCard,onShowOrganizationCard:this._onShowOrganizationCard,working:this.state.working,onHeaderClick:this._headerOnClickHandler})):null},t.prototype._setupInitialData=function(e){var t=this.state.dataState;t.identity?D.isCompleteIdentity(t.identity)?this._resolveIdentity(t,this.props.onRequestConnectionInformation(t.identity)):this._getIdentityByUniqueAttribute(t.identity):this._getIdentityByUniqueAttribute(e)},t.prototype._resolveIdentity=function(e,t){var r=this,s=t,n=t;n&&n.then?n.then(function(t){r._updateConnections(e,t)}):s&&this._updateConnections(e,s)},t.prototype._resolveIEntity=function(e){var t=this,r=e,s=e;s&&s.then?s.then(function(e){t._updateEntity(e)}):r&&this._updateEntity(r)},t.prototype._getIdentityByUniqueAttribute=function(e){var t;t="string"==typeof e?e:D.isAadUser(e)||D.isAdUser(e)?e.entityId:e.signInAddress,this._resolveIEntity(this.props.getEntityFromUniqueAttribute(t))},t.prototype._getEmail=function(){if(D.isAadUser(this.props.identity)||D.isAdUser(this.props.identity))return this.props.identity.mail;if(this.props.identity&&this.props.identity.signInAddress)return this.props.identity.signInAddress;if(this.props.identity&&this.props.identity.mail)return this.props.identity.mail;if(this.props.uniqueAttribute){var e=this.props.uniqueAttribute.split("@");if(2===e.length&&e[0].length>=1&&e[1].length>=3)if(e[1].split(".").length>1)return this.props.uniqueAttribute}return null},t}(r.Component);t.ComponentsPersonaCardPersonaCard.PersonaCard=s}(),function(e){function r(r){for(var s in r)t[e].hasOwnProperty(s)||(t[e][s]=r[s])}w=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),r(x),r(T),r(F),r(_),r(N),r(V),r(R),r(I),r(D)}("ComponentsPersonaCardindex"),function(e){A=t.ComponentsPeoplePickerDropdownPeoplePickerDropdown={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function s(s){var n=e.call(this,s)||this;return n.areSuggestionsVisible=new p.ObservableValue(!1),n.hasFocus=new p.ObservableValue(!1),n.inputElement=r.createRef(),n.openedIdentityCard=new p.ObservableValue(void 0),n.outerElement=r.createRef(),n.selectedIdentity=new p.ObservableValue(void 0),n.suggestionsControl=r.createRef(),n.suggestionsLoading=new p.ObservableValue(!1),n.textValue=new p.ObservableValue(""),n.currentSuggestion=function(){return n.selectedIdentity.value},n.hidePicker=function(){n.areSuggestionsVisible.value=!1,n.hasFocus.value||n.props.onBlur&&n.props.onBlur()},n.showPicker=function(){n.areSuggestionsVisible.value=!0},n.renderPersonaCoin=function(e){var s="bolt-peoplepickerdropdown-icon flex-row flex-center justify-center";return r.createElement(t.Observer.Observer,{selectedIdentity:n.selectedIdentity},function(e){return e.selectedIdentity?r.createElement(t.VssPersona.VssPersona,{className:s,displayName:e.selectedIdentity.displayName,imageUrl:e.selectedIdentity.image,size:"small"}):r.createElement(t.VssIcon.VssIcon,{className:s,iconName:"Contact"})})},n.closePersonaCard=function(){n.openedIdentityCard.value=void 0},n.completeSuggestion=function(){n.suggestionStore.suggestions.length>0&&n.areSuggestionsVisible.value?(n.suggestionStore.currentIndex<0&&n.suggestionStore.nextSuggestion(),n.setInputToSelectedPerson(),n.suggestionStore.currentSuggestion&&n.selectedPersonaChanged(n.suggestionStore.currentSuggestion.item),n.areSuggestionsVisible.value=!1):(n.suggestionStore.deselectAllSuggestions(),n.suggestionStore.currentSuggestion=void 0,n.selectedPersonaChanged())},n.onBlur=function(){n.hasFocus.value=!1,n.timerManagement.setTimeout(function(){var e=!n.openedIdentityCard.value&&!n.areSuggestionsVisible.value&&!n.areSuggestionsVisible.value;e&&n.props.onBlur&&n.props.onBlur(),e&&n.selectedPersonaChanged(n.selectedIdentity.value)},100)},n.onClick=function(){""===n.textValue.value&&n.props.pickerProvider.onEmptyInputFocus?(n.updateSuggestionsList(n.props.pickerProvider.onEmptyInputFocus()),n.areSuggestionsVisible.value=!n.areSuggestionsVisible.value):n.areSuggestionsVisible.value=!n.areSuggestionsVisible.value,n.inputElement.current.select()},n.onFocus=function(e){var t=n.props.onFocus;""===n.textValue.value&&n.props.pickerProvider.onEmptyInputFocus&&!n.areSuggestionsVisible.value&&n.updateSuggestionsList(n.props.pickerProvider.onEmptyInputFocus()),n.hasFocus.value=!0,t&&t(e)},n.onKeyDown=function(e){var t=e.which;switch(t){case 27:n.openedIdentityCard.value&&!n.suggestionStore.currentSuggestion&&n.selectedPersonaChanged(),n.areSuggestionsVisible.value&&(n.areSuggestionsVisible.value=!1,n.openedIdentityCard.value=void 0);break;case 9:case 13:n.suggestionsControl.current&&n.suggestionsControl.current.hasSuggestedActionSelected()?(n.suggestionsControl.current.executeSelectedAction(),n.completeSuggestion()):!e.shiftKey&&n.suggestionStore.hasSelectedSuggestion()&&n.areSuggestionsVisible.value?(n.completeSuggestion(),e.preventDefault(),e.stopPropagation()):n.areSuggestionsVisible.value?n.completeSuggestion():n.selectedPersonaChanged(n.selectedIdentity.value);break;case 39:n.suggestionStore.currentSuggestion&&(n.openedIdentityCard.value=n.suggestionStore.currentSuggestion.item);break;case 38:n.suggestionsControl.current&&n.suggestionsControl.current.tryHandleKeyDown(t,n.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation()):n.suggestionsControl.current&&n.areSuggestionsVisible.value&&(n.suggestionStore.previousSuggestion(),n.forceUpdate(),e.preventDefault(),e.stopPropagation());break;case 40:n.suggestionsControl.current&&n.suggestionsControl.current.tryHandleKeyDown(t,n.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation()):n.suggestionsControl.current&&n.areSuggestionsVisible.value?(n.suggestionStore.nextSuggestion(),n.forceUpdate(),e.preventDefault(),e.stopPropagation()):n.areSuggestionsVisible.value=!0}},n.onResolveSuggestions=function(e){var t=n.props.pickerProvider.onFilterIdentities(e,[n.suggestionStore.currentSuggestion&&n.suggestionStore.currentSuggestion.item]);null!==t&&n.updateSuggestionsList(t,e)},n.onSearchChange=function(e,t){if(n.areSuggestionsVisible.value=!!t,0==t.length){var r=n.props.onClear;r&&r()}n.selectedIdentity.value=void 0,n.textValue.value=t,n.updateValue(t)},n.onSuggestionClick=function(e,t,r){n.suggestionStore.setSelectedSuggestion(r),n.selectedPersonaChanged(t),n.textValue.value=t.displayName,n.hidePicker(),e.stopPropagation()},n.renderNoIdentitiesFound=function(){return r.createElement("div",{className:"bolt-peoplepickerdropdown-noresults flex-row flex-center"},t.VSSResourcesVSSUI.PeoplePickerNoResultsText)},n.renderSuggestionItem=function(e,s){var a=C.getSignInAddress(e);return r.createElement("div",{className:"bolt-picker-suggesteditem flex-row flex-grow flex-center text-ellipsis"},r.createElement(t.VssPersona.VssPersona,{cssClass:"bolt-picker-persona text-ellipsis",identityDetailsProvider:{getIdentityImageUrl:function(t){return e.image},getDisplayName:function(){return e.displayName}},size:"small"}),r.createElement("div",{className:"bolt-picker-persona-name flex-column flex-grow"},r.createElement("div",{className:"fontSizeM text-ellipsis"},e.displayName),""===a?void 0:r.createElement("div",{className:"fontSize secondary-text text-ellipsis"},a)),C.isUser(e)&&r.createElement(t.Button.Button,{className:"bolt-contact-card",iconProps:{iconName:"ContactCard",className:"bolt-contactcard-button flex-shrink"},onClick:function(t){n.openedIdentityCard.value=e,t.stopPropagation()},subtle:!0}))},n.selectedPersonaChanged=function(e){n.selectedIdentity.value=e,n.props.onChange&&n.lastPickedIdentity!==e&&(e&&n.props.pickerProvider.addIdentitiesToMRU&&n.props.pickerProvider.addIdentitiesToMRU([e]),n.props.onChange(n.selectedIdentity.value)),n.lastPickedIdentity=e},n.setInputToSelectedPerson=function(){var e=n.suggestionStore.currentSuggestion?n.suggestionStore.currentSuggestion.item.displayName:n.textValue.value;n.textValue.value=e},n.cachedResults={},n.suggestionStore=new i.SuggestionsController,n.timerManagement=new d.TimerManagement,n.lastPickedIdentity=s.defaultIdentity,n}return __extends(s,e),s.prototype.render=function(){var e=this;return r.createElement(t.Observer.Observer,{areSuggestionsVisible:this.areSuggestionsVisible,hasFocus:this.hasFocus,openedIdentityCard:this.openedIdentityCard,selectedIdentity:this.selectedIdentity,textValue:this.textValue},function(s){var n=e.props,a=n.ariaLabel,i=void 0===a?t.VSSResourcesVSSUI.PeoplePickerPlaceholderText:a,o=n.autoFocus,l=n.placeholder,c=void 0===l?t.VSSResourcesVSSUI.PeoplePickerPlaceholderText:l,u=(e.areSuggestionsVisible.value||s.hasFocus)&&"bolt-peoplepickerdropdown-open";return r.createElement("div",{className:"bolt-peoplepickerdropdown flex-row flex-grow",ref:e.outerElement,onClick:e.onClick,onKeyDown:e.onKeyDown},r.createElement(t.TextField.TextField,{"aria-autocomplete":"none","aria-label":i,"aria-expanded":s.areSuggestionsVisible,"aria-haspopup":"true",autoFocus:o,className:t.Util.css(e.props.className,"bolt-peoplepickerdropdown-textField flex-row flex-center",u),containerClassName:"bolt-peoplepickerdropdown-container flex-column flex-grow",onBlur:e.onBlur,onChange:e.onSearchChange,onFocus:e.onFocus,prefixIconProps:{render:e.renderPersonaCoin},placeholder:c,ref:e.inputElement,role:"comboBox",suffixIconProps:{className:"bolt-dropdown-button",iconName:"ChevronDown"},value:s.textValue}),e.renderSuggestions(),s.openedIdentityCard&&r.createElement(w.PersonaCard,{getEntityFromUniqueAttribute:e.props.pickerProvider.getEntityFromUniqueAttribute,key:s.openedIdentityCard.entityId,identity:s.openedIdentityCard,target:e.outerElement.current,onDismissCallback:e.closePersonaCard,onRequestConnectionInformation:e.props.pickerProvider.onRequestConnectionInformation}))})},s.prototype.componentDidMount=function(){this.onResolveSuggestions=this.timerManagement.debounce(this.onResolveSuggestions,250),this.props.defaultIdentity?(this.suggestionStore.updateSuggestions([this.props.defaultIdentity],0),this.selectedIdentity.value=this.props.defaultIdentity,this.textValue.value=this.props.defaultIdentity.displayName,this.areSuggestionsVisible.value=!1):this.props.autoFocus&&this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus())},s.prototype.componentWillUnmount=function(){this.currentPromise=void 0},s.prototype.updateSuggestionsList=function(e,t){var r=this,s=e,n=e;if(Array.isArray(s))this.updateSuggestions(s);else if(n&&n.then){this.loadingTimer||(this.loadingTimer=this.timerManagement.setTimeout(function(){r.suggestionsLoading.value=!0},500));var a=this.currentPromise=n;a.then(function(e){a===r.currentPromise&&(r.suggestionsLoading.value=!1,r.updateSuggestions(e,t),""!==r.textValue.value&&r.suggestionStore.suggestions&&r.suggestionStore.suggestions.length>0&&(r.cachedResults[r.textValue.value]=e),r.loadingTimer&&(r.timerManagement.clearTimeout(r.loadingTimer),r.loadingTimer=void 0))})}},s.prototype.renderSuggestions=function(){return this.areSuggestionsVisible.value||this.openedIdentityCard.value?r.createElement(c.Callout,{calloutWidth:this.props.calloutWidth,className:"bolt-peoplepickerdropdown-callout",directionalHint:4,isBeakVisible:!1,onDismiss:this.hidePicker,target:this.outerElement.current},r.createElement(k.Suggestions,{className:"bolt-peoplepickerdropdown-list",isLoading:this.suggestionsLoading.value,isResultsFooterVisible:this.props.isResultsFooterVisible,loadingText:t.VSSResourcesVSSUI.PeoplePickerLoadingText,onRenderNoResultFound:this.renderNoIdentitiesFound,onRenderSuggestion:this.renderSuggestionItem,onSuggestionClick:this.onSuggestionClick,ref:this.suggestionsControl,resultsMaximumNumber:this.props.resultsMaximumNumber,suggestionsContainerAriaLabel:this.props.suggestionsContainerAriaLabel,suggestionsItemClassName:t.Util.css("bolt-peoplepickerdropdown-item",this.props.suggestionsItemClassName),suggestions:this.suggestionStore.getSuggestions()})):null},s.prototype.updateSuggestions=function(e,t){(void 0===t||this.inputElement.current&&this.textValue.value===t)&&(this.suggestionStore.updateSuggestions(e,0),void 0!==t&&(this.selectedIdentity.value=void 0),this.forceUpdate())},s.prototype.updateValue=function(e){this.cachedResults[e]?this.updateSuggestionsList(this.cachedResults[e],e):this.onResolveSuggestions(e)},s}(r.Component);s.defaultProps={calloutWidth:296},t.ComponentsPeoplePickerDropdownPeoplePickerDropdown.PeoplePickerDropdown=s}(),function(e){U=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(r){for(var s in r)t[e].hasOwnProperty(s)||(t[e][s]=r[s])}(A)}("ComponentsPeoplePickerDropdownindex"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(r){for(var s in r)t[e].hasOwnProperty(s)||(t[e][s]=r[s])}(P)}("DateTimeRangePicker"),function(e){function r(r){for(var s in r)t[e].hasOwnProperty(s)||(t[e][s]=r[s])}t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),r(E),r(U),r(w)}("PeoplePicker")},["Resources.Pickers","Components/DateTimePicker/DateTimePicker","Components/DateTimePicker/DateTimePickerFilterBarItem","Components/DateTimePicker/Helpers","Components/DateTimePicker/index","DateTimePicker","Components/DateTimeRangePicker/DateTimeRangePicker","Components/DateTimeRangePicker/index","Components/PeoplePicker/PeoplePickerUtils","Components/PeoplePicker/PeoplePicker","Components/PeoplePicker/Suggestions","Components/PeoplePicker/index","Components/PersonaCard/ContactCard","Components/PersonaCard/DefaultCard","Components/PersonaCard/DefaultAbridgedCard","Components/PersonaCard/DefaultSimpleCard","Components/PersonaCard/OrganizationCard","Components/PersonaCard/PersonaCardIdentityUtils","Components/PersonaCard/PersonaCardHeaderElement","Components/PersonaCard/PersonaCardContent","Components/PersonaCard/PersonaCard","Components/PersonaCard/index","Components/PeoplePickerDropdown/PeoplePickerDropdown","Components/PeoplePickerDropdown/index","DateTimeRangePicker","PeoplePicker"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-pickers-content"}}));