"use strict";define("VSS/Features/PlatformUI",["require","exports","react","VSSUI/Util","VSS/Platform/Layout","VSS/Platform/Location","VSS/Platform/Theming","VSS/Platform/Util/Url","VSSUI/Icon","VSSUI/Image","VSS/Platform/FPS","VSSUI/Link","VSS/Core/Observable","VSS/Platform/Trace"],function(e,t,n,i,r,o,u,s,c,a,d,b,p,m){var l,v,f,h,C,I;t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.loading="Loading",function(e){l=t.ComponentsContributedContentContributedContent={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsContributedContentContributedContent.ContributedContent=function(e){var t=e.className,o=e.componentProperties,u=e.contribution,s=e.contributionId,c=e.dependencies,a=Object.assign({},o,u.componentProperties,{className:i.css(t,o&&o.className,u.componentProperties&&u.componentProperties.className)}),d=(c||[]).concat(u.dependencies||[]);return u.uri?n.createElement(r.WrappedComponent,{dependencies:d.concat(["ms.vss-web.ext-content"]),wrappedType:"ExternalContent",wrappedProps:Object.assign({},a,{contributionId:s})}):u.componentType?n.createElement(r.WrappedComponent,{dependencies:d,wrappedType:u.componentType,wrappedProps:a}):null}}(),function(e){function r(e,t,r){var o,c,d;if(r&&("object"==typeof r?c=r[u.getCurrentTheme(e).isDark?"dark":"light"]:(d="non-themed",c=r),c)){if(!c.match(/^https?:\/\//)&&t){var b=e.getService("IVssContributionService").getContributionProvider(t);b&&(c=s.combineUrlPaths(b.baseUri,c))}o={render:function(e){return n.createElement(a.Image,{className:i.css(e,d,"contributed-icon-image"),src:c})}}}return o}v=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].contributedIconToIconProps=r,t[e].ContributedIcon=function(e){var t=i.css(e.className,"contributed-icon");if(e.iconProps)return n.createElement(c.Icon,Object.assign({},e.iconProps,{className:i.css(t,e.iconProps.className)}));if(e.iconAsset){var u=o.getAssetLocation(e.pageContext,e.iconAsset);if(u)return n.createElement(a.Image,{className:i.css(t,"contributed-icon-image"),src:u})}if(e.icon){var s=r(e.pageContext,e.contributionId,e.icon);if(s)return n.createElement(c.Icon,Object.assign({className:t},s))}return e.iconName?n.createElement(c.Icon,{className:t,iconName:e.iconName}):null}}("ComponentsContributedIconContributedIcon"),function(e){f=t.ComponentsFPSLinkFPSLink={},Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){var t=e.apply(this,arguments)||this;return t.onClick=function(e){if(t.props.onClick&&t.props.onClick(e),!e.isDefaultPrevented())if(t.props.href&&!1!==t.props.supportsFPS)d.onClickFPS(t.context.pageContext,t.props.href,!0,e,{telemetrySource:t.props.telemetrySource,telemetryProperties:t.props.telemetryProperties,navigationId:t.props.navigationId});else if(t.props.telemetrySource){t.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","Link",Object.assign({},t.props.telemetryProperties||{},{source:t.props.telemetrySource}))}},t}return __extends(t,e),t.prototype.render=function(){var e=Object.assign({},this.props,{onClick:this.onClick});return n.createElement(b.Link,Object.assign({},e))},t}(r.VssComponent);t.ComponentsFPSLinkFPSLink.FPSLink=i}(),function(e){h=t.ContributedItemUtil={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedItemUtil.getContributedItems=function(e,t,n,i){var r=[],o=e.getService("IVssContributionService"),u=[],s={},c=o.getContributionChildren(t,i);if(c)for(var a=0,d=c;a<d.length;a++){var b=d[a];s[b]=!0,u.push(b)}if(n){var p=o.getContributionsByType(i);if(p)for(var m in p)s[m]||(f=p[m])&&f[n]===t&&u.push(m)}for(var l=0,v=u;l<v.length;l++){var f,h=v[l];(f=o.getContribution(h))&&r.push({id:h,contribution:f})}return r}}(),function(e){t.ContributedBreadcrumb={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedBreadcrumb.getBreadcrumbItems=function(e,t){var n=new p.ObservableCollection,i=e.getService("IVssContributionService"),r=i.getSharedData("_breadcrumbItems");if(r){var o=r[t];o&&n.push(o)}var u=h.getContributedItems(e,t,"breadcrumbId","ms.vss-web.breadcrumb-item");n.push(u,function(e){return{hidden:e.contribution.hidden,href:e.contribution.href,key:e.contribution.key||e.id,text:e.contribution.text,rank:e.contribution.rank,priority:e.contribution.priority}});for(var s=0,c=h.getContributedItems(e,t,"breadcrumbId","ms.vss-web.breadcrumb-provider");s<c.length;s++){var a=c[s],d=i.getServiceSync(a.id);d?n.push(d):i.getService(a.id).then(function(e){e&&n.push(e)})}return n}}(),C=t.ContributedContent={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedContent.ContributedContent=l.ContributedContent,I=t.ContributedIcon={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedIcon.ContributedIcon=v.ContributedIcon,t.ContributedIcon.contributedIconToIconProps=v.contributedIconToIconProps,function(e){function i(e,t){return function(n){var i="Failed to load menu items for "+t+": "+JSON.stringify(n||"");m.traceWarning(e,"extensions","ContributedMenu",i,{menuId:t}),console.warn(i)}}function o(e,t,n){var i;if(t.contribution.uri)i=new d(e,t.id,t.contribution,n);else{var r=t.contribution;!r.subMenuId&&r.menuId&&r.menuId!==t.id&&(r=Object.assign({},r,{subMenuId:r.menuId})),i=new c(e,r,n)}return i}function u(e,t,n){var i=new p.ObservableCollection;return s(e,i,t,n),i}function s(e,t,n,r){var u=e.getService("IVssContributionService"),s=u.getSharedData("_menuItems");if(s){var c=s[n];c&&c.length>0&&t.push(c,function(t){return o(e,{id:t.id,contribution:t},r)})}t.push(h.getContributedItems(e,n,"menuId","ms.vss-web.menu-item"),function(t){return o(e,t,r)}),t.push(h.getContributedItems(e,n,"menuId","ms.vss-web.action"),function(t){return o(e,t,r)});for(var a=function(o){var s=u.getServiceSync(o.id,!0);if(s){if(s.getMenuItems){var c=s.getMenuItems(n);c&&t.push(c)}}else{var a=o.contribution;if(a.uri){var b={serviceName:a.registeredObjectId||o.id,uri:a.uri};u.getServiceEx(o.id,b,!0).then(function(u){u&&u.getMenuItems&&u.getMenuItems(n).then(function(n){t.push(n,function(t){return new d(e,o.id,Object.assign({uri:a.uri},t),r)})},i(e,o.id))},i(e,o.id))}else u.getService(o.id).then(function(e){if(e&&e.getMenuItems){var i=e.getMenuItems(n);i&&t.push(i)}})}},b=0,p=h.getContributedItems(e,n,"menuId","ms.vss-web.menu-provider").concat(h.getContributedItems(e,n,"menuId","ms.vss-web.action-provider"));b<p.length;b++){a(p[b])}}t.ContributedMenu={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedMenu.getMenuItems=u,t.ContributedMenu.addMenuItems=s;var c=function(){return function(e,t,i){var o=this;this.onActivateCommand=function(e){var t=o.pageContext.getService("IVssContributionService"),n=o.contextualData?Object.assign({},o.data,o.contextualData.value):o.data;o.command?t.executeCommandEx(e.id,o.command,n):t.getService(e.id,!0).then(function(e){e&&e.execute&&e.execute(n)})},this.renderMenuItemCustom=function(e,t,i){return n.createElement(r.WrappedComponent,{key:o.id,wrappedType:o.componentType,wrappedProps:{index:e,item:t,details:i}})},this.pageContext=e,this.className=t.className,this.checked=t.checked,this.data=t.data,this.contextualData=i,this.disabled=t.disabled,this.groupKey=t.groupKey,this.href=t.href,this.iconProps=t.iconProps,this.id=t.id||t.key||"",this.rank=t.rank,this.rel=t.rel,this.target=t.target,this.text=t.text||t.name,"-"===t.name?this.itemType=1:this.itemType=t.itemType,this.command=t.command,!this.command&&this.href||(this.onActivate=this.onActivateCommand);var s=t.subMenuId;s&&(this.subMenuProps={id:s,items:u(e,s)}),this.componentType=t.componentType,this.componentType&&(this.renderMenuItem=this.renderMenuItemCustom)}}(),a=0,d=function(){return function e(t,n,r,o){var u=this;if(this.onActivateExternalCommand=function(){u.pageContext.getService("IVssContributionService").getServiceEx(u.contributionId,u.externalContributedService,!0).then(function(e){e&&e.execute&&e.execute(u.contextualData.value)},i(u.pageContext,u.contributionId))},this.pageContext=t,this.contributionId=n,this.contextualData=o||new p.ObservableValue(void 0),this.disabled=r.disabled,this.groupKey=r.groupId,this.href=r.href,this.id=r.id||"ext-menu-"+ ++a,this.rank=r.rank,this.text=r.text||r.title,r.icon&&(this.iconProps=I.contributedIconToIconProps(t,n,r.icon)),r.action?this.onActivate=function(){r.action(u.contextualData.value)}:r.uri&&(this.externalContributedService={serviceName:r.registeredObjectId||n,uri:r.uri,configuration:this.contextualData.value},this.onActivate=this.onActivateExternalCommand),r.childItems){var s=new p.ObservableArray;"function"==typeof r.childItems.then?r.childItems.then(function(i){s.push.apply(s,i.map(function(i){return new e(t,n,Object.assign({uri:r.uri},i),u.contextualData)}))},i(t,this.contributionId)):s.push.apply(s,r.childItems.map(function(i){return new e(t,n,Object.assign({uri:r.uri},i),u.contextualData)})),this.subMenuProps={id:"ext-sub-menu-"+ ++a,items:s}}}}()}(),function(e){function i(e,t,i,r){if(i.render||(i.render=function(){return n.createElement(C.ContributedContent,{key:r,className:"flex-grow",contributionId:r,contribution:i,dependencies:i.dependencies,componentProperties:t.props})}),i.id||(i.id=r),i.routeId){var o=e.getService("IVssLocationService");i.url=o.routeUrl(i.routeId,Object.assign({},t.routeValues,i.routeValues))}else if(t.defaultRouteId){o=e.getService("IVssLocationService");i.url=o.routeUrl(t.defaultRouteId,{contributionId:r})}return i.fpsRequired?i.onBeforeTabChange=function(t,n,i){return!i||(d.FastPageSwitch(e,i,!0),t&&t.preventDefault(),!1)}:i.url&&t.updateUrlOnPivotChange&&(i.onBeforeTabChange=function(t,n,r){return e.getService("IVssHistoryService").pushState(void 0,i.url&&p.ObservableLike.getValue(i.url)),!0}),i}function r(e,t,n,r){void 0===r&&(r={});var o=e.getService("IVssContributionService"),u=h.getContributedItems(e,n,"tabId","ms.vss-web.tab");t.push(u,function(t){return i(e,r,t.contribution,t.id)});for(var s=0,c=h.getContributedItems(e,n,"tabId","ms.vss-web.tab-provider");s<c.length;s++){var a=c[s],d=o.getServiceSync(a.id,!0);d?t.push(d,function(t){return i(e,r,t,t.id)}):o.getService(a.id).then(function(n){n&&t.push(n,function(t){return i(e,r,t,t.id)})})}}t.ContributedTab={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedTab.getTabs=function(e,t,n){void 0===n&&(n={});var i=new p.ObservableCollection;return r(e,i,t,n),i},t.ContributedTab.addTabs=r}(),t.FPSLink={},Object.defineProperty(t,"__esModule",{value:!0}),t.FPSLink.FPSLink=f.FPSLink},["Resources","Components/ContributedContent/ContributedContent","Components/ContributedIcon/ContributedIcon","Components/FPSLink/FPSLink","ContributedItemUtil","ContributedBreadcrumb","ContributedContent","ContributedIcon","ContributedMenu","ContributedTab","FPSLink"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.platform-ui-content"}}));