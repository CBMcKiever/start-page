"use strict";define("VSS/Platform",["require","exports","VSS/Core/Observable","VSS/Core/Util/String","VSS/Core/Util/Theming","react","react-dom","prop-types","create-react-class","VSS/Core/EventManagement","VSS/Core/TimerManagement","VSS/Core/Util/Promise"],function(e,t,r,n,i,o,s,a,c,u,p,l){var d,h,v,f,g,m,y,b,S,_,C,w,I,P,T,E,R,D,x,O,V;!function(e){function r(e,t){return e?t?e.toLocaleUpperCase():e:""}function n(e,t,n){return e===t?0:r(e,n).localeCompare(r(t,n))}function i(e,t){return n(e,t,!1)}function o(e,t){return n(e,t,!0)}function s(e,t,r){for(var n="",i=0;;){var o=t.indexOf("{",i),s=t.indexOf("}",i);if(o<0&&s<0){n+=t.slice(i);break}if(s>0&&(s<o||o<0)){if("}"!==t.charAt(s+1))throw new Error("The format string contains an unmatched opening or closing brace.");n+=t.slice(i,s+1),i=s+2}else if(n+=t.slice(i,o),i=o+1,"{"!==t.charAt(i)){if(s<0)throw new Error("The format string contains an unmatched opening or closing brace.");var c=t.substring(i,s),u=c.indexOf(":"),p=parseInt(u<0?c:c.substring(0,u),10);if(isNaN(p))throw new Error("The format string is invalid.");var l=u<0?"":c.substring(u+1),d=r[p];null==d&&(d=""),d.toFormattedString?n+=d.toFormattedString(l):d instanceof Date?n+=a(d,e):d.format?n+=d.format(l):n+=d.toString(),i=s+1}else n+="{",i++}return n}function a(e,t){return t?e.toLocaleString():e.toString()}function c(e){for(var t="",r=0;r<e;r++)t+=Math.floor(16*Math.random()).toString(16);return t}t.UtilString={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilString.localeComparer=i,t.UtilString.localeIgnoreCaseComparer=o,t.UtilString.equals=function(e,t,r){return r?0===o(e,t):0===i(e,t)},t.UtilString.startsWith=function(e,t,r){return 0===(r?o:i)(t,e.substr(0,t.length))},t.UtilString.endsWith=function(e,t,r){return 0===(r?o:i)(t,e.substr(e.length-t.length,t.length))},t.UtilString.caseInsensitiveContains=function(e,t){return-1!==e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())},t.UtilString.format=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return s(!1,e,t)},t.UtilString.localeFormat=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return s(!0,e,t)},t.UtilString.EmptyGuidString="00000000-0000-0000-0000-000000000000",t.UtilString.isGuid=function(e){return/^\{?([\dA-F]{8})-?([\dA-F]{4})-?([\dA-F]{4})-?([\dA-F]{4})-?([\dA-F]{12})\}?$/i.test(e)},t.UtilString.newGuid=function(){var e=(128+Math.floor(64*Math.random())).toString(16);return c(8)+"-"+c(4)+"-4"+c(3)+"-"+e+c(2)+"-"+c(12)}}(),d=t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.CdnFallbackErrorMessage="There was an error loading a required file. Would you like to reload the page to try to load again?",t.Resources.NetworkError="TF400893: Unable to contact the server. Please check your network connection and try again.",t.Resources.JustNow="Just now",t.Resources.AgoMinutes="{0}m ago",t.Resources.AgoHours="{0}h ago",t.Resources.Today="Today",t.Resources.Yesterday="Yesterday",t.Resources.DayAtTimeFormat="{0} at {1}",t.Resources.LessThanASecond="<1s",t.Resources.Seconds="{0}s",t.Resources.MinutesSeconds="{0}m {1}s",t.Resources.HoursMinutesSeconds="{0}h {1}m {2}s",t.Resources.DaysHoursMinutes="{0}d {1}h {2}m",t.Resources.Global="Global",function(e){h=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype._serviceStart=function(e){this.pageContext=e},e.prototype._serviceEnd=function(e){},e.prototype._serviceRestart=function(e){this.pageContext=e},e}();t[e].VssService=n;var i=function(e){function t(){var t=e.apply(this,arguments)||this;return t.observable=new r.Observable,t}return __extends(t,e),t.prototype.subscribe=function(e,t){this.observable.subscribe(e,t)},t.prototype.unsubscribe=function(e,t){this.observable.unsubscribe(e,t)},t.prototype._notify=function(e,t,r){this.observable.notify(e,t,r)},t}(n);t[e].VssObservableService=i;var o=function(e){function t(){var t=e.apply(this,arguments)||this;return t.items=new r.ObservableArray,t.onChange=function(e,r){t._notify(e,r)},t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t),this.items.subscribe(this.onChange)},t.prototype._serviceEnd=function(t){e.prototype._serviceEnd.call(this,t),this.items.unsubscribe(this.onChange)},t.prototype.push=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.items).push.apply(e,t)},t.prototype.pop=function(){return this.items.pop()},t.prototype.splice=function(e,t){for(var r,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return(r=this.items).splice.apply(r,[e,t].concat(n))},t.prototype.removeAll=function(e){this.items.removeAll(e)},Object.defineProperty(t.prototype,"value",{get:function(){return this.items.value},set:function(e){var t;(t=this.items).splice.apply(t,[0,this.length].concat(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),t}(i);t[e].VssObservableArrayService=o,t[e].Services=new r.ObservableObject,t[e].RemoteSerializationSettingsKey="__remoteSerializationSettings",t[e].RestClients=new r.ObservableObject;var s=function(){function e(e,t){var r=this;this.initializatonInProgress={},this.delayedServices=[],this.serviceInstances={},this.uniqueNumber=0,this.services=e,this.restClients=t;this.services.subscribe(function(e,t){"add"===t&&e&&e.value&&e.value.options&&4==(4&e.value.options)&&(r.contentLoaded?r.getService(e.key):r.delayedServices.push(e.key))}),document.addEventListener("DOMContentLoaded",function(){r.contentLoaded=!0;for(var e=0,t=r.delayedServices;e<t.length;e++){var n=t[e];r.getService(n)}document.body.addEventListener("fpsLoaded",function(e){var t={};for(var n in r.contextUnloadInProgress=!0,r.serviceInstances){if((c=r.services.get(n))&&c.options&&2==(2&c.options))t[n]=r.serviceInstances[n];else{var i=r.serviceInstances[n];if(i._serviceEnd)try{i._serviceEnd(r)}catch(e){console.error(e)}delete r.serviceInstances[n]}}for(var n in r.contextUnloadInProgress=!1,t){var o=t[n];o&&o._serviceRestart&&o._serviceRestart(r)}for(var s=0,a=r.services.keys();s<a.length;s++){var c;n=a[s];(c=r.services.get(n))&&c.options&&4==(4&c.options)&&(r.serviceInstances[n]||r._loadService(n,c))}})})}return e.prototype.getService=function(e,t,r){if(this.contextUnloadInProgress)throw new Error("Services can't be requested while a shutdown is in progress");var n=this.serviceInstances[e];if(!n){var i=this.services.get(e);if(i&&(!i.options||8!=(8&i.options)))if(t&&i.options&&1!=(1&i.options)){if(!r)throw new Error("The "+e+" service is not marked as remotable.")}else n=this._loadService(e,i);if(!n&&!r)throw new Error('No service has been registered with the name "'+e+'".')}return n},e.prototype.getRestClient=function(e,t){var r=this.restClients.get(e);if(!r)throw new Error('No REST client has been registered with the name "'+e+'".');var n=this.getService("IRestClientOptionsProviderService").populateRestClientOptions(r.options,t);return new r.factory(n)},e.prototype.getUniqueNumber=function(){return++this.uniqueNumber},e.prototype._loadService=function(e,t){var r;if(this.initializatonInProgress[e])throw"Unable to initialize service due to cyclic dependency: "+e;try{this.initializatonInProgress[e]=!0,r=new t.serviceFactory,t.options&&1==(1&t.options)&&a(r,{proxyFunctions:!0,ignoredProperties:{pageContext:!0}}),r._serviceStart&&r._serviceStart(this)}catch(t){throw delete this.initializatonInProgress[e],t}return this.serviceInstances[e]=r,delete this.initializatonInProgress[e],r},e}();function a(r,n){r[t[e].RemoteSerializationSettingsKey]=n}t[e].setRemoteSerializationSettings=a;new s(t[e].Services,t[e].RestClients)}("Context"),function(e){function r(e){return"Bearer "+e}t.Authentication={},Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r,i,o){if(void 0===r&&(r=n.EmptyGuidString),void 0===o&&(o=0),this.pageContext=e,this.namedTokenId=t,this.tokenType=o,i){var s=i.indexOf(".");this.publisherName=i.substr(0,s),this.extensionName=i.substr(s+1)}else this.appId=r||n.EmptyGuidString}return e.prototype.getAuthorizationHeader=function(e){return this.getSessionToken(e).then(function(e){return r(e.token)})},e.prototype.getSessionToken=function(e){var t=this;if(!e&&(this.tokenExpirationTime&&(new Date).getTime()>this.tokenExpirationTime.getTime()-6e4&&(delete this.tokenExpirationTime,delete this.tokenPromise),this.tokenPromise))return this.tokenPromise;var r={appId:this.appId,extensionName:this.extensionName,publisherName:this.publisherName,force:e,tokenType:this.tokenType,namedTokenId:this.namedTokenId},n=this.pageContext.getRestClient("IAuthenticationRestClient");return this.tokenPromise=n.createSessionToken(r).then(function(e){return t.tokenExpirationTime=e.validTo,e}),this.tokenPromise},e}(),o=function(){function e(e){this.header=r(e)}return e.prototype.getAuthorizationHeader=function(e){return Promise.resolve(this.header)},e}();t.Authentication.BearerTokenProvider=o;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getDefaultTokenProvider=function(){return this._defaultProvider||(this._defaultProvider=new i(this.pageContext)),this._defaultProvider},t.prototype.getNamedTokenProvider=function(e){return this.getTokenProvider(e,void 0,0)},t.prototype.getExtensionTokenProvider=function(e,t){return this.getTokenProvider(void 0,e,t)},t.prototype.getTokenProvider=function(e,t,r){var n=e+"."+t+"."+r;this._providers||(this._providers={});var o=this._providers[n];return o||(o=new i(this.pageContext,e,void 0,t,r),this._providers[n]=o),o},t.prototype.getBearerTokenProvider=function(e){return{getAuthorizationHeader:function(t){return Promise.resolve(r(e))}}},t}(h.VssService);h.Services.add("IAuthenticationService",{serviceFactory:s})}(),function(e){t.Content={},Object.defineProperty(t,"__esModule",{value:!0});var n=new(function(){function e(){this.pendingContent={},this.loadedContent={},this.contentLengthsByContributionId={},this.observable=new r.Observable,window.__contentLoaded=this.loadComplete.bind(this),window.__loadScript=this.loadScript.bind(this)}return e.prototype.isContentAvailable=function(e){return!!this.loadedContent[this.getContentId(e)]},e.prototype.getContributionContentLengths=function(e){return this.contentLengthsByContributionId[e]},e.prototype.loadScript=function(e){var t,r=this,n=this.getContentId(e);if(this.loadedContent[n])t=Promise.resolve(e);else if(this.pendingContent[n])t=this.pendingContent[n].loadPromise;else{var i=window.performance.now();t=new Promise(function(t,n){var i;"text/javascript"===e.contentType?((i=document.createElement("script")).async=!1,i.src=e.url,e.integrity&&(i.integrity=e.integrity,i.crossOrigin="anonymous"),e.moduleNamespaces&&e.moduleNamespaces.length&&(window.__moduleNamespaces||(window.__moduleNamespaces=[]),window.__moduleNamespaces=window.__moduleNamespaces.concat(e.moduleNamespaces))):((i=document.createElement("link")).href=e.url,i.rel="stylesheet",i.crossOrigin="anonymous",e.integrity&&(i.integrity=e.integrity),i.setAttribute("crossorigin","anonymous")),i.setAttribute("data-contentlength",e.contentLength.toString()),e.clientId&&i.setAttribute("data-clientid",e.clientId),e.contributionId&&i.setAttribute("data-sourcecontribution",e.contributionId),i.addEventListener("load",function(e){t(r.loadComplete(e.target,!0))}),i.addEventListener("error",function(e){n(r.loadComplete(e.target,!1))}),document.head.appendChild(i)}),this.pendingContent[n]={startTime:i,loadPromise:t}}return t},e.prototype.getContentId=function(e){return e.clientId||e.url},e.prototype.loadComplete=function(e,t,r,n){var i={contentLength:parseInt(e.getAttribute("data-contentlength")),clientId:e.getAttribute("data-clientid"),contentType:"SCRIPT"===e.tagName.toUpperCase()?"text/javascript":"text/css",contributionId:e.getAttribute("data-sourcecontribution"),url:e instanceof HTMLScriptElement?e.src:e.href,integrity:e.getAttribute("integrity")},o=this.getContentId(i),s=this.pendingContent[o];delete this.pendingContent[o];var a={contentAttributes:i,contentElement:e,loadEnd:r=r||window.performance.now()};if(n&&(a.previousResourceLoadEnd=n),s&&(a.loadStart=s.startTime),t){if(this.loadedContent[o]=a,i.contributionId){var c=this.contentLengthsByContributionId[i.contributionId];c||(this.contentLengthsByContributionId[i.contributionId]=c={}),c[i.contentType]=(c[i.contentType]||0)+i.contentLength}this.observable.notify(a,"contentComplete",!0)}else this.observable.notify(a,"contentLoadError",!0);return i},e.prototype.subscribe=function(e){this.observable.subscribe(e)},e}()),i=function(e){function t(){var t=e.apply(this,arguments)||this;return t.completedContributions={},t.scriptComplete=function(e,r){var n=e.contributionId,i=r[n];return i&&(r[n]=i-1,1===i&&(t.completedContributions[n]||(t._notify({contributionId:n},"contributionComplete",!0),t.completedContributions[n]=!0))),e},t}return __extends(t,e),t.prototype._serviceStart=function(t){var r=this;e.prototype._serviceStart.call(this,t),n.subscribe(function(e,t){r._notify(e,t,!0)});for(var i=document.querySelectorAll("[data-sourcecontribution]"),o=0;o<i.length;o++){var s=i[o].getAttribute("data-sourcecontribution");this.completedContributions[s]||(this._notify({contributionId:s},"contributionComplete",!0),this.completedContributions[s]=!0)}},t.prototype.loadScript=function(e){return n.loadScript(e)},t.prototype.loadScripts=function(e){for(var t=this,r=[],i={},o=0,s=e;o<s.length;o++){var a=s[o];if(!n.isContentAvailable(a)){var c=a.contributionId;c&&(i[c]?i[c]=i[c]+1:i[c]=1)}r.push(this.loadScript(a).then(function(e){return t.scriptComplete(e,i)},function(e){return t.scriptComplete(e,i)}))}return Promise.all(r)},t.prototype.getContributionContentLengths=function(e){return n.getContributionContentLengths(e)},t}(h.VssObservableService);h.Services.add("IVssContentService",{serviceFactory:i,options:6})}(),function(e){function r(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];for(var s=Array.isArray(t),a=1===e.arrayOptions,c=!1!==e.deepClone,u=0,p=r;u<p.length;u++){var l=p[u];s&&Array.isArray(l)?(a||(t.length=0),t.push.apply(t,c?n(l):l)):i(t,l,c,a)}return t}function n(e){for(var t=[],r=0,o=e.length;r<o;r++){var s=e[r];"object"!=typeof s||null===s||s instanceof Date?t[r]=s:Array.isArray(s)?t[r]=n(s):t[r]=i({},s,!0,!1)}return t}function i(e,t,r,o){for(var s in t){var a=t[s],c=e[s];if("object"!=typeof c||null===c||c instanceof Date)!r||"object"!=typeof a||null===a||a instanceof Date?e[s]=a:Array.isArray(a)?e[s]=n(a):e[s]=i({},a,r,o);else{var u=Array.isArray(c);if(u&&Array.isArray(a))if(o){r&&n(a),e[s]=c.concat(a)}else e[s]=r?n(a):a;else if("object"!=typeof a||null===a||a instanceof Date)e[s]=a;else{var p=u?c.slice():Object.assign({},c);e[s]=i(p,a,r,o)}}}return e}v=t.UtilObject={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilObject.deepMerge=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(void 0,[{deepClone:!0,arrayOptions:0},e].concat(t))},t.UtilObject.deepMergeWithOptions=r}(),function(e){f=t.UtilSerialization={},Object.defineProperty(t,"__esModule",{value:!0});var r=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g");function n(e){var t=null;if(e){var n=e.replace(r,'$1{"__msjson_date__":$2 }');t=JSON.parse(n),n!==e&&function e(t,r,n){if(r&&"number"==typeof t.__msjson_date__)r[n]=new Date(t.__msjson_date__);else for(var i in t){var o=t[i];null!==o&&"object"==typeof o&&e(t[i],t,i)}}(t,null,"")}return t}function i(e,t,r){window.jsonIslandData||(window.jsonIslandData={}),window.jsonIslandData[e]=t,r&&(window[e]=t)}t.UtilSerialization.deserializeVssJsonObject=n,t.UtilSerialization.readJsonScript=function(e,t,r){if(window.jsonIslandData&&window.jsonIslandData[e])return window.jsonIslandData[e];var o=document.getElementById(e),s=null;if(o){var a=o.textContent;a&&(s=n(a)),r&&o.parentElement&&o.parentElement.removeChild(o)}return i(e,s,t),s},t.UtilSerialization.updateJsonScriptValue=i}(),function(e){t.Contribution={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=e.apply(this,arguments)||this;return t.dataProviderExceptions={},t.clientProviders={},t.dataProviders={},t.sharedData={},t.pendingContributions={},t.loadedContentContributions={},t.onContributionLoaded=function(e){t.loadedContentContributions[e.contributionId]=!0},t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t),this.contentService=this.pageContext.getService("IVssContentService"),this.contentService.subscribe(this.onContributionLoaded,"contributionComplete");var r=f.readJsonScript("dataProviders",!0);r&&(this._applyData(r.data,r.sharedData,r.exceptions,r.clientProviders,void 0),this.dataProviderScope||(this.dataProviderScope={name:r.scopeName,value:r.scopeValue})),this.contributionPageData=this.getData("ms.vss-web.page-data")},t.prototype._serviceEnd=function(t){e.prototype._serviceEnd.call(this,t),this.contentService.unsubscribe(this.onContributionLoaded,"contributionComplete")},t.prototype.executeCommand=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(n){switch(n.label){case 0:return[4,this.getContributionAsync(e)];case 1:return(r=n.sent())?[2,this.executeCommandEx(e,r,t)]:[2,Promise.resolve(null)]}})})},t.prototype.executeCommandEx=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n,i,o;return __generator(this,function(s){switch(s.label){case 0:return n=null,t?[4,this.getServiceEx(e,t)]:[3,2];case 1:(i=s.sent())&&(o=i[t.methodName])&&(n=o.apply(i,t.methodArguments||r)),s.label=2;case 2:return[2,n]}})})},t.prototype.getContributionData=function(){return this.getSharedData("_contributions")},t.prototype.getContribution=function(e){var t=void 0,r=this.getContributionData();return r&&r.contributions&&(t=r.contributions[e]),t},t.prototype.getContributionAsync=function(e,t,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return[2,this.getContributionsAsync([e],t,r).then(function(e){return e[0]})]})})},t.prototype.getContributionsAsync=function(e,t,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return[2,this.getContributionsAsyncInternal(e,t,r)]})})},t.prototype.getContributionsAsyncInternal=function(e,t,r,n){return __awaiter(this,void 0,void 0,function(){var i,o,s,a,c,u,p,l,d,h,v,f,g,m,y,b,S,_,C;return __generator(this,function(w){switch(w.label){case 0:if(i=this.getContributionData(),o=i&&i.contributions||{},s=this._getParametersKey(t),!this.contributionPageData)return[3,3];for(a=[],c=[],u=0,p=e;u<p.length;u++)_=p[u],(l=this.pendingContributions[_+"/"+s])?c.push(l):(r||!o.hasOwnProperty(_)&&!this.loadedContentContributions[_]&&void 0===this.getData(_,t))&&a.push(_);if(a.length>0)for(d=this.fetchContributionsAsync(a,t,n),c.push(d),h=0,v=a;h<v.length;h++)m=v[h],this.pendingContributions[m+"/"+s]=d;return c.length?[4,Promise.all(c)]:[3,2];case 1:w.sent(),w.label=2;case 2:for(i=this.getContributionData(),o=i&&i.contributions||{},f=0,g=a;f<g.length;f++)m=g[f],delete this.pendingContributions[m+"/"+s],i&&!i.contributions.hasOwnProperty(m)&&(i.contributions[m]=void 0);w.label=3;case 3:for(y=[],b=0,S=e;b<S.length;b++)_=S[b],C=o[_],y.push(C);return[2,y]}})})},t.prototype.fetchContributionsAsync=function(e,t,r){return __awaiter(this,void 0,void 0,function(){var n,i;return __generator(this,function(o){switch(o.label){case 0:return n=Object.assign({},t),this._notify({contributionIds:e,properties:n},"dpqStarting"),[4,this.pageContext.getRestClient("IWebContributionsRestClient",{serviceInstanceType:r}).queryContributedHierarchy({contributionIds:e,dataProviderContext:{properties:n}},this.dataProviderScope.name,this.dataProviderScope.value)];case 1:return i=o.sent(),this._applyData(i.dataProviders,i.dataProviderSharedData,i.dataProviderExceptions,void 0,t),i.content?[4,this.contentService.loadScripts(i.content)]:[3,3];case 2:o.sent(),o.label=3;case 3:return this._notify({dataProviders:i.dataProviders,dataProviderSharedData:i.dataProviderSharedData,dataProviderExceptions:i.dataProviderExceptions},"dpqCompleted"),[2]}})})},t.prototype.getContributionChildren=function(e,t){var r=[],n=this.getContributionData();if(n&&n.relationships){var i={};if(n.relationships[e]){var o=n.relationships[e];o.children&&(i=o.children)}for(var s in n.relationships){var a=n.relationships[s];a&&a.parents&&a.parents[e]&&(i[s]=!0)}if(t){var c=this.getContributionIdsByType(t);if(!c||0===c.length)return r;for(var u=0,p=c;u<p.length;u++){var l=p[u];i[l]&&r.push(l)}}else r=Object.keys(i)}return r},t.prototype.getContributionIdsByType=function(e){var t=[],r=this.getContributionData();if(r&&r.types&&r.types[e]){var n=r.types[e];n&&(t=Object.keys(n))}return t},t.prototype.getContributionsByType=function(e){var t=this.getContributionIdsByType(e),r={},n=this.getContributionData();if(n)for(var i=0,o=t;i<o.length;i++){var s=o[i];r[s]=n.contributions[s]}return r},t.prototype.getContributionProvider=function(e){var t,r=this.getContributionData();if(r&&r.providers){var n=e.split("."),i=n[0]+"."+n[1];(t=r.providers[i])&&(t.id=i)}return t},t.prototype.getData=function(e,t){var r=void 0,n=this._getParametersKey(t),i=this.dataProviders[e];return i&&(r=i[n]),r},t.prototype.getDataAsync=function(e,t,r,n){return __awaiter(this,void 0,void 0,function(){var i,o,s,a,c;return __generator(this,function(u){switch(u.label){case 0:if(i=r?void 0:this.getData(e,t))return[3,2];for(s in o=void 0,this.clientProviders)if(-1!==this.clientProviders[s].contributionIds.indexOf(e)){a=this.clientProviders[s],n=n||a.queryServiceInstanceType,o=a.context.properties;break}return c=Object.assign({},o,t),[4,this.getContributionsAsyncInternal([e],c,!0,n)];case 1:u.sent(),i=this.getData(e,c),u.label=2;case 2:return[2,Promise.resolve(i)]}})})},t.prototype.getSharedData=function(e){return this.sharedData[e]},t.prototype.getServiceSync=function(e,t){var r=this,n=this.getContribution(e);if(n)return n.dependencies&&n.dependencies.forEach(function(e){r.getContribution(e)||r.loadedContentContributions[e]}),this.pageContext.getService(n.serviceName,t,!0)},t.prototype.getService=function(e,t){var r=this;return this.getContributionAsync(e).then(function(n){return n?r.getServiceEx(e,n,t):Promise.reject(void 0)})},t.prototype.getServiceEx=function(e,t,r){var n=this;return(t.dependencies&&t.dependencies.length?this.getContributionsAsync(t.dependencies):Promise.resolve()).then(function(){var i=n.pageContext.getService(t.serviceName,r,!0);return i||n.getContributionAsync("ms.vss-web.remote-service-providers").then(function(r){return n.getChildServices("ms.vss-web.remote-service-providers","ms.vss-web.service").then(function(r){return r.length?r[0].service.getService(e,t):void 0})})})},t.prototype.getChildServices=function(e,t){var r=this.getChildServicesEx(e,t);return Promise.all(r.map(function(e){return e.service})).then(function(e){for(var t=[],n=0,i=r.length;n<i;n++)e[n]&&t.push({id:r[n].id,service:e[n]});return t})},t.prototype.getChildServicesEx=function(e,t){for(var r=[],n=0,i=this.getContributionChildren(e,t);n<i.length;n++){var o=i[n];r.push({id:o,service:this.getService(o)})}return r},t.prototype.getDataProviderExceptions=function(){return this.dataProviderExceptions},t.prototype._applyData=function(e,t,r,n,i){if(e){var o=this._getParametersKey(i);for(var s in e){var a=this.dataProviders[s];a||(this.dataProviders[s]=a={}),a[o]=e[s]}}if(t)for(var c in t){var u=t[c],p=this.sharedData[c];p&&(u=v.deepMergeWithOptions({deepClone:!1},p,u)),this.sharedData[c]=u}if(n)for(var l in n)this.clientProviders[l]=n[l];if(r)for(var s in r){var d=r[s];this.dataProviderExceptions[s]=d,console.warn("ContributionData unavailable for '"+s+"', ExceptionType: '"+d.exceptionType+"', Reason: "+d.message+", StackTrace: "+d.stackTrace)}},t.prototype._getParametersKey=function(e){return e?JSON.stringify(e):"{}"},t}(h.VssObservableService);h.Services.add("IVssContributionService",{serviceFactory:r});var n=function(e){function t(){var t=e.apply(this,arguments)||this;return t._lastSubscriptions={},t.onContributionDataLoaded=function(){t._lastSubscriptions=t.loadContributedSubscriptions(t._lastSubscriptions)},t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t),this._contributionService=this.pageContext.getService("IVssContributionService"),this._contributionService.subscribe(this.onContributionDataLoaded,"dpqCompleted"),this._lastSubscriptions=this.loadContributedSubscriptions({})},t.prototype._serviceEnd=function(t){e.prototype._serviceEnd.call(this,t),this._contributionService.unsubscribe(this.onContributionDataLoaded,"dpqCompleted")},t.prototype.fireEvent=function(e,t,r){var n={name:e,data:t};this._notify(n,e,r)},t.prototype.loadContributedSubscriptions=function(e){var t=this.pageContext.getService("IVssContributionService"),r=this._contributionService.getContributionsByType("ms.vss-web.event-subscription"),n=function(n){if(!e[n]){var o=r[n];i.subscribe(function(e){o.command?t.executeCommandEx(n,o.command,e):o.commandId&&t.executeCommand(o.commandId,e)})}},i=this;for(var o in r)n(o);return r},t}(h.VssObservableService);t.Contribution.VssContributedEventService=n,h.Services.add("IVssContributionEventService",{serviceFactory:n})}(),function(e){function r(e,t,r,n,i){void 0===r&&(r="/");var o=[e+"="+t,"path="+r];n&&o.push("expires="+n),i&&o.push("max-age="+i),-1!==window.location.protocol.indexOf("https")&&o.push("secure"),document.cookie=o.join(";")}g=t.UtilCookie={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilCookie.getCookie=function(e){if(document.cookie&&document.cookie.length>0&&e)for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return decodeURIComponent(i.substring(t.length))}return""},t.UtilCookie.setCookie=r,t.UtilCookie.deleteCookie=function(e,t){void 0===t&&(t="/"),r(e,"",t,"Thu, 01 Jan 1970 00:00:01 GMT")}}(),function(e){m=t.Fetch={},Object.defineProperty(t,"__esModule",{value:!0});var n=0,i=new r.Observable;t.Fetch.requestListeners=i,t.Fetch.issueRequest=function(e,t,r){return __awaiter(this,void 0,void 0,function(){var o,s,a,c,u,p,l,h,v,f,m,y,b,S;return __generator(this,function(_){switch(_.label){case 0:o=++n,s=void 0,_.label=1;case 1:if(_.trys.push([1,,12,13]),i.notify({requestId:o,requestUrl:e,options:t,vssRequestOptions:r},"beforeRequest"),t||(t={}),a=void 0,t.headers){if(t.headers instanceof Headers)a=t.headers;else if(a=new Headers,"function"==typeof t.headers.hasOwnProperty)for(c in t.headers)t.headers.hasOwnProperty(c)&&a.append(c,t.headers[c])}else a=new Headers;t.headers=a,a.append("X-VSS-ReauthenticationAction","Suppress"),r&&(u=r.sessionId,p=r.command,u&&(p?a.append("X-TFS-Session",u+","+p):a.append("X-TFS-Session",u))),t.credentials="same-origin",(l=g.getCookie("AzDevRequestFaults"))&&a.append("AzDevRequestFaults",l),h=!1,_.label=2;case 2:return r&&r.authTokenProvider?(f=(v=a).append,m=["Authorization"],[4,r.authTokenProvider.getAuthorizationHeader(h)]):[3,4];case 3:f.apply(v,m.concat([_.sent()])),a.append("X-TFS-FedAuthRedirect","Suppress"),_.label=4;case 4:return _.trys.push([4,6,,7]),[4,fetch(e,t)];case 5:return s=_.sent(),[3,7];case 6:throw y=_.sent(),console.warn("Unhandled exception in fetch for "+e+": "+(y&&y.toString())),(b=new Error(d.NetworkError)).name="NetworkException",b;case 7:if(401===s.status&&!h&&r&&r.authTokenProvider)return h=!0,[3,8];_.label=8;case 8:_.label=9;case 9:return s.ok?[3,11]:((b=new Error).name="TFS.WebApi.Exception",b.status=s.status,S=b,[4,s.text()]);case 10:if(S.responseText=_.sent(),b.responseText&&""!==b.responseText)try{b.serverError=JSON.parse(b.responseText),b.serverError&&b.serverError.message&&(b.message=b.serverError.message)}catch(e){}throw b.message||(b.message=s.status+": "+s.statusText),b;case 11:return[3,13];case 12:return i.notify({requestId:o,requestUrl:e,response:s,vssRequestOptions:r},"afterRequest"),[7];case 13:return[2,s]}})})}}(),function(e){t.Page={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getData=function(){return this.pageContext.getService("IVssContributionService").getData("ms.vss-web.page-data")},t}(h.VssService);h.Services.add("IVssPageService",{serviceFactory:r})}(),function(e){function r(e,t){return e===t?0:e>t?1:-1}y=t.UtilArray={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilArray.groupBy=function(e,t){for(var r={},n=0,i=e;n<i.length;n++){var o=i[n],s=t(o)||"",a=r[s];a?a.push(o):r[s]=[o]}return r},t.UtilArray.toLookup=function(e,t){for(var r={},n=0,i=e;n<i.length;n++){var o=i[n];r[t(o)]=o}return r},t.UtilArray.stableSort=function(e,t){var r=new Array(e.length);return function e(n,i,o){var s=o-i;if(!(s<2)){var a=i+Math.floor(s/2);e(n,i,a),e(n,a,o),function(e,n,i,o){for(var s=n,a=i,c=0;s<i&&a<o;)t(e[s],e[a])<=0?(r[c]=e[s],s++):(r[c]=e[a],a++),c++;for(;s<i;)r[c]=e[s],c++,s++;for(;a<o;)r[c]=e[a],c++,a++;for(s=0;s<o-n;s++)e[s+n]=r[s]}(n,i,a,o)}}(e,0,e.length),e},t.UtilArray.uniqueSort=function(e,t){void 0===t&&(t=r),e.sort(t);for(var n=1,i=e.length;n<i;n++)0===t(e[n],e[n-1])&&(e.splice(n--,1),i--);return e},t.UtilArray.defaultComparer=r}(),function(e){function r(e,t){void 0===t&&(t=null);var r=null;try{r=localStorage.getItem(e)}catch(e){}return null===r?t:r}function n(e,t){try{return null==t?localStorage.removeItem(e):localStorage.setItem(e,t),!0}catch(e){return!1}}b=t.UtilStorage={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilStorage.tryGetLocalStorageValue=r,t.UtilStorage.tryGetLocalStorageObject=function(e,t){var n=r(e);if(!n)return t;try{return JSON.parse(n)}catch(e){return t}},t.UtilStorage.trySetLocalStorageValue=n,t.UtilStorage.trySetLocalStorageObject=function(e,t){return n(e,t?JSON.stringify(t):void 0)}}(),function(e){t.Telemetry={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=e.apply(this,arguments)||this;return t.events=[],t._onWindowUnload=function(){t.unloading=!0,t.events.length&&(t._writeEventsToLocalStorage.apply(t,t.events),t.events=[])},t}return __extends(t,e),t.prototype._serviceStart=function(t){var r;e.prototype._serviceStart.call(this,t),this._initializeService(),this.publishInterval=window.setInterval(this._sendEvents.bind(this),1e3),window.addEventListener("unload",this._onWindowUnload);var n=this._readEventsFromLocalStorage();n&&(r=this.events).push.apply(r,n)},t.prototype._serviceRestart=function(t){e.prototype._serviceRestart.call(this,t),this._sendEvents(),this._initializeService()},t.prototype._serviceEnd=function(t){this.publishInterval&&(window.clearInterval(this.publishInterval),this.publishInterval=0),window.removeEventListener("unload",this._onWindowUnload),e.prototype._serviceEnd.call(this,t)},t.prototype.publishEvent=function(e,t,r,n){var i=Object.assign({},r);this.sessionId&&(i.SessionId=this.sessionId),i.EventTimestamp=(new Date).getTime(),e||(console.warn("Publishing telemetry event with unknown area. Feature: "+t+". Properties: "+JSON.stringify(i)),e="Unknown"),t||(console.warn("Publishing telemetry event with unknown feature. Area: "+e+". Properties: "+JSON.stringify(i)),t="Unknown");var o={area:e,feature:t,properties:i,serviceInstanceType:n};this._notify(o,"publish"),this.unloading?this._writeEventsToLocalStorage(o):this.events.push(o)},t.prototype._initializeService=function(){var e=this.pageContext.getService("IVssPageService").getData();e&&(this.sessionId=e.sessionId,this.hostId=e.hostId)},t.prototype._sendEvents=function(){var e=this,t=y.groupBy(this.events,function(e){return e.serviceInstanceType});this.events=[],Object.keys(t).forEach(function(r){try{var n=e.pageContext.getRestClient("ICustomerIntelligenceRestClient",{serviceInstanceType:r||void 0});t[r].forEach(function(e){delete e.serviceInstanceType}),n.publishEvents(t[r])}catch(e){console.error(e)}})},t.prototype._readEventsFromLocalStorage=function(){var e,t="ciEvents/"+this.hostId;return(e=b.tryGetLocalStorageObject(t))&&b.trySetLocalStorageObject(t,void 0),e},t.prototype._writeEventsToLocalStorage=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e,n=this._readEventsFromLocalStorage();n&&(r=n.concat(r)),b.trySetLocalStorageObject("ciEvents/"+this.hostId,r)},t}(h.VssObservableService);h.Services.add("IVssTelemetryService",{serviceFactory:r,options:2})}(),function(e){S=t.Theming={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t),this._initializeTheme()},t.prototype._serviceRestart=function(t){e.prototype._serviceRestart.call(this,t),this._initializeTheme()},t.prototype._serviceEnd=function(t){e.prototype._serviceEnd.call(this,t)},t.prototype.getCSSVariablesContent=function(){var e=[],t=this.currentTheme.data;if(t)for(var r in t)e.push("--"+r+": "+t[r]);return e.join("; ")},t.prototype.getThemeValue=function(e){return i.expandThemeableProperties("var(--"+e+")",this.currentTheme.data)},t.prototype.getCurrentTheme=function(){return this.currentTheme},t.prototype._initializeTheme=function(){var e=void 0;(e=b.tryGetLocalStorageObject("user-custom-theme"))||(e=this.pageContext.getService("IVssContributionService").getData("ms.vss-web.theme-data"));this.currentTheme=e||{id:"empty-theme",name:"",data:{}},this.applyTheme(this.currentTheme)},t.prototype.applyTheme=function(e){this.currentTheme=e,this._notify(e,"themeChanged"),this.contentElement||(this.contentElement=document.createElement("style"),this.contentElement.type="text/css",document.head.appendChild(this.contentElement)),this.contentElement.innerText=":root { "+this.getCSSVariablesContent()+" }"},t.prototype.saveCustomUserTheme=function(e){b.trySetLocalStorageObject("user-custom-theme",e)},t}(h.VssObservableService);t.Theming.getCurrentTheme=function(e){return e.getService("IVssThemeService").getCurrentTheme()},h.Services.add("IVssThemeService",{serviceFactory:r,options:6})}(),function(e){t.Performance={},Object.defineProperty(t,"__esModule",{value:!0});var r=Math.random()<.02,i=new RegExp("//(.*?)/");function o(e){if(e){var t=i.exec(e);return t?t[1]:void 0}}var s,a,c=function(e){function t(){var t=e.apply(this,arguments)||this;return t.activeScenarios={},t.completedScenarios=[],t.pageNavigateScenario=!0,t.pageNavigateSplitTimings=[],t._afterRequest=function(e,r){if(t.performanceData.contentData.ajaxCount++,e.response&&e.response.ok){var n=e.response.headers.get("content-length");n&&(t.performanceData.contentData.ajaxSize+=parseInt(n))}},t._completedContentCache=[],t._contentComplete=function(e,r){"text/css"===e.contentAttributes.contentType?(t.performanceData.contentData.cssCount++,t.performanceData.contentData.cssSize+=e.contentAttributes.contentLength):"text/javascript"===e.contentAttributes.contentType&&(t.performanceData.contentData.scriptsCount++,t.performanceData.contentData.scriptSize+=e.contentAttributes.contentLength),"contentComplete"!==r||t.performanceData.timeToInteractive||t._completedContentCache.push(e)},t._legacyContentComplete=function(e){e&&e.detail&&e.detail.size&&(e.detail.isCss?(t.performanceData.contentData.cssCount++,t.performanceData.contentData.cssSize+=e.detail.size):(t.performanceData.contentData.scriptsCount++,t.performanceData.contentData.scriptSize+=e.detail.size))},t.fpsLoading=function(){t.pageNavigateScenario=!1,t.navigationStartTime=Date.now(),window.lwpLastNavigationStartTime=t.navigationStartTime,document.body.dispatchEvent(new CustomEvent("lwpPerfNavigationReset",{cancelable:!1,detail:{}})),t.activeScenarios={},t.pageNavigateSplitTimings=[]},t.scenarioStarted=function(e){var r=e.detail.descriptor;r&&t.startScenario(r.getName(),r.isPageInteractive(),r.getStartTime())},t.scenarioCompleted=function(e){var r=e.detail.scenarioDetail;if(r){var n=r.scenario,i=r.telemetryData;n.isPageInteractive()?t.markTimeToInteractive(n.getFeatureArea(),n.getName(),n.getEndTime(),n.getData(),n.getSplitTimings(),i):t.endScenario(n.getFeatureArea(),n.getName(),!1,n.getEndTime(),n.getData(),n.getSplitTimings(),i)}},t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t),this.resetPerformanceData(!0),this.navigationStartTime=window.performance.timing.navigationStart;var r=this.pageContext.getService("IVssContentService");r.subscribe(this._contentComplete,"contentComplete"),r.subscribe(this._contentComplete,"contentLoadError"),m.requestListeners.subscribe(this._afterRequest,"afterRequest"),document.addEventListener("scenarioStarted",this.scenarioStarted),document.addEventListener("scenarioCompleted",this.scenarioCompleted),document.addEventListener("legacyContentElementLoaded",this._legacyContentComplete),this.initializeService(),document.body.addEventListener("fpsLoading",this.fpsLoading)},t.prototype._serviceRestart=function(t){e.prototype._serviceRestart.call(this,t),this.resetPerformanceData(!1),this.initializeService()},t.prototype.initializeService=function(){var e=this.pageContext.getService("IVssPageService").getData();e&&(this.isDebugMode=e.isDebugMode,this.sessionId=e.sessionId,this.pageId=e.sessionId,this.serviceVersion=e.serviceVersion);var t=f.readJsonScript("serverStatistics",!0);if(this.serverStatistics=t?t.serverTimings:null,this.performanceInsights=t?t.insights:void 0,this.serverStatistics)for(var r in this.serverStatistics){var n=this.serverStatistics[r];switch(r){case"AAD":case"ServiceBus":this.performanceData.serverPerformanceData.totalRemote+=n.count;break;case"BlobStorage":case"TableStorage":this.performanceData.serverPerformanceData.storage+=n.count,this.performanceData.serverPerformanceData.totalRemote+=n.count;break;case"Redis":this.performanceData.serverPerformanceData.redis+=n.count,this.performanceData.serverPerformanceData.totalRemote+=n.count;break;case"SQL":this.performanceData.serverPerformanceData.sql+=n.count,this.performanceData.serverPerformanceData.totalRemote+=n.count;break;case"VssClient":this.performanceData.serverPerformanceData.rest+=n.count,this.performanceData.serverPerformanceData.totalRemote+=n.count}}},t.prototype.setNewSessionId=function(){this.sessionId=n.newGuid()},t.prototype.isFastPageSwitchScenario=function(){return!this.pageNavigateScenario},t.prototype.addSplitTiming=function(e,t){if(t){var r=this.activeScenarios[t];r&&(r.splitTimings||(r.splitTimings=[]),r.splitTimings.push({name:e,timestamp:Date.now()-r.startTime}))}else this.pageNavigateSplitTimings.push({name:e,timestamp:Date.now()-this.navigationStartTime})},t.prototype.getCompletedScenarios=function(){return this.completedScenarios},t.prototype.getServerStatistics=function(){return this.serverStatistics},t.prototype.getPerformanceInsights=function(){return this.performanceInsights},t.prototype.getEntriesByName=function(e){return s.getEntriesByName(e)},t.prototype.getTimingByName=function(e){return s.getTimingByName(e)},t.prototype.getPerformanceData=function(){return this.performanceData},t.prototype.endScenario=function(e,t,r,n,i,o,c){var p=this.activeScenarios[t];if(p&&!r||this.pageNavigateSplitTimings.length&&(o=this.pageNavigateSplitTimings.concat(o?o.slice():[])),p?(p.properties=Object.assign(p.properties,i),p.isPageInteractive=r,p.splitTimings||(p.splitTimings=[]),delete this.activeScenarios[t]):p={elaspsedTicks:-1,endTime:n||Date.now(),isPageInteractive:r,properties:Object.assign({},i),scenarioName:t,sessionId:this.pageId,splitTimings:[],startTime:this.navigationStartTime},o&&o.length&&(p.splitTimings=p.splitTimings.concat(o)),p.endTime=n||Date.now(),p.featureArea=e,p.elaspsedTicks=p.endTime-p.startTime,this.completedScenarios.push(p),r){this.performanceData.timeToInteractive=p.endTime-p.startTime,this.performanceData.backgroundTab=document.hidden;g.getCookie("TFS-BREAK-TTI");this.setNewSessionId()}var l=c;l&&l.properties&&r?Object.assign(l.properties,this.performanceData.contentData):(l=this.getScenarioTelemetry(p),c&&(l.serviceInstanceType=c.serviceInstanceType,Object.assign(l.properties,c.properties))),l.properties.LWLS=!0,r&&(l.properties.isTTI=!0,l.properties.theme=S.getCurrentTheme(this.pageContext).id);var d=this.pageContext.getService("IVssTelemetryService");if(d.publishEvent(l.area,l.feature,l.properties,l.serviceInstanceType),r){var h=this._shouldCollectResourceTimings(),v=this.getTimingTelemetry(h);v&&d.publishEvent(v.area,v.feature,v.properties,l.serviceInstanceType),this._completedContentCache=[]}if(void 0===n||r){var f=u(p,a.End);s.mark(f);var m=r?"navigationStart":u(p,a.Start);s.measure(p.scenarioName,m,f)}(this._notify(p,"scenarioComplete"),r)&&this.pageContext.getService("IVssContributionEventService").fireEvent("page-interactive",p,!0);return p},t.prototype.markTimeToInteractive=function(e,t,r,n,i,o){return this.endScenario(e,t,!0,r,n,i,o)},t.prototype.startScenario=function(e,t,r,n){var i=!1,o=this.activeScenarios[e];return r||(i=!0,r=Date.now()),o||(o=this.activeScenarios[e]={elaspsedTicks:-1,endTime:-1,featureArea:"",isPageInteractive:t,properties:Object.assign({},n),scenarioName:e,sessionId:this.sessionId,splitTimings:[],startTime:r}),i&&s.mark(u(o,a.Start)),o},t.prototype.getDefaultNavigationEvents=function(e){var t=[];try{for(var r=0,n=[{name:"PLT",startEvent:"navigationStart",endEvent:"loadEventEnd",isAggregate:!0},{name:"Redirect",startEvent:"redirectStart",endEvent:"redirectEnd"},{name:"Unload",startEvent:"unloadEventStart",endEvent:"unloadEventEnd"},{name:"Fetch",startEvent:"fetchStart",endEvent:"domainLookupStart"},{name:"DNS",startEvent:"domainLookupStart",endEvent:"domainLookupEnd"},{name:"TCP",startEvent:"connectStart",endEvent:"connectEnd"},{name:"SSL",startEvent:"secureConnectionStart",endEvent:"connectEnd"},{name:"Request",startEvent:"connectEnd",endEvent:"responseStart"},{name:"Server Time",startEvent:"connectEnd",endEvent:"responseEnd",isAggregate:!0},{name:"Response",startEvent:"responseStart",endEvent:"responseEnd"},{name:"DOMInteractive",startEvent:"domInteractive",endEvent:"domComplete"},{name:"DOMProcessing",startEvent:"domLoading",endEvent:"domComplete"},{name:"onLoad",startEvent:"loadEventStart",endEvent:"loadEventEnd"},{name:"Network Time",startEvent:"domainLookupStart",endEvent:"connectEnd"},{name:"PreRequest",startEvent:"navigationStart",endEvent:"connectEnd",isAggregate:!0},{name:"RequestResponse",startEvent:"connectEnd",endEvent:"responseEnd",isAggregate:!0}];r<n.length;r++){var i=n[r],o=s.getEntriesByName(i.name);if(0===o.length){if(null==s.getTimingByName(i.startEvent)&&0===s.getEntriesByName(i.startEvent).length||null==s.getTimingByName(i.endEvent)&&0===s.getEntriesByName(i.endEvent).length)continue;s.measure(i.name,i.startEvent,i.endEvent),o=s.getEntriesByName(i.name)}var a=o.map(function(e){return{name:e.name,startTime:e.startTime,duration:e.duration}})[0];i.perfEntry=a,t.push(i)}}catch(e){0}if(e){var c=0;e.endTime&&(c=e.startTime-e.endTime);var u={name:"TTI",perfEntry:{name:"TTI",duration:c,startTime:0},startEvent:"navigationStart",endEvent:e.scenarioName,isAggregate:!0};u&&t.push(u)}return t},t.prototype.getResourceTimingEntries=function(){return s.getEntriesByType("resource")||[]},t.prototype.getTimingTelemetry=function(e){var t=this._getContentTelemetryProperties(e);if(!t)return null;var r={area:"Performance",feature:"ResourceTiming",properties:t};if(r.properties.individualTimings)for(var n=JSON.stringify(r,null,2);n.length>3e4;){var i=n.length-3e4,o=Math.ceil(i/450),s=Object.keys(r.properties.individualTimings);if(s.length<=10)return null;for(var a=0,c=s.slice(Math.max(20,s.length-o));a<c.length;a++){var u=c[a];delete r.properties.individualTimings[u]}n=JSON.stringify(r,null,2)}return r},t.prototype.getScenarioTelemetry=function(e){var t=this.navigationStartTime,r={activityId:e.sessionId,backgroundTab:document.hidden,debugMode:this.isDebugMode,elapsedTime:e.endTime-e.startTime,featureArea:e.featureArea||"",name:e.scenarioName,pageId:this.pageId,pageNavigateScenario:this.pageNavigateScenario,serviceVersion:this.serviceVersion,splitTimings:e.splitTimings,startTime:t,timeZoneOffset:(new Date).getTimezoneOffset()};if(r=Object.assign({},e.properties,r),e.isPageInteractive)try{var n=this._getPageInteractiveTelemetryProperties(r.pageNavigateScenario);Object.assign(r,n)}catch(e){}return{area:"Performance",feature:"Scenario",elapsedTime:e.endTime-e.startTime,properties:r}},t.prototype._getPageInteractiveTelemetryProperties=function(e){var t={},r={resourceCount:this.performanceData.contentData.cssCount+this.performanceData.contentData.scriptsCount,scriptResourceCount:this.performanceData.contentData.scriptsCount,cssResourceCount:this.performanceData.contentData.cssCount,ajaxRequests:this.performanceData.contentData.ajaxCount,scriptSize:this.performanceData.contentData.scriptSize,cssSize:this.performanceData.contentData.cssSize};if(e){for(var n=this.getDefaultNavigationEvents(),i=0;i<n.length;i++){var o=n[i].perfEntry;o&&(t[o.name]={start:o.startTime,duration:o.duration})}r.navigation=t;var s=window.resourceLoadStrategy;s&&(r.resourceLoadStrategy=s)}try{r.screen={h:window.screen.height,w:window.screen.width,winH:window.innerHeight,winW:window.innerWidth,winOH:window.outerHeight,winOW:window.outerWidth};var a=window.navigator;a&&a.connection&&(r.connection={rtt:a.connection.rtt,type:a.connection.effectiveType,downlink:a.connection.downlink})}catch(e){}return r},t.prototype.resetPerformanceData=function(e){this.performanceData={timeToInteractive:0,backgroundTab:!1,contentData:{ajaxCount:0,ajaxSize:0,cssCount:0,cssSize:0,other:"",scriptsCount:0,scriptSize:0},serverPerformanceData:{redis:0,rest:0,sql:0,storage:0,totalRemote:0},initialPageLoad:e}},t.prototype._shouldCollectResourceTimings=function(){var e=this.pageContext.getService("IVssPageService").getData(),t=window.location.href.indexOf("collectResourceTimings=true")>=0||document.cookie.indexOf("TFS-COLLECT-TIMING=true")>=0,n=this.performanceData.timeToInteractive>8e3;if(e){if(e.isBundlingEnabled&&!e.isDebugMode&&e.isCdnEnabled){if(r)return 1;if(n)return 2}if(t)return 3}return 0},t.prototype._getContentTelemetryProperties=function(e){var t={cdnResourceCount:0,diskcachedResourceCount:0,memcachedResourceCount:0,resourceCount:0,skippedResources:0,totalDuration:0,totalTransferSize:0},r={aggregate:t,reason:e};if(0!==e&&(r.individualTimings={}),0===this._completedContentCache.length)return null;try{for(var n={},i=this.getResourceTimingEntries(),s=0,a=i;s<a.length;s++){var c=a[s];n[c.name]=c}for(var u=0,p=this._completedContentCache;u<p.length;u++){var l=p[u];if(l.contentAttributes.clientId){var d=l.contentElement instanceof HTMLLinkElement?l.contentElement.href:l.contentElement.src,h=n[d],v=o(d),f=void 0,g=void 0,m=void 0;if(h&&(m=h.transferSize,g=Math.round(h.duration),f=this._extrapolateResourceLoadSource(h),v&&(t.resourceCount++,t.totalTransferSize+=m,t.cdnResourceCount+=v.indexOf("cdn")>=0?1:0,t.diskcachedResourceCount+=2===f?1:0,t.memcachedResourceCount+=1===f?1:0,t.totalDuration+=g,l.previousResourceLoadEnd?t.resourceStartTime=Math.min(t.resourceStartTime||l.previousResourceLoadEnd,l.previousResourceLoadEnd):l.loadStart&&(t.resourceStartTime=Math.min(t.resourceStartTime||l.loadStart,l.loadStart)),l.loadEnd&&(t.resourceEndTime=Math.max(t.resourceEndTime||l.loadEnd,l.loadEnd)))),r.individualTimings){var y={contentType:l.contentAttributes.contentType,contributionId:l.contentAttributes.contributionId,domain:v,loadStart:l.loadStart,loadEnd:l.loadEnd,previousResourceLoadEnd:l.previousResourceLoadEnd};h&&(Object.assign(y,{decodedBodySize:h.decodedBodySize,encodedBodySize:h.encodedBodySize,source:f,totalDuration:g,transferSize:m}),h.requestStart&&(y.requestStart=h.requestStart),h.responseStart&&(y.responseStart=h.responseStart),h.responseEnd&&(y.responseEnd=h.responseEnd)),r.individualTimings[l.contentAttributes.clientId]=y}}}}catch(e){console.warn("Error while collecting telemetry data: "+e&&e.message||e.toString())}return r},t.prototype._extrapolateResourceLoadSource=function(e){var t=e.responseStart-e.requestStart;return e.responseEnd-e.requestStart<10?1:t<60?2:3},t}(h.VssObservableService);function u(e,t){return e.scenarioName+"-"+(t===a.Start?"start":"end")}h.Services.add("IVssPerformanceService",{serviceFactory:c,options:6}),function(e){function t(e){return function(e){var t=window.performance&&window.performance.timing&&window.performance.timing[e]||null;return null!=t}(e)||n(e).length>0}function r(e){return window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByType(e)||[]}function n(e){return window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByName(e)||[]}e.mark=function(e){window.performance&&window.performance.mark&&window.performance.mark(e),console&&console.timeStamp&&console.timeStamp(e)},e.measure=function(e,r,n){if(window.performance&&window.performance.measure){if(!t(r)||!t(n))return;window.performance.measure(e,r,n)}},e.getEntriesByType=r,e.getEntriesByName=n,e.getMeasures=function(e){return r("measure")},e.getMarks=function(){return r("mark")},e.getTimingByName=function(e){return window.performance&&window.performance.timing&&window.performance.timing[e]||null}}(s=t.Performance.Timing||(t.Performance.Timing={})),function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(a||(a={}))}(),function(e){function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return e}).join(" ").trim()}_=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),o.PropTypes=a,o.createClass=c,t[e].css=n,t[e].Components=new r.ObservableObject;var i=function(r){function n(e,t){var i=r.call(this,e,t)||this;return t&&(i.context=t),i.componentId=++n.uniqueNumber,n.prototype.componentWillReceiveProps.__suppressDeprecationWarning=!0,i}return __extends(n,r),n.prototype.componentDidMount=function(){},n.prototype.componentDidUpdate=function(e,t,r){this._manageObservables(this.props)},n.prototype.componentWillReceiveProps=function(e){},n.prototype.componentWillUnmount=function(){if(this._manageObservables(),this.events&&(this.events.removeAllListeners(),delete this.events),this.timers&&(this.timers.clearAllTimers(),delete this.timers),this.promises)for(var e=0,t=this.promises;e<t.length;e++){t[e].cancel()}},n.prototype.addEventListener=function(e,t,r,n){this.events||(this.events=new u.EventManagement),this.events.addEventListener(e,t,r,n)},n.prototype.removeEventListener=function(e,t,r,n){this.events&&this.events.removeEventListener(e,t,r,n)},n.prototype.clearInterval=function(e){this.timers&&this.timers.clearInterval(e)},n.prototype.clearTimeout=function(e){this.timers&&this.timers.clearTimeout(e)},n.prototype.setInterval=function(e,t){for(var r,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return this.timers||(this.timers=new p.TimerManagement),(r=this.timers).setInterval.apply(r,[e,t].concat(n))},n.prototype.setTimeout=function(e,t){for(var r,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return this.timers||(this.timers=new p.TimerManagement),(r=this.timers).setTimeout.apply(r,[e,t].concat(n))},n.prototype.trackPromise=function(e){var t=this;this.promises||(this.promises=[]);var r=l.makeCancelable(e);return e.then(function(){t.promises=t.promises.filter(function(e){return e!==r})},function(){t.promises=t.promises.filter(function(e){return e!==r})}),this.promises.push(r),r},n.prototype.observe=function(e){this.observers={},this.observables||(this.observables={});for(var t=0,r=e;t<r.length;t++){var n=r[t];this.observers[n.propertyName]||(this.observers[n.propertyName]=[]),this.observers[n.propertyName].push(n)}this._manageObservables(this.props)},n.prototype._manageObservables=function(e){if(this.observables){for(var t in this.observables){for(var r=0,n=this.observables[t];r<n.length;r++){var i=n[r];i.observable.unsubscribe(i.observer,i.action)}delete this.observables[t]}if(e&&this.observers)for(var t in this.observers){var o=e[t];if(o&&o.subscribe&&o.unsubscribe)for(var s=0,a=this.observers[t];s<a.length;s++){var c=a[s];o.subscribe(c.observer,c.action),this.observables[t]||(this.observables[t]=[]),this.observables[t].push({observable:o,observer:c.observer,action:c.action})}}}},n.register=function(r,n){t[e].Components.add(r,n)},n}(o.Component);i.uniqueNumber=0,i.defaultProps={},i.contextTypes={pageContext:a.object},t[e].VssComponent=i;var d=function(e){function t(){var t=e.apply(this,arguments)||this;return t.onDataProviderQueryEnd=function(e){if(e.dataProviders){var r=e.dataProviders["ms.vss-web.component-data"];if(r)for(var n in r){var i=r[n],o=t.regionMapping[n];if(o)for(var s=function(e){o.some(function(t){return t.componentId===e.componentId})||o.push(e)},a=0,c=i;a<c.length;a++){s(c[a])}else t.regionMapping[n]=i}}},t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t),this.contributionService=this.pageContext.getService("IVssContributionService"),this.contributionService.subscribe(this.onDataProviderQueryEnd,"dpqCompleted"),this.regionMapping=this.contributionService.getData("ms.vss-web.component-data")||{}},t.prototype._serviceEnd=function(e){this.contributionService.unsubscribe(this.onDataProviderQueryEnd,"dpqCompleted")},t.prototype.getComponentsForRegion=function(e){var t=this.regionMapping[e];return t&&(t=t.slice()).sort(function(e,t){return(e.componentProperties&&e.componentProperties.componentOrder||Number.MAX_VALUE)-(t.componentProperties&&t.componentProperties.componentOrder||Number.MAX_VALUE)}),t},t.prototype.renderCallout=function(e){var t=document.createElement("div");document.body.appendChild(t);s.render(o.createElement(f,{pageContext:this.pageContext},e(function(){s.unmountComponentAtNode(t),document.body.removeChild(t)})),t)},t.prototype.getFullScreenMode=function(){return this._fullScreenMode||(this._fullScreenMode=new r.ObservableValue(-1!==window.location.href.indexOf("fullScreen=true"))),this._fullScreenMode},t.prototype.setFullScreenMode=function(e){this._fullScreenMode?this._fullScreenMode.value=e:this._fullScreenMode=new r.ObservableValue(e),e?document.body&&document.body.classList.add("full-screen-mode"):document.body&&document.body.classList.remove("full-screen-mode")},t}(h.VssService);h.Services.add("IVssLayoutManager",{serviceFactory:d});var v=function(e){function t(){var t=e.apply(this,arguments)||this;return t.reactRootKey=0,t}return __extends(t,e),t.prototype._serviceStart=function(t){var r=this;e.prototype._serviceStart.call(this,t),document.body.addEventListener("fpsCompleted",function(e){e.detail.success&&r.renderPage()}),this.pageRegions=document.querySelectorAll("[data-componentregion]"),this.renderPage()},t.prototype.renderPage=function(){var e=this.pageContext.getService("IVssPerformanceService");e.addSplitTiming("VssPageRenderingService.renderPage.start");var t=this.pageContext.getService("IVssLayoutManager");t.setFullScreenMode(t.getFullScreenMode().value);for(var r=0;r<this.pageRegions.length;r++){var n=this.pageRegions[r].getAttribute("data-componentregion");n&&s.render(o.createElement(f,{key:this.reactRootKey++,pageContext:this.pageContext},o.createElement(m,{componentRegion:n,className:"full-size"},null)),this.pageRegions[r],function(){g.getCookie("TFS-BREAK-FIRST-RENDER")})}e.addSplitTiming("VssPageRenderingService.renderPage.end")},t}(h.VssService);h.Services.add("VssPageRenderingService",{serviceFactory:v,options:6});var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getChildContext=function(){return{pageContext:this.props.pageContext}},t.prototype.render=function(){return this.props.children},t}(i);f.childContextTypes=i.contextTypes,t[e].ReactRootComponent=f;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this,t=this.context.pageContext.getService("IVssLayoutManager").getComponentsForRegion(this.props.componentRegion)||[];return 0===t.length&&this.props.fallbackComponent?this.props.fallbackComponent():o.createElement("div",{className:n(this.props.className,"region-"+this.props.componentRegion),"data-renderedregion":this.props.componentRegion,role:this.props.role},t.map(function(t,r){return o.createElement(y,Object.assign({key:r},e.props.childComponentProperties,t.componentProperties,{wrappedType:t.componentType}))}))},t}(i);t[e].RegionComponent=m;var y=function(r){function n(n,i){var o=r.call(this,n,i)||this;if(o._subscribed=!1,o._dependenciesResolved=!1,o.onComponentAdded=function(r){r.key===o.props.wrappedType&&(o._componentClass=t[e].Components.get(o.props.wrappedType),o._updateLoadingState(),t[e].Components.unsubscribe(o.onComponentAdded,"add"),o._subscribed=!1)},o._componentClass=t[e].Components.get(o.props.wrappedType),n.dependencies&&n.dependencies.length>0){var s=i.pageContext.getService("IVssContributionService");o.trackPromise(s.getContributionsAsync(n.dependencies)).promise.then(function(){o._handleDependenciesResolved(),o._updateLoadingState()},function(e){e&&!e.isCanceled?console.warn(e):console.log("canceled request for "+o.props.wrappedType)})}else o._handleDependenciesResolved();return o.state={showLoadingComponent:!1},o}return __extends(n,r),n.prototype.render=function(){return this._componentClass&&this._dependenciesResolved?o.createElement(this._componentClass,Object.assign({ref:this.props.wrappedRef},this.props.wrappedProps||this.props),this.props.children):this.state.showLoadingComponent&&this.props.loadingComponent&&this.props.loadingComponent()||null},n.prototype.componentDidMount=function(){var e=this;r.prototype.componentDidMount.call(this),this._componentClass||this._resolveComponentClass(this.props.wrappedType),!this.props.loadingComponent||this._componentClass&&this._dependenciesResolved||(this._delayLoadingTimeout=this.setTimeout(function(){e._componentClass||e.setState({showLoadingComponent:!0})},100))},n.prototype.componentWillReceiveProps=function(e){r.prototype.componentWillReceiveProps.call(this,e),this.props.wrappedType!==e.wrappedType&&this._resolveComponentClass(e.wrappedType)},n.prototype.componentWillUnmount=function(){r.prototype.componentWillUnmount.call(this),this._subscribed&&t[e].Components.unsubscribe(this.onComponentAdded,"add")},n.prototype._handleDependenciesResolved=function(){var e=this,t=void 0;this.props.onDependenciesResolved&&(t=this.props.onDependenciesResolved()),t?this.trackPromise(t).promise.then(function(){e._dependenciesResolved=!0,e._updateLoadingState()},function(){}):this._dependenciesResolved=!0},n.prototype._updateLoadingState=function(){this._componentClass&&this._dependenciesResolved&&(this._delayLoadingTimeout&&(this.clearTimeout(this._delayLoadingTimeout),this._delayLoadingTimeout=0),this.setState({showLoadingComponent:!1}))},n.prototype._resolveComponentClass=function(r){this._componentClass=t[e].Components.get(r),this._componentClass||this._subscribed||(t[e].Components.subscribe(this.onComponentAdded,"add"),this._subscribed=!0)},n}(i);t[e].WrappedComponent=y}("Layout"),function(e){C=t.UtilUrl={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){e&&this._setFromUriString(e,t)}return e.prototype._setFromUriString=function(e,t){var r=e,n=this._singleSplit(r,"#");n?(r=n.part1,this.hashString=this._decodeUriComponent(n.part2)):this.hashString="";var i=this._singleSplit(r,"?");i?(r=i.part1,this.queryString=i.part2):this.queryParameters=[],this.scheme="",this.host="",this.port=0,this.path="",this.noSchemeSeparator=!1;var o=this._singleSplit(r,":");if(o)if(this.scheme=o.part1,"//"===(r=o.part2).substr(0,2)){r=r.substr(2);var s=this._singleSplit(r,"/");s?(r=s.part1,this.path=s.part2):this.path="";var a=this._singleSplit(r,":");a?(this.host=a.part1,this.port=parseInt(a.part2),isNaN(this.port)&&(this.host+=":",this.path=a.part2+"/"+this.path)):this.host=r}else this.noSchemeSeparator=!0,this.path=r;else this.path=r;if(t&&t.absoluteUriRequired&&!this.scheme)throw new Error('The uri string "'+e+'" does not represent a valid absolute uri.')},e.prototype._singleSplit=function(e,t){var r=e.indexOf(t);return r>=0?{part1:e.substr(0,r),part2:e.substr(r+1)}:void 0},e.prototype._decodeUriComponent=function(e){return e&&(e=e.replace(/\+/g,"%20"),e=decodeURIComponent(e)),e},Object.defineProperty(e.prototype,"absoluteUri",{get:function(){var e="";if(this.scheme&&(e=encodeURI(decodeURI(this.scheme))+":",this.noSchemeSeparator||(e+="//")),this.host&&(e+=encodeURI(decodeURI(this.host)),this.port&&(e+=":"+this.port),this.noSchemeSeparator&&!this.path||(e+="/")),this.path){var t=void 0;if(this.noSchemeSeparator)t=encodeURI(decodeURI(this.path));else t=this.path.split("/").map(function(e){return encodeURIComponent(decodeURIComponent(e))}).join("/");this.host?e=i(e,t):e+=t}var r=this.queryString;if(r&&(e+="?"+r),this.hashString){var n=this._splitStringIntoParams(this.hashString);e+="#"+this._getParamsAsString(n)}return e},set:function(e){this._setFromUriString(e||"")},enumerable:!0,configurable:!0}),e.prototype.getEffectivePort=function(){return this.port?this.port:n.equals(this.scheme,"http",!0)?80:n.equals(this.scheme,"https",!0)?443:0},e.prototype._getParamsAsString=function(e){return e&&e.length?e.map(function(e){return null!==e.value?encodeURIComponent(e.name)+"="+encodeURIComponent(e.value):encodeURIComponent(e.name)}).join("&"):""},Object.defineProperty(e.prototype,"queryString",{get:function(){return this._getParamsAsString(this.queryParameters)},set:function(e){this.queryParameters=this._splitStringIntoParams(e)},enumerable:!0,configurable:!0}),e.prototype._splitStringIntoParams=function(e){var t=this,r=[];return e.split("&").forEach(function(e){if(e){var n=t._singleSplit(e,"=");n?r.push({name:t._decodeUriComponent(n.part1),value:t._decodeUriComponent(n.part2)}):r.push({name:t._decodeUriComponent(e),value:null})}}),r},e.prototype.getQueryParam=function(e){var t;if(this.queryParameters){var r=this.queryParameters.filter(function(t){return n.equals(t.name,e,!0)});r.length>0&&(t=r[0].value)}return t},e.prototype.addQueryParam=function(e,t,r){r&&this.removeQueryParam(e),this.queryParameters||(this.queryParameters=[]),this.queryParameters.push({name:e,value:t})},e.prototype.addQueryParams=function(e,t){var r=this,n=function(n){var o=e[n];null!=o&&(o instanceof Date?i.addQueryParam(n,o.toJSON(),t):Array.isArray(o)?o.forEach(function(e){return r.addQueryParam(n,""+e,t)}):i.addQueryParam(n,""+o,t))},i=this;for(var o in e)n(o)},e.prototype.removeQueryParam=function(e){this.queryParameters&&(this.queryParameters=this.queryParameters.filter(function(t){return!n.equals(t.name,e,!0)}))},e}();function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=[],n=0,i=e.length-1;n<=i;n++){var o=e[n];o&&("/"!==o||0!==n&&n!==i?(n>0&&"/"===o[0]&&(o=o.substr(1)),n<i&&"/"===o[o.length-1]&&(o=o.substr(0,o.length-1)),o&&r.push(o)):r.push(""))}return 1===r.length&&""===r[0]?"/":r.join("/")}function o(e){for(var t={segments:[]},r=-1,n=-1,i="",o=0,s=e.length;o<s;o++){var a=e.charCodeAt(o);if(r>=0){if(125===a){var c=e.substring(r,o),u=!1;42===c.charCodeAt(0)&&(c=c.substr(1),u=!0),t.segments.push({paramName:c,isWildCardParam:u}),r=-1}}else if(123===a&&123!==e.charCodeAt(o+1)){if(i||n>=0){var p=i;n>=0&&(p+=e.substring(n,o)),p&&t.segments.push({text:p}),n=-1,i=""}r=o+1}else(123===a&&123===e.charCodeAt(o+1)||125===a&&125===e.charCodeAt(o+1))&&(i+=e.substring(n>=0?n:o,o+1),n=-1,o++),n<0&&(n=o)}(n>=0||r>=0)&&((p=i+e.substring(n>=0?n:r))&&t.segments.push({text:p}));for(var l=!1,d=t.segments.length-1;d>=0;d--){var h=t.segments[d];h.text&&"/"!==h.text?l=!0:l&&h.paramName&&(h.isRequiredParam=!0)}return t}function s(e,t){for(var r,n=Object.keys(t).length,i=0,o=e;i<o.length;i++){var s=a(o[i],t,!1);if(s&&(!r||s.matchedParametersCount>r.matchedParametersCount)&&(r=s,s.matchedParametersCount===n))return r}return r}function a(e,t,r){for(var n=[],i={},o=0,s=0,a=e.segments.length;s<a;s++){var c=e.segments[s];if(c.text){var u=c.text;r&&s>0&&"/"===u.charAt(0)&&0===n.length&&(u=u.substr(1)),u&&n.push(u)}else{var p=t[c.paramName];if(p||0===p)n.push(c.isWildCardParam?encodeURI(""+p):encodeURIComponent(""+p)),i[c.paramName]=!0,o++;else{if(!r){if(c.isRequiredParam)return;break}if(n.length){var l=n[n.length-1];"/"===l[l.length-1]&&(n[n.length-1]=l.substr(0,l.length-1))}}}}return{url:n.join(""),matchedParameters:i,matchedParametersCount:o}}t.UtilUrl.Uri=r,t.UtilUrl.combineUrlPaths=i,t.UtilUrl.parseRouteTemplate=o,t.UtilUrl.routeUrl=function(e,t){var n=s(e,t);if(!n)return"";var i=new r(n.url);for(var o in t)n.matchedParameters[o]||i.addQueryParam(o,t[o]);return i.absoluteUri},t.UtilUrl.getBestRouteMatch=s,t.UtilUrl.replaceParsedRouteValues=a,t.UtilUrl.replaceRouteValues=function(e,t){return a(o(e),t,!0).url}}(),function(e){t.Navigation={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t);var r=t.getService("IVssContributionService");this.navigationData=r.getData("ms.vss-web.navigation-data");var n=this.navigationData.resolvedUrl;if(n&&(window.location.hash&&(n+=window.location.hash),window.history.replaceState(history.state,document.title,n)),this.navigationData.navigation){if(this.navigationData.location)for(var i in this.navigationData.navigation){var o=this.navigationData.navigation[i];o.href=this.navigationData.location[o.id]}if(this.navigationData.hierarchy){var s=function(e){var t=a.navigationData.navigation[e],r=a.navigationData.hierarchy[e],n={},i=[];t.children=[];for(var o=0,s=r;o<s.length;o++){var c=s[o];2!=(2&((f=a.navigationData.navigation[c]).flags||0))&&(f.order=(f.order||0)+1e5),void 0!==f.flags&&32!=(32&f.flags)?(f.parentId=t.id,t.children.push(f)):f.href&&i.push(f)}t.children.sort(function(e,t){var r=e.order-t.order;return 0===r&&(r=e.id.toUpperCase().localeCompare(t.id.toUpperCase())),r});for(var u=1,p=0,l=t.children;p<l.length;p++){var d=(f=l[p]).navGroup||"";n[d]||(n[d]=u++)}if(t.children.sort(function(e,t){var r=n[e.navGroup||""]-n[t.navGroup||""];return 0===r&&0===(r=e.order-t.order)&&(r=e.id.localeCompare(t.id)),r}),!t.href){for(var h=0,v=t.children;h<v.length;h++){var f;if((f=v[h]).href){t.href=f.href;break}}!t.href&&i.length>0&&(i.sort(function(e,t){return e.order-t.order}),t.href=i[0].href)}},a=this;for(var c in this.navigationData.hierarchy)s(c);if(this.matchedRoute={routeId:this.navigationData.routeId,parsedRoutes:[],routeTemplates:this.navigationData.routeTemplates,routeValues:this.navigationData.routeValues},this.navigationData.routeTemplates)for(var u=0,p=this.navigationData.routeTemplates;u<p.length;u++){var l=p[u];this.matchedRoute.parsedRoutes.push(C.parseRouteTemplate(l))}}}},t.prototype.getCurrentRoute=function(){return this.matchedRoute},t.prototype.getDisplayedNavigation=function(){return this.navigationData.displayed},t.prototype.getNavigation=function(e){return this.navigationData.navigation[e]},t.prototype.getRouteValues=function(){return this.navigationData.routeValues},t.prototype.isDisplayed=function(e){return-1!=this.navigationData.displayed.indexOf(e)},t.prototype.getPageTitle=function(){return this.navigationData.pageTitle},t}(h.VssService);h.Services.add("IVssNavigationService",{serviceFactory:r}),t.Navigation.getCurrentRoute=function(e){return e.getService("IVssNavigationService").getCurrentRoute()},t.Navigation.getDisplayedNavigation=function(e){return e.getService("IVssNavigationService").getDisplayedNavigation()},t.Navigation.getNavigation=function(e,t){return e.getService("IVssNavigationService").getNavigation(t)},t.Navigation.getRouteValues=function(e){return e.getService("IVssNavigationService").getRouteValues()},t.Navigation.isDisplayed=function(e,t){return e.getService("IVssNavigationService").isDisplayed(t)}}(),function(e){t.Trace={},Object.defineProperty(t,"__esModule",{value:!0}),t.Trace.traceError=function(e,t,r,n,i){e.getService("IVssTraceService").traceError(t,r,n,i)},t.Trace.traceException=function(e,t,r,n,i){e.getService("IVssTraceService").traceException(t,r,n,i)},t.Trace.traceWarning=function(e,t,r,n,i){e.getService("IVssTraceService").traceWarning(t,r,n,i)},t.Trace.trace=function(e,t){e.getService("IVssTraceService").trace(t)};var r=5,n=function(e){function t(){var t=e.apply(this,arguments)||this;return t.events=[],t.globalErrorCount=0,t._onWindowError=function(e){if(e.filename&&t.globalErrorCount++<r){var n={filename:e.filename,lineNumber:e.lineno,columnNumber:e.colno,errorType:"UnhandledException"},i=t.pageContext.getService("IVssNavigationService").getCurrentRoute().routeId;t.traceException("WebUnhandledExceptions",i,e.error,n)}},t._onUnhandledRejection=function(e){var n=e.reason;if(n&&!n.isCanceled&&(console.warn("Unhandled promise rejection: "+n),t.globalErrorCount++<r)){var i=t.pageContext.getService("IVssNavigationService").getCurrentRoute().routeId;t.traceException("WebUnhandledExceptions",i,n,{errorType:"UnhandledRejection"})}},t}return __extends(t,e),t.prototype._serviceStart=function(t){if(e.prototype._serviceStart.call(this,t),onPreTraceServiceError&&window.removeEventListener("error",onPreTraceServiceError),preTraceServiceStartErrors&&preTraceServiceStartErrors.length>0){for(var r=0,n=preTraceServiceStartErrors;r<n.length;r++){var i=n[r];this._onWindowError(i)}preTraceServiceStartErrors.length=0}this.publishInterval=window.setInterval(this._sendEvents.bind(this),1e3),window.addEventListener("error",this._onWindowError),window.addEventListener("unhandledrejection",this._onUnhandledRejection)},t.prototype._serviceRestart=function(t){e.prototype._serviceRestart.call(this,t),this.globalErrorCount=0,this._sendEvents()},t.prototype._serviceEnd=function(t){this.publishInterval&&(window.clearInterval(this.publishInterval),this.publishInterval=0),window.removeEventListener("error",this._onWindowError),window.removeEventListener("unhandledrejection",this._onUnhandledRejection),e.prototype._serviceEnd.call(this,t)},t.prototype._sendEvents=function(){if(this.events.length>0){var e=this.events;this.events=[],this.pageContext.getRestClient("IClientTraceRestClient").publishEvents(e)}},t.prototype.traceError=function(e,t,r,n){var i={area:e,feature:t,message:r,properties:n,level:1};this.trace(i)},t.prototype.traceException=function(e,t,r,n){var i={area:e,feature:t,message:r?r.message:r||"unknown",exceptionType:"",properties:n,level:2};r&&(i.properties||(i.properties={}),i.properties.stackTrace=r.stack,i.exceptionType=r.name),this.trace(i)},t.prototype.traceWarning=function(e,t,r,n){var i={area:e,feature:t,message:r,properties:n,level:2};this.trace(i)},t.prototype.trace=function(e){this.events.push(e)},t}(h.VssService);h.Services.add("IVssTraceService",{serviceFactory:n,options:6})}(),function(e){w=t.ComponentsErrorBoundaryErrorBoundary={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){var r=e.call(this,t)||this;return r.state={},r}return __extends(t,e),t.prototype.componentDidCatch=function(e,t){if(this.setState({error:e,errorInfo:t}),e){var r=this.context.pageContext.getService("IVssNavigationService").getCurrentRoute().routeId,n={};t&&t.componentStack&&(n.componentStack=t.componentStack),this.context.pageContext.getService("IVssTraceService").traceException("WebUnhandledExceptions",r,e,n)}},t.prototype.render=function(){var e=this;if(this.state.error){var t=this.props.handlerComponentProps||{},r=Object.assign({},t,{reloadComponent:function(){e.setState({error:void 0,errorInfo:void 0})},error:this.state.error,errorInfo:this.state.errorInfo});return o.createElement(_.WrappedComponent,{wrappedType:this.props.handlerComponentType,wrappedProps:r,key:"error-boundary-ui"},[])}return this.props.children},t}(_.VssComponent);t.ComponentsErrorBoundaryErrorBoundary.ErrorBoundary=r}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(r){for(var n in r)t[e].hasOwnProperty(n)||(t[e][n]=r[n])}(w)}("ComponentsErrorBoundary"),I=t.ComponentsFormatFormat={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsFormatFormat.FormatComponent=function(e){var t=void 0,r=e.format,n=e.elementType,i=e.children,s=__rest(e,["format","elementType","children"]);if(r){var a=r.split(/(?:\{)([0-9]+)(?:\})/),c=o.Children.toArray(i);t=[];for(var u={},p=0;p<a.length;++p){var l=a[p];if(1&p){var d=parseInt(l,10);if(u[d])throw new Error("Index in the format can only be used once, recurring index is "+d);var h=c[d];if(!h)throw new Error("No element found for the specified index "+d);t.push(h),u[d]=!0}else t.push(l)}}return o.createElement(n||"span",s,t||i)},function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(r){for(var n in r)t[e].hasOwnProperty(n)||(t[e][n]=r[n])}(I)}("ComponentsFormat"),function(e){P=t.ComponentsLayoutLayout={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return o.createElement(this.props.elementType||"div",{"aria-label":this.props["aria-label"],className:_.css(this.props.orientation&&"column"===this.props.orientation?"flex-column":"flex-row",this.props.className)},this.props.components.map(function(e,t){var r;return e.componentType?r=o.createElement(_.WrappedComponent,Object.assign({key:t,hasBoundary:!!e.errorBoundaryProps},e.componentProperties,{wrappedType:e.componentType})):e.componentRegion&&(r=o.createElement(_.RegionComponent,Object.assign({key:t,hasBoundary:!!e.errorBoundaryProps},e.componentProperties,{componentRegion:e.componentRegion}))),e.errorBoundaryProps?o.createElement(w.ErrorBoundary,Object.assign({key:t},e.errorBoundaryProps),r):r}))},t}(_.VssComponent);r.componentType="layout",t.ComponentsLayoutLayout.LayoutComponent=r,_.VssComponent.register(r.componentType,r);var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return o.createElement("div",{className:_.css("flex-grow",this.props.className)})},t}(_.VssComponent);n.componentType="layoutFiller",t.ComponentsLayoutLayout.LayoutFillerComponent=n,_.VssComponent.register(n.componentType,n);var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return o.createElement(this.props.elementType||"div",{className:this.props.className},this.props.text)},t}(_.VssComponent);i.componentType="htmlElement",t.ComponentsLayoutLayout.HtmlElementComponent=i,_.VssComponent.register(i.componentType,i);var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return null},t}(o.Component);s.componentType="NoOp",t.ComponentsLayoutLayout.NoOpComponent=s,_.VssComponent.register(s.componentType,s)}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(r){for(var n in r)t[e].hasOwnProperty(n)||(t[e][n]=r[n])}(P)}("ComponentsLayout"),function(e){var r;T=t.History={},Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.statePopped="statePopped"}(r=t.History.HistoryServiceEventNames||(t.History.HistoryServiceEventNames={}));var n=function(e){function t(){var t=e.apply(this,arguments)||this;return t.onbeginDataProviderQuery=function(e){e.properties.sourcePage={url:window.location.href,routeId:t._currentRoute.routeId,routeValues:t.getCurrentRouteValues()}},t._onPopState=function(e){var n,i=e.state;i&&i.vssNavigationState&&(n=i.vssNavigationState);var o=t._currentState;t._currentState=n;var s={oldState:o,newState:n};t._notify(s,r.statePopped)},t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t),this._initialize(),window.addEventListener("popstate",this._onPopState),this.replaceState(void 0,void 0)},t.prototype._serviceRestart=function(t){e.prototype._serviceRestart.call(this,t),this._initialize()},t.prototype._initialize=function(){var e=this,t=this.pageContext.getService("IVssPageService");this._pageData=t.getData();var r=this.pageContext.getService("IVssNavigationService");this._currentRoute=r.getCurrentRoute(),this._unsubscribeOnRestart&&this._unsubscribeOnRestart();var n=this.pageContext.getService("IVssContributionService");n.subscribe(this.onbeginDataProviderQuery,"dpqStarting"),this._unsubscribeOnRestart=function(){n.unsubscribe(e.onbeginDataProviderQuery,"dpqStarting")}},t.prototype.replaceState=function(e,t,r,n){this._setState(!0,e,t,r,n)},t.prototype.pushState=function(e,t,r,n){this._setState(!1,e,t,r,n)},t.prototype.getData=function(){return this._currentState&&this._currentState.data},t.prototype.getState=function(){return this._currentState&&this._currentState.state?Object.assign({},this._currentState.state):this._getStateFromUrl(window.location.href)},t.prototype._setState=function(e,t,r,n,i){r&&!t?t=this._getStateFromUrl(r):t&&!r?r=this.generateUrl(t,0):r||t||(r=window.location.href,(t=this._currentState&&this._currentState.state)||(t=this._getStateFromUrl(r))),null==n&&(n=this._currentRoute.routeId);var o=window.history.state,s={};e&&o&&o.vssNavigationState&&(s=o.vssNavigationState.data),i&&(s=Object.assign({},s,i));var a={state:t,routeId:n,data:s,url:r},c=e?Object.assign({},o,{vssNavigationState:a}):{vssNavigationState:a};this._currentState=a,e||window.location.href===r?window.history.replaceState(c,void 0,r):window.history.pushState(c,void 0,r)},t.prototype.generateUrl=function(e,t){void 0===t&&(t=2);var r,n=this._currentRoute.routeValues;switch(t){case 2:r=Object.assign({},this.getState(),e);break;case 1:r=Object.assign({},this.getCurrentRouteValues(),e);break;default:r=e}var i=C.getBestRouteMatch(this._currentRoute.parsedRoutes,r),o="";i&&(o=i.url);var s=new C.Uri(C.combineUrlPaths(this._pageData.hostPath,o));if(i)for(var a in r)if(!i.matchedParameters[a]){var c=r[a];null!=c&&n[a]!==c&&s.addQueryParam(a,c)}return s.absoluteUri},t.prototype.getCurrentRouteValues=function(){var e=this._currentRoute.routeValues,t={},r=this.getState();for(var n in e)t[n]=r[n];return t},t.prototype._getStateFromUrl=function(e){var t=Object.assign({},this._currentRoute.routeValues);if(e)for(var r=0,n=new C.Uri(e).queryParameters;r<n.length;r++){var i=n[r];t[i.name]=i.value||""}return t},t}(h.VssObservableService);h.Services.add("IVssHistoryService",{serviceFactory:n,options:2})}(),function(e){E=t.FPS={},Object.defineProperty(t,"__esModule",{value:!0});var r,n="navigation/fpsCIEvent",i=0;function o(e,t,r){void 0===r&&(r={});var n=e.getService("IVssNavigationService"),i=e.getService("IVssPageService").getData(),o=n.getDisplayedNavigation();return Object.assign({},r,{source:t||"unknown",sourceNavigationId:o[o.length-1],sourceRouteId:n.getCurrentRoute().routeId,startNavigationOffset:Date.now()-window.performance.timing.navigationStart,serviceVersion:i?i.serviceVersion:void 0})}function s(e,t){t.endNavigationOffset=Date.now()-window.performance.timing.navigationStart,e.getService("IVssTelemetryService").publishEvent("WebPlatform","FPS",t)}function a(e,t,a,c){void 0===c&&(c={});var u=++i,p={pageContext:e,href:t,recordHistoryEntry:a,data:c};r&&(r.cancel(),r=null);var d=o(e,c.telemetrySource,c.telemetryProperties),h=new CustomEvent("fpsStarting",{cancelable:!0,detail:Object.assign({},p)});if(document.body.dispatchEvent(h)){var v=new C.Uri(t);v.addQueryParam("__rt","fps");var g=e.getService("IVssPageService").getData();g&&v.addQueryParam("__ver",""+g.webPlatformVersion),document.body.dispatchEvent(new CustomEvent("fpsLoading",{cancelable:!1,detail:Object.assign({},p)})),e.getService("IVssPerformanceService").addSplitTiming("fpsRequestStarting");var y=l.makeCancelable(m.issueRequest(v.absoluteUri,{cache:"no-cache",method:"GET",mode:"same-origin"})),S=y.promise.then(function(i){return r===y&&(r=null),i.text().then(function(r){e.getService("IVssPerformanceService").addSplitTiming("fpsResponseReceived");var i=null;try{i=f.deserializeVssJsonObject(r)}catch(e){return console.log("Not a valid FPS response: "+(e.message||e)+". Performing full page navigation"),d.invalidFPSResponse=!0,b.trySetLocalStorageObject(n,d),window.location.href=t,!0}var o=i&&i.fps;if(o&&(o.dataProviders&&f.updateJsonScriptValue("dataProviders",o.dataProviders,!0),o.performance&&f.updateJsonScriptValue("serverStatistics",o.performance),o.content)){if(e.getService("IFastPageSwitchService").hasStaleContent(o.content))return d.staleContent=!0,s(e,d),window.location.href=t,!0;e.getService("IVssContentService").loadScripts(o.content)}var c=e.getService("IVssHistoryService");a?c.pushState(void 0,t,void 0,{fpsNavigationId:u}):c.replaceState(void 0,t,void 0,{fpsNavigationId:u}),document.body.dispatchEvent(new CustomEvent("fpsLoaded",{cancelable:!1,detail:Object.assign({fpsResponse:i},p)})),c.replaceState(void 0,window.location.href),document.body.dispatchEvent(new CustomEvent("fpsCompleted",{cancelable:!1,detail:Object.assign({fpsResponse:i,success:!0},p)}));var l=e.getService("IVssNavigationService"),h=l.getDisplayedNavigation();return d.targetNavigationId=h[h.length-1],d.targetRouteId=l.getCurrentRoute().routeId,d.success=!0,s(e,d),!0})}).catch(function(i){return r!==y||i.isCanceled?(d.cancelledByOtherFPS=!0,s(e,d)):(d.failed=!0,b.trySetLocalStorageObject(n,d),window.location.href=t),r===y&&(r=null),document.body.dispatchEvent(new CustomEvent("fpsCompleted",{cancelable:!1,detail:Object.assign({success:!1,reason:i},p)})),!1});return r=y,S}return d.cancelledByUser=!0,h.detail.cancellationReason&&(d.cancellationReason=h.detail.cancellationReason),s(e,d),Promise.resolve(!1)}t.FPS.onClickFPS=function(e,t,r,n,i){if(void 0===i&&(i={}),!n||!(n.ctrlKey||n.metaKey||n.shiftKey||1===n.button))return a(e,t,r,i),n&&n.preventDefault(),!0;var c=o(e,i.telemetrySource,i.telemetryProperties);c.external=!0,c.ctrlKey=!0===(n&&n.ctrlKey),c.metaKey=!0===(n&&n.metaKey),c.shiftKey=!0===(n&&n.shiftKey),c.middleClick=1===(n&&n.button),s(e,c)},t.FPS.FastPageSwitch=a;var c=function(e){function t(){var t=e.apply(this,arguments)||this;return t.loadedContentIntegrity={},t.loadedContentFilenames={},t._onNavigate=function(e){e.newState&&((e.oldState&&e.oldState.data&&e.oldState.data.fpsNavigationId)!==(e.newState.data&&e.newState.data.fpsNavigationId)&&a(t.pageContext,e.newState.url,!1,{}))},t._onContentLoaded=function(e){var r=e.contentAttributes;r&&r.clientId&&(r.integrity&&(t.loadedContentIntegrity[r.clientId]=r.integrity),t.loadedContentFilenames[r.clientId]=t.getFileName(r.url))},t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t);try{var r=b.tryGetLocalStorageObject(n);if(b.trySetLocalStorageObject(n,void 0),r){var i=t.getService("IVssNavigationService"),o=i.getDisplayedNavigation();r.targetNavigationId=o[o.length-1],r.targetRouteId=i.getCurrentRoute().routeId,s(t,r)}}catch(e){}t.getService("IVssHistoryService").subscribe(this._onNavigate,T.HistoryServiceEventNames.statePopped);var a=t.getService("IVssPageService").getData();a&&a.isBundlingEnabled&&(this.bundlingEnabled=!0,t.getService("IVssContentService").subscribe(this._onContentLoaded,"contentComplete"))},t.prototype.hasStaleContent=function(e){var t=!1;if(this.bundlingEnabled)for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.clientId){if(i.integrity){var o=this.loadedContentIntegrity[i.clientId];if(o&&o!==i.integrity){t=!0;break}}var s=this.loadedContentFilenames[i.clientId];if(s&&s!==this.getFileName(i.url)){t=!0;break}}}return t},t.prototype.getFileName=function(e){var t=e.lastIndexOf("/");return t>=0?e.substr(t+1):e},t}(h.VssService);h.Services.add("IFastPageSwitchService",{serviceFactory:c,options:6})}(),function(e){R=t.ComponentsFPSLinkFPSLink={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this,t=Object.assign({},this.props,{onClick:function(t){if(!t.isDefaultPrevented())if(e.props.href&&!1!==e.props.supportsFPS)E.onClickFPS(e.context.pageContext,e.props.href,!0,t,{telemetrySource:e.props.telemetrySource,telemetryProperties:e.props.telemetryProperties,navigationId:e.props.navigationId});else if(e.props.telemetrySource){e.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","Link",Object.assign({},e.props.telemetryProperties||{},{source:e.props.telemetrySource}))}}});return delete t.navigationId,delete t.supportsFPS,delete t.telemetrySource,delete t.telemetryProperties,o.createElement("a",t,this.props.children)},t}(_.VssComponent);t.ComponentsFPSLinkFPSLink.FPSLinkComponent=r}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(r){for(var n in r)t[e].hasOwnProperty(n)||(t[e][n]=r[n])}(R)}("ComponentsFPSLink"),function(e){t.Fallback={},Object.defineProperty(t,"__esModule",{value:!0});var r="cdn.fallback.service",n=function(e){function t(){var t=e.apply(this,arguments)||this;return t.secureFlag="",t.contentLoadError=function(e){document.cookie="TFS-CDN=disabled;max-age=28800;path=/"+t.secureFlag,document.cookie="TFS-CDNTRACE=report-true;path=/"+t.secureFlag,E.onClickFPS(t.pageContext,window.location.href,!1,void 0,{telemetrySource:r,telemetryProperties:{failingContent:e},customUnloadMessage:d.CdnFallbackErrorMessage})},t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t);var r=this.pageContext.getService("IVssPageService").getData();r&&r.isCdnEnabled&&(r.isSslOnly&&(this.secureFlag=";secure"),this.pageContext.getService("IVssContentService").subscribe(this.contentLoadError,"contentLoadError"))},t}(h.VssService);h.Services.add("IVssFallbacksService",{serviceFactory:n,options:6})}(),function(e){D=t.Feature={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.isFeatureEnabled=function(e,t){var r=this.getSharedDataState("_features",e,t);if(void 0===r)throw new Error("Could not find feature state for feature '"+e+"'. Ensure that the feature is added using IClientFeatureProviderService.AddFeatureState.");return r},t.prototype.isFeatureFlagEnabled=function(e,t){var r=this.getSharedDataState("_featureFlags",e,t);if(void 0===r)throw new Error("Could not find feature flag state for '"+e+"'. Ensure that the feature flag is added using IClientFeatureProviderService.AddFeatureFlagState.");return r},t.prototype.getSharedDataState=function(e,t,r){var n=this.pageContext.getService("IVssContributionService").getSharedData(e);if(n){var i=n[t];if(void 0!==i)return i}return r},t}(h.VssService);h.Services.add("IVssFeatureService",{serviceFactory:r}),t.Feature.isFeatureEnabled=function(e,t,r){return e.getService("IVssFeatureService").isFeatureEnabled(t,r)},t.Feature.isFeatureFlagEnabled=function(e,t,r){return e.getService("IVssFeatureService").isFeatureFlagEnabled(t,r)}}(),function(e){t.Identity={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=e.apply(this,arguments)||this;return t.cachedIdentityDetails={},t}return __extends(t,e),t.prototype.getSharedIdentityDetails=function(e){var t=this.pageContext.getService("IVssContributionService").getSharedData("_identityDetails");return t?t[e]:void 0},t.prototype.getIdentityDetails=function(e){var t=this.cachedIdentityDetails[e];if(!t){var r=this.getSharedIdentityDetails(e);r&&(t={id:e,displayName:r.displayName,imageId:r.identityImageId,imageUrl:this.getIdentityImageUrl(e)},this.cachedIdentityDetails[e]=t)}if(!t)throw new Error("Missing shared identity details for identity with id "+e+".");return t},t.prototype.getIdentityImageUrl=function(e,t){return void 0===t&&(t=0),"string"==typeof e?this._getIdentityImageUrlFromIdentityId(e,t):this._getIdentityImageUrlFromIdentityRef(e,t)},t.prototype._getIdentityImageUrlFromIdentityId=function(e,t){var r,n=this.getSharedIdentityDetails(e);n&&(r=n.identityImageId||"0");var i="_api/_common/identityImage?id="+e+"&size="+t;r&&(i+="&t="+r);var o=this.pageContext.getService("IVssPageService").getData();return o&&o.hostPath&&(i=C.combineUrlPaths(encodeURI(o.hostPath),i)),i},t.prototype._getIdentityImageUrlFromIdentityRef=function(e,t){var r=!D.isFeatureFlagEnabled(this.pageContext,"VisualStudio.Services.WebPlatform.DisableNewAvatarImage");if(e._links&&e._links.avatar&&e._links.avatar.href&&r){var n=new C.Uri(e._links.avatar.href);return n.addQueryParam("size",""+t,!0),n.absoluteUri}return e.descriptor&&r?this._getIdentityAvatarUrl(e.descriptor):e.imageUrl||this._getIdentityImageUrlFromIdentityId(e.id,t)},t.prototype._getIdentityAvatarUrl=function(e){var t="_apis/GraphProfile/MemberAvatars/"+e,r=this.pageContext.getService("IVssPageService").getData();return r&&r.hostPath&&(t=C.combineUrlPaths(encodeURI(r.hostPath),t)),t},t}(h.VssService);h.Services.add("IVssIdentityService",{serviceFactory:r}),t.Identity.getIdentityImageUrl=function(e,t,r){return e.getService("IVssIdentityService").getIdentityImageUrl(t,r)}}(),function(e){t.KeyboardShortcuts={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=e.apply(this,arguments)||this;return t._originalStopCallback=window.Mousetrap.prototype.stopCallback,t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t);var r=this;window.Mousetrap.prototype.stopCallback=function(e,t,n,i){return!r._globalCombos[n]&&!r._globalCombos[i]&&("true"===t.getAttribute("data-onlyglobalshortcuts")||r._originalStopCallback.call(this,e,t,n))},this.initializeService()},t.prototype._serviceRestart=function(t){e.prototype._serviceRestart.call(this,t),this.initializeService()},t.prototype.initializeService=function(){this.reset();var e=this.pageContext.getService("IVssContributionService"),t=e.getContributionsByType("ms.vss-web.shortcut"),r=function(r){var i=t[r];n.registerShortcut(i.group,{combos:i.combos,description:i.description,isPageNavigationShortcut:i.isPageNavigationShortcut,action:function(){i.command?e.executeCommandEx(r,i.command):i.commandId&&e.executeCommand(i.commandId)}})},n=this;for(var i in t)r(i)},t.prototype.reset=function(){window.Mousetrap.reset(),this._globalCombos={},this._registeredCombos={},this._shortcutsGroups={}},t.prototype.getShortcutGroups=function(){var e=this;return Object.keys(this._shortcutsGroups).map(function(t){return e._shortcutsGroups[t]})},t.prototype.getGlobalCombos=function(){return Object.keys(this._globalCombos)},t.prototype.registerShortcut=function(e,t){var r=this;this._shortcutsGroups[e]||(this._shortcutsGroups[e]={name:e,shortcuts:[]});var n,i=function(n,i){return function(t){r.pageContext.getService("IVssTelemetryService").publishEvent("KeyboardShortcuts","ShortcutInvoked",{group:e,shortcut:t})}(i),t.isPageNavigationShortcut&&r.reset(),t.action(n,i),t.allowPropagation||!1};t.element?(n=window.Mousetrap(t.element)).bind(t.combos,i):window.Mousetrap.bind(t.combos,i);for(var o=t.globalCombos||[],s=0,a=t.combos;s<a.length;s++){var c=a[s];o.indexOf(c)>=0&&(this._globalCombos[c]=!0)}for(var u=[],p=0,l=t.combos;p<l.length;p++){var d=l[p];this._registeredCombos[d]||(u.push(d),this._registeredCombos[d]=!0)}var h=Object.assign({},t,{combos:t.combos,combosToDisplay:t.hideFromHelpDialog?[]:u,mousetrapInstance:n});this._shortcutsGroups[e].shortcuts.push(h)},t.prototype.unRegisterShortcut=function(e,t){if(this._registeredCombos[t]&&delete this._registeredCombos[t],this._shortcutsGroups[e]){for(var r=this._shortcutsGroups[e].shortcuts,n=0,i=!1;n<r.length;n++){var o=r[n];if(o.combos.indexOf(t)>=0){o.mousetrapInstance?o.mousetrapInstance.unbind(t):window.Mousetrap.unbind(t),1===o.combos.length&&(i=!0),delete this._globalCombos[t];break}}i&&(r.splice(n,1),0===r.length&&this.removeShortcutGroup(e))}},t.prototype.removeShortcutGroup=function(e){var t=this;if(this._shortcutsGroups[e]){var r=this._shortcutsGroups[e].shortcuts;delete this._shortcutsGroups[e],r.forEach(function(e){e.mousetrapInstance?e.mousetrapInstance.unbind(e.combos):window.Mousetrap.unbind(e.combos);for(var r=0,n=e.combos;r<n.length;r++){var i=n[r];delete t._registeredCombos[i],delete t._globalCombos[i]}})}},t}(h.VssService);h.Services.add("IVssKeyboardShortcutService",{serviceFactory:r,options:6})}(),function(e){x=t.Location={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=e.apply(this,arguments)||this;return t._parsedRoutes={},t}return __extends(t,e),t.prototype.getAssetLocation=function(e){var t=this.pageContext.getService("IVssContributionService").getSharedData("_assets");if(t)return t[e];throw new Error("Could not find asset for service "+e+". Ensure that the asset is added through a shared data value.")},t.prototype.getServiceInstanceTypeForResourceArea=function(e){var t=this.pageContext.getService("IVssContributionService").getSharedData("_resourceAreas");if(t)return t[e]},t.prototype.getServiceLocation=function(e,t){var r=this.getServiceLocationLocal(e,t);if(!r)throw new Error("Could not find location for service "+e+" and hostType "+t+". Ensure that the requested service location is added using IClientLocationProviderService.AddLocation.");return r},t.prototype.getServiceLocationAsync=function(e,t){var r=this,n=this.getServiceLocationLocal(e,t);if(n)return Promise.resolve(n);var i=this.pageContext.getService("IVssPageService").getData(),o=this.pageContext.getService("IVssContributionService"),s={_sharedData:{locations:[{ServiceInstanceId:e&&i.isHosted?e:i.serviceInstanceType,HostType:t||i.hostType}]}};return o.getDataAsync("ms.vss-web.shared-data",s).then(function(){return r.getServiceLocation(e,t)})},t.prototype.getServiceLocationLocal=function(e,t){var r=this.pageContext.getService("IVssPageService").getData();t||(t=r.hostType),e&&r.isHosted||(e=r.serviceInstanceType);var n=this.pageContext.getService("IVssContributionService").getSharedData("_locations");if(n){var i=n[e];if(i){var o=i[t];if(o)return o}}},t.prototype.routeUrl=function(e,t,r){var n=this._parsedRoutes[e];if(!n){var i=this.pageContext.getService("IVssContributionService").getSharedData("_routes");if(i){var o=i[e];o&&(n=[],o.forEach(function(e){n.push(C.parseRouteTemplate(e))}),this._parsedRoutes[e]=n)}}if(n){var s=C.routeUrl(n,t||{});if(!r){var a=this.pageContext.getService("IVssPageService").getData();a&&a.hostPath&&(r=a.hostPath)}if(r){var c=encodeURI(r);return C.combineUrlPaths(c,s)}}throw new Error("Could not find route for route id "+e+". Ensure that the requested route is added to routes shared data.")},t}(h.VssService);h.Services.add("IVssLocationService",{serviceFactory:r}),t.Location.getAssetLocation=function(e,t){return e.getService("IVssLocationService").getAssetLocation(t)},t.Location.getServiceLocation=function(e,t,r){return e.getService("IVssLocationService").getServiceLocation(t,r)},t.Location.routeUrl=function(e,t,r,n){return e.getService("IVssLocationService").routeUrl(t,r,n)}}(),function(e){O=t.RestClientBase={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._options=e||{},"string"==typeof this._options.rootPath?this._rootPath=Promise.resolve(this._options.rootPath):this._rootPath=this._options.rootPath||Promise.resolve("/")}return e.prototype.getRootPath=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,this._rootPath]})})},e.prototype.beginRequest=function(e){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(r){return[2,this._rootPath.then(function(r){var n=r+C.replaceRouteValues(e.routeTemplate,e.routeValues||{});if(e.queryParams){var i=new C.Uri(n);i.addQueryParams(e.queryParams),n=i.absoluteUri}return t._issueRequest(n,e.apiVersion,e)})]})})},e.prototype._issueRequest=function(e,t,r){var n={};n.method=r.method||"GET",n.mode="cors",!r.isRawData&&r.body&&"GET"!==n.method.toUpperCase()?n.body=JSON.stringify(r.body):n.body=r.body;var i=r.httpResponseType||"application/json",o=i+";api-version="+t+";excludeUrls=true;enumsAsNumbers=true;msDateFormat=true;noArrayWrap=true";n.headers=Object.assign({Accept:o},r.body&&{"Content-Type":"application/json"},r.customHeaders);var s={authTokenProvider:this._options.authTokenProvider,sessionId:this._options.sessionId,command:r.command||this._options.command};return m.issueRequest(e,n,s).then(function(e){return r.returnRawResponse?e:i.toLowerCase().indexOf("json")>=0?e.text().then(f.deserializeVssJsonObject):"text/plain"===i.toLowerCase()?e.text():e.arrayBuffer()})},e}();t.RestClientBase.RestClientBase=r}(),function(e){t.RestClientAuthenticationImpl={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.createSessionToken=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/WebPlatformAuth/SessionToken",body:e})]})})},t}(O.RestClientBase);h.RestClients.add("IAuthenticationRestClient",{factory:r})}(),function(e){t.RestClientClientTraceImpl={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.publishEvents=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"POST",routeTemplate:"_apis/ClientTrace/Events",body:e})]})})},t}(O.RestClientBase);h.RestClients.add("IClientTraceRestClient",{factory:r})}(),function(e){t.RestClientContributionsImpl={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.queryContributionNodes=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/Contribution/nodes/query",body:e})]})})},t.prototype.queryDataProviders=function(e,t,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return[2,this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/Contribution/dataProviders/query/{scopeName}/{scopeValue}",routeValues:{scopeName:t,scopeValue:r},body:e})]})})},t}(O.RestClientBase);h.RestClients.add("IContributionsRestClient",{factory:r})}(),function(e){t.RestClientCustomerIntelligenceImpl={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.publishEvents=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/customerintelligence/Events",body:e})]})})},t}(O.RestClientBase);h.RestClients.add("ICustomerIntelligenceRestClient",{factory:r})}(),function(e){t.RestClientLocationsImpl={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getConnectionData=function(e,t,r){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(i){return n={connectOptions:e,lastChangeId:t,lastChangeId64:r},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ConnectionData",queryParams:n})]})})},t.prototype.getResourceArea=function(e,t,r){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(i){return n={enterpriseName:t,organizationName:r},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",routeValues:{areaId:e},queryParams:n})]})})},t.prototype.getResourceAreaByHost=function(e,t){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(n){return r={hostId:t},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",routeValues:{areaId:e},queryParams:r})]})})},t.prototype.getResourceAreas=function(e,t){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(n){return r={enterpriseName:e,organizationName:t},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",queryParams:r})]})})},t.prototype.getResourceAreasByHost=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(r){return t={hostId:e},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",queryParams:t})]})})},t.prototype.deleteServiceDefinition=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"4.0-preview.1",method:"DELETE",routeTemplate:"_apis/ServiceDefinitions/{serviceType}/{identifier}",routeValues:{serviceType:e,identifier:t}})]})})},t.prototype.getServiceDefinition=function(e,t,r,n){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(o){return i={allowFaultIn:r,previewFaultIn:n},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ServiceDefinitions/{serviceType}/{identifier}",routeValues:{serviceType:e,identifier:t},queryParams:i})]})})},t.prototype.getServiceDefinitions=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ServiceDefinitions/{serviceType}/{identifier}",routeValues:{serviceType:e}})]})})},t.prototype.updateServiceDefinitions=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"4.0-preview.1",method:"PATCH",routeTemplate:"_apis/ServiceDefinitions/{serviceType}/{identifier}",body:e})]})})},t}(O.RestClientBase);h.RestClients.add("ILocationsRestClient",{factory:r})}(),function(e){V=t.UserClaims={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.hasClaim=function(e){if(!this.claims){var t=this.pageContext.getService("IVssContributionService");this.claims=t.getData("ms.vss-web.user-claims-data")||this.getDefaultClaims()}return e=(e||"").toLowerCase(),!0===this.claims[e]},t.prototype.getDefaultClaims=function(){var e={member:!0};return e},t}(h.VssService);h.Services.add("IVssUserClaimsService",{serviceFactory:r}),t.UserClaims.userHasClaim=function(e,t){return e.getService("IVssUserClaimsService").hasClaim(t)}}(),function(e){t.RestClientOptionsProvider={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.populateRestClientOptions=function(e,t){var r=Object.assign({},t),n=this.pageContext.getService("IVssPageService").getData();if(n&&(r.sessionId||(r.sessionId=n.sessionId),!r.rootPath)){var i=r.hostType,o=r.serviceInstanceType;if(!o&&e){if(e.resourceAreaId)o=this.pageContext.getService("IVssLocationService").getServiceInstanceTypeForResourceArea(e.resourceAreaId);o||(o=e.serviceInstanceType)}if(n.isHosted&&o&&o!==n.serviceInstanceType||i&&i!==n.hostType){if(n.isHosted&&V.userHasClaim(this.pageContext,"member")&&!r.authTokenProvider){var s=this.pageContext.getService("IAuthenticationService");r.authTokenProvider=s.getDefaultTokenProvider()}r.rootPath=x.getServiceLocation(this.pageContext,o,r.hostType)}else r.rootPath=n.hostPath||"/"}return r},t}(h.VssService);h.Services.add("IRestClientOptionsProviderService",{serviceFactory:r})}(),function(e){t.RestClientSettingsImpl={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getEntries=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Settings/Entries/{userScope}/{*key}",routeValues:{userScope:e,key:t}})]})})},t.prototype.removeEntries=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Settings/Entries/{userScope}/{*key}",routeValues:{userScope:e,key:t}})]})})},t.prototype.setEntries=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"PATCH",routeTemplate:"_apis/Settings/Entries/{userScope}/{*key}",routeValues:{userScope:t},body:e})]})})},t.prototype.getEntriesForScope=function(e,t,r,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Settings/{scopeName}/{scopeValue}/Entries/{userScope}/{*key}",routeValues:{userScope:e,scopeName:t,scopeValue:r,key:n}})]})})},t.prototype.removeEntriesForScope=function(e,t,r,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Settings/{scopeName}/{scopeValue}/Entries/{userScope}/{*key}",routeValues:{userScope:e,scopeName:t,scopeValue:r,key:n}})]})})},t.prototype.setEntriesForScope=function(e,t,r,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"PATCH",routeTemplate:"_apis/Settings/{scopeName}/{scopeValue}/Entries/{userScope}/{*key}",routeValues:{userScope:t,scopeName:r,scopeValue:n},body:e})]})})},t}(O.RestClientBase);h.RestClients.add("ISettingsRestClient",{factory:r})}(),function(e){t.RestClientWebContributionsImpl={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getContributedHierarchy=function(e,t,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return[2,this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/Contribution/Hierarchy/{contributionId}/{scopeName}/{scopeValue}",routeValues:{contributionId:e,scopeName:t,scopeValue:r}})]})})},t.prototype.queryContributedHierarchy=function(e,t,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return[2,this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Contribution/HierarchyQuery/{scopeName}/{scopeValue}",routeValues:{scopeName:t,scopeValue:r},body:e})]})})},t}(O.RestClientBase);h.RestClients.add("IWebContributionsRestClient",{factory:r})}(),function(e){t.Search={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){var t=this,r=this.pageContext.getService("IVssContributionService"),n=r.getContributionsByType("ms.vss-web.search-coordinator"),i=void 0,o=void 0;for(var s in n)(!o||n[s].priority>o.priority)&&(o=n[i=s]);return i?r.getService(i).then(function(r){if(r)return r.execute(e).then(function(e){return t._notify(e,"searchStarted"),e});throw new Error("Failed to create the configured search coordinator")}):Promise.reject("No search coordinator is available to perform the search operation.")},t.prototype.getProviders=function(){return this.pageContext.getService("IVssContributionService").getContributionsByType("ms.vss-web.search-provider")},t.prototype.getSelectedProvider=function(){var e=this.selectedProviderId||this.defaultProviderId;if(!e){var t=this.getProviders(),r=Object.keys(t);if(r.length>0){for(var n=this.pageContext.getService("IVssNavigationService"),i=n.getDisplayedNavigation(),o=[],s=i.length-1;s>=0;s--){var a=n.getNavigation(i[s]);a&&a.displayedDocTypes&&o.splice.apply(o,[i.length,0].concat(a.displayedDocTypes))}e:for(var c=0,u=o;c<u.length;c++){var p=u[c];for(var l in t){if((d=t[l]).supportedDocTypes&&-1!==d.supportedDocTypes.indexOf(p)){e=l;break e}}}if(!e)for(var l in e=r[0],t){var d=t[l],h=t[e];void 0!==d.priority&&(void 0===h.priority||d.priority>h.priority)&&(e=l)}this.defaultProviderId=e}}return e},t.prototype.setSelectedProvider=function(e){this.getProviders()[e]&&(this.selectedProviderId=e,this._notify(this.selectedProviderId,"providerSelected"))},t}(h.VssObservableService);h.Services.add("IVssSearchService",{serviceFactory:r})}(),function(e){t.Security={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.hasPermission=function(e,t,r){var n=this.pageContext.getService("IVssContributionService").getSharedData("_permissions");if(!n)return this.handleMissingState("No shared permissions found");var i=n[e.toLowerCase()];if(!i)return this.handleMissingState("Security namespace with id '"+e+"' not found");var o=i[t];return void 0===o?this.handleMissingState("No permissions found for security namespace '"+e+"' and token '"+t+"'"):(r&o)>0},t.prototype.checkPermission=function(e,t,r){if(!this.hasPermission(e,t,r))throw new Error("Access denied: Permission "+r+" is needed for the resource "+t+".")},t.prototype.handleMissingState=function(e){return console.error(e+". Ensure that the effective permissions are added using IClientSecurityProviderService.AddPermissions."),!1},t}(h.VssService);h.Services.add("IVssSecurityService",{serviceFactory:r})}(),function(e){t.Settings={},Object.defineProperty(t,"__esModule",{value:!0});var r=Promise.resolve({value:{},count:0}),n=Promise.resolve(),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getEntry=function(e,t,r,n){var i=this.getEntriesForKey(t,r,n);if(i){var o=i[e];if(void 0!==o)return o;for(var s=e.split("/"),a=s.length-2;a>=0;a--){var c=i[s.slice(0,a+1).join("/")];if(c){for(var u=c,p=a+1;p<s.length&&u;p++)u=u[s[p]];return u}}}},t.prototype.getEntriesAsync=function(e,t,n,i){var o=this;return this.canCallSettingsEndpoint?(n?this.httpClient.getEntriesForScope(this.userScopeToString(t),n,i,e):this.httpClient.getEntries(this.userScopeToString(t),e)).then(function(r){return o.updateLocalEntries(e,r,t,n,i)}):r},t.prototype.setEntries=function(e,t,r,i){if(!this.canCallSettingsEndpoint)return n;for(var o in e)this.updateLocalEntries(o,e[o],t,r,i);return r?this.httpClient.setEntriesForScope(e,this.userScopeToString(t),r,i):this.httpClient.setEntries(e,this.userScopeToString(t))},t.prototype.removeEntries=function(e,t,r,i){return this.canCallSettingsEndpoint?(this.updateLocalEntries(e,void 0,t,r,i),r?this.httpClient.removeEntriesForScope(this.userScopeToString(t),r,i,e):this.httpClient.removeEntries(this.userScopeToString(t),e)):n},t.prototype.userScopeToString=function(e){return 1===e?"host":"me"},Object.defineProperty(t.prototype,"httpClient",{get:function(){return this._httpClient||(this._httpClient=this.pageContext.getRestClient("ISettingsRestClient")),this._httpClient},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canCallSettingsEndpoint",{get:function(){return void 0===this._canCallSettingsEndpoint&&(this._canCallSettingsEndpoint=V.userHasClaim(this.pageContext,"member")),this._canCallSettingsEndpoint},enumerable:!0,configurable:!0}),t.prototype.updateLocalEntries=function(e,t,r,n,i){var o=this.getEntriesForKey(r,n,i);if(o){o[e]=t;for(var s=e.split("/"),a=s.length-2;a>=0;a--){var c=o[s.slice(0,a+1).join("/")];if(c){for(var u=c,p=a+1;p<s.length-1&&u;p++){var l=u[s[p]];l||(l=u[s[p]]={}),u=l}u[s[s.length-1]]=t}}}return t},t.prototype.getEntriesForKey=function(e,t,r){var n;if(this.canCallSettingsEndpoint){var i=this.pageContext.getService("IVssContributionService").getSharedData("_settings");if(i){var o=this.userScopeToString(e);t&&(o+=";"+t+";"+(r||"")),n=i[o]}}return n},t}(h.VssService);h.Services.add("ISettingsService",{serviceFactory:i})}(),function(e){function r(e,t){if(e.contains(t))return!0;var r=e.getAttribute("aria-owns");if(r&&n(r,t))return!0;for(var i=e.querySelectorAll("[aria-owns]"),o=0;o<i.length;o++){if(n(i[o].getAttribute("aria-owns"),t))return!0}return!1}function n(e,t){var n=document.querySelector("[id='"+e+"']");return!(!n||!r(n,t))}t.UtilDOM={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilDOM.contains=r}(),function(e){t.UtilLinking={},Object.defineProperty(t,"__esModule",{value:!0});var r="vstfs:///",n="/";function i(e){var t;return t=e.replace(/\+/g," "),t=decodeURIComponent(t)}t.UtilLinking.encodeUri=function(e){return r+[encodeURIComponent(e.tool),encodeURIComponent(e.type),encodeURIComponent(e.id)].join(n)},t.UtilLinking.decodeUri=function(e){var t;if(e.length>r.length&&e.substr(0,r.length).toLowerCase()===r&&(t=e.substr(r.length).split(n)).length>=3){var o=t[0],s=t[1],a=t.slice(2).join("/");return{uri:e,tool:i(o),type:i(s),id:i(a)}}throw new Error("Invalid artifact uri: "+e)}}(),function(e){t.UtilNumber={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilNumber.parseFloatLocale=function(e,t){void 0===t&&(t=navigator.language);var r,n,i=Intl.NumberFormat(t).format(1.1)[1],o=Intl.NumberFormat(t).format(1e3)[1],s=(e=e.trim()).indexOf(i);s<0?(r=e,n=null):(r=e.substr(0,s),n=e.substr(s+1));var a=(r=r.split(o).join(""))+(n?"."+n:"");return a.match(/^[+-]?\d*\.?\d*$/)?parseFloat(a):Number.NaN}}(),function(e){t.UtilDate={},Object.defineProperty(t,"__esModule",{value:!0});var r,i=60,o=60*i,s=7*(24*o);!function(e){e[e.Compact=0]="Compact",e[e.Extended=1]="Extended"}(r=t.UtilDate.AgoFormat||(t.UtilDate.AgoFormat={})),t.UtilDate.ago=function(e,t,a,c){a||(a=new Date),t||(t=r.Compact);var u=(a.getTime()-e.getTime())/1e3,p="";if(u<2*i)p=d.JustNow;else if(t===r.Compact)if(u<59*i)p=n.format(d.AgoMinutes,Math.round(u/i));else if(a.toDateString()===e.toDateString())p=n.format(d.AgoHours,Math.round(u/o));else if(u<s&&a.getDay()!==e.getDay())if((v=new Date).setDate(a.getDate()-1),e.getDate()===v.getDate())p=d.Yesterday;else{var l={weekday:"long"};p=e.toLocaleString(c,l)}else a.getFullYear()===e.getFullYear()?(l={month:"short",day:"numeric"},p=e.toLocaleDateString(c,l)):(l={month:"short",year:"numeric",day:"numeric"},p=e.toLocaleDateString(c,l));else if(t===r.Extended){var h="";if(a.toDateString()===e.toDateString())h=d.Today;else if(u<s&&a.getDay()!==e.getDay()){var v;(v=new Date).setDate(a.getDate()-1),e.getDate()===v.getDate()?h=d.Yesterday:(l={weekday:"short"},h=e.toLocaleString(c,l))}else a.getFullYear()===e.getFullYear()?(l={month:"short",day:"numeric"},h=e.toLocaleDateString(c,l)):(l={month:"short",year:"numeric",day:"numeric"},h=e.toLocaleDateString(c,l));var f=e.toLocaleString(c,{hour:"numeric",minute:"numeric"});p=n.format(d.DayAtTimeFormat,h,f)}return p||(p=e.toString()),p}}()},["Util/String","Resources","Context","Authentication","Content","Util/Object","Util/Serialization","Contribution","Util/Cookie","Fetch","Page","Util/Array","Util/Storage","Telemetry","Theming","Performance","Layout","Util/Url","Navigation","Trace","Components/ErrorBoundary/ErrorBoundary","Components/ErrorBoundary","Components/Format/Format","Components/Format","Components/Layout/Layout","Components/Layout","History","FPS","Components/FPSLink/FPSLink","Components/FPSLink","Fallback","Feature","Identity","KeyboardShortcuts","Location","RestClientBase","RestClient/AuthenticationImpl","RestClient/ClientTraceImpl","RestClient/ContributionsImpl","RestClient/CustomerIntelligenceImpl","RestClient/LocationsImpl","UserClaims","RestClient/OptionsProvider","RestClient/SettingsImpl","RestClient/WebContributionsImpl","Search","Security","Settings","Util/DOM","Util/Linking","Util/Number","Util/Date"]),function(e,t,r){function n(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r)}function i(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return u[e.which]?u[e.which]:p[e.which]?p[e.which]:String.fromCharCode(e.which).toLowerCase()}function o(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function s(e,t){var r,n=[],i=e;for("+"===i?i=["+"]:i=(i=i.replace(/\+{2}/g,"+plus")).split("+"),r=0;r<i.length;++r){var s=i[r];d[s]&&(s=d[s]),t&&"keypress"!=t&&l[s]&&(s=l[s],n.push("shift")),o(s)&&n.push(s)}if(i=s,!(r=t)){if(!c)for(var a in c={},u)95<a&&112>a||u.hasOwnProperty(a)&&(c[u[a]]=a);r=c[i]?"keydown":"keypress"}return"keypress"==r&&n.length&&(r="keydown"),{key:s,modifiers:n,action:r}}function a(e){function r(e){e=e||{};var t,r=!1;for(t in f)e[t]?r=!0:f[t]=0;r||(y=!1)}function c(e,t,r,n,i,s){var a,c=[],u=r.type;if(!h._callbacks[e])return[];for("keyup"==u&&o(e)&&(t=[e]),a=0;a<h._callbacks[e].length;++a){var p,l=h._callbacks[e][a];if((n||!l.seq||f[l.seq]==l.level)&&u==l.action)(p="keypress"==u&&!r.metaKey&&!r.ctrlKey)||(p=l.modifiers,p=t.sort().join(",")===p.sort().join(",")),p&&(p=n&&l.seq==n&&l.level==s,(!n&&l.combo==i||p)&&h._callbacks[e].splice(a,1),c.push(l))}return c}function u(e,t,r,n){h.stopCallback(t,t.target||t.srcElement,r,n)||!1!==e(t,r)||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)}function p(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=i(e);t&&("keyup"==e.type&&g===t?g=!1:h.handleKey(t,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e))}function l(e,t,n,o){function a(t){return function(){y=t,++f[e],clearTimeout(v),v=setTimeout(r,1e3)}}function c(t){u(n,t,e),"keyup"!==o&&(g=i(t)),setTimeout(r,10)}for(var p=f[e]=0;p<t.length;++p){var l=p+1===t.length?c:a(o||s(t[p+1]).action);d(t[p],l,o,e,p)}}function d(e,t,r,n,i){h._directMap[e+":"+r]=t;var o=(e=e.replace(/\s+/g," ")).split(" ");1<o.length?l(e,o,t,r):(r=s(e,r),h._callbacks[r.key]=h._callbacks[r.key]||[],c(r.key,r.modifiers,{type:r.action},n,e,i),h._callbacks[r.key][n?"unshift":"push"]({callback:t,modifiers:r.modifiers,action:r.action,seq:n,level:i,combo:e}))}var h=this;if(e=e||t,!(h instanceof a))return new a(e);h.target=e,h._callbacks={},h._directMap={};var v,f={},g=!1,m=!1,y=!1;h._handleKey=function(e,t,n){var i,s=c(e,t,n);t={};var a=0,p=!1;for(i=0;i<s.length;++i)s[i].seq&&(a=Math.max(a,s[i].level));for(i=0;i<s.length;++i)s[i].seq?s[i].level==a&&(p=!0,t[s[i].seq]=1,u(s[i].callback,n,s[i].combo,s[i].seq)):p||u(s[i].callback,n,s[i].combo);s="keypress"==n.type&&m,n.type!=y||o(e)||s||r(t),m=p&&"keydown"==n.type},h._bindMultiple=function(e,t,r){for(var n=0;n<e.length;++n)d(e[n],t,r)},n(e,"keypress",p),n(e,"keydown",p),n(e,"keyup",p)}if(e){var c,u={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},p={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},l={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},d={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"};for(r=1;20>r;++r)u[111+r]="f"+r;for(r=0;9>=r;++r)u[r+96]=r.toString();a.prototype.bind=function(e,t,r){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,r),this},a.prototype.unbind=function(e,t){return this.bind.call(this,e,function(){},t)},a.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},a.prototype.reset=function(){return this._callbacks={},this._directMap={},this},a.prototype.stopCallback=function(e,r){return!(-1<(" "+r.className+" ").indexOf(" mousetrap ")||function e(r,n){return null!==r&&r!==t&&(r===n||e(r.parentNode,n))}(r,this.target))&&("INPUT"==r.tagName||"SELECT"==r.tagName||"TEXTAREA"==r.tagName||r.isContentEditable)},a.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},a.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(u[t]=e[t]);c=null},a.init=function(){var e,r=a(t);for(e in r)"_"!==e.charAt(0)&&(a[e]=function(e){return function(){return r[e].apply(r,arguments)}}(e))},a.init(),e.Mousetrap=a,"undefined"!=typeof module&&module.exports&&(module.exports=a),"function"==typeof define&&define.amd&&define("mousetrap",function(){return a})}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null),function(e){if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&r.indexOf(Object.prototype.toString.call(e))>-1};p.prototype.append=function(e,t){e=a(e),t=c(t);var r=this.map[e];this.map[e]=r?r+","+t:t},p.prototype.delete=function(e){delete this.map[a(e)]},p.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},p.prototype.set=function(e,t){this.map[a(e)]=c(t)},p.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},p.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),u(e)},p.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},p.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),u(e)},t.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},f.call(g.prototype),f.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var s=[301,302,303,307,308];y.redirect=function(e,t){if(-1===s.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=g,e.Response=y,e.fetch=function(e,r){return new Promise(function(n,i){var o=new g(e,r),s=new XMLHttpRequest;s.onload=function(){var e,t,r={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new p,e.split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}}),t)};r.url="responseURL"in s?s.responseURL:r.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;n(new y(i,r))},s.onerror=function(){i(new TypeError("Network request failed"))},s.ontimeout=function(){i(new TypeError("Network request failed"))},s.open(o.method,o.url,!0),"include"===o.credentials&&(s.withCredentials=!0),"responseType"in s&&t.blob&&(s.responseType="blob"),o.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var r={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(r[Symbol.iterator]=function(){return r}),r}function p(e){this.map={},e instanceof p?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function d(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function h(e){var t=new FileReader,r=d(t);return t.readAsArrayBuffer(e),r}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&n(e))this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var e,t,r,n=l(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=d(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(e,t){var r,n,i=(t=t||{}).body;if(e instanceof g){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),o.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function m(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function y(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-web.platform-content"}}));