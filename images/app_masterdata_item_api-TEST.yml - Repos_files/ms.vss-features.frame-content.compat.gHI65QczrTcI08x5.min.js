"use strict";define("VSS/Features/Frame",["require","exports","VSS/Platform/Layout","VSS/Platform/Location","VSS/Core/Util/String","VSS/Platform/Util/Url","react","VSS/Core/Observable","react-dom","VSSUI/FocusZone","VSSUI/Callout","VSS/Platform/Components/FPSLink","VSS/Platform/Util/DOM","VSSUI/Icon","VSSUI/Util","VSS/Platform/Feature","VSS/Platform/FPS","VSSUI/Link"],function(e,t,n,o,r,i,s,a,p,d,c,u,m,l,h,f,v,y){var C,g,b,x,I,P,_,S,E,w;t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.Close="Close",function(e){C=t.AssetResolverAssetResolver={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this,t=this.props.assets.map(function(t){return o.getAssetLocation(e.context.pageContext,t)});return this.props.children(t)},t}(n.VssComponent);t.AssetResolverAssetResolver.AssetResolver=r}(),function(e){g=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(n){for(var o in n)t[e].hasOwnProperty(o)||(t[e][o]=n[o])}(C)}("AssetResolverindex"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(n){for(var o in n)t[e].hasOwnProperty(o)||(t[e][o]=n[o])}(g)}("AssetResolver"),function(e){b=t.ContributedIconUtil={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedIconUtil.contributionIconToIconProps=function(e,t,o){var s;if(o){var a=void 0,p=!0;if("object"==typeof o){var d=e.getService("IVssThemeService").getCurrentTheme();o=o[d&&d.isDark?"dark":"light"],p=!1}if(o.match(/^https?:\/\//))a=o;else{var c=e.getService("IVssContributionService").getContributionProvider(t);c&&(a=i.combineUrlPaths(c.baseUri,o))}a&&(s={iconName:"None",className:n.css("icon third-party-icon contributed-icon-image",p&&"non-themed"),style:{backgroundImage:r.format("url({0})",a),backgroundRepeat:"no-repeat"}})}return s}}(),function(e){x=t.ContributedMenuItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,o){var r=this;this.ownerDrawMenuItem=function(e){return s.createElement(n.WrappedComponent,Object.assign({wrappedType:e.componentType},Object.assign({key:e.key},e.componentProperties)))},this.onMenuItem=function(e,t){if(t){var n=r._pageContext.getService("IVssContributionService");t.command?n.executeCommandEx(t.key,t.command,r._data):n.getService(t.key,!0).then(function(e){e&&e.execute&&e.execute(r._data)})}},this._pageContext=e,this._menuId=t,this._data=o}return e.prototype.loadItems=function(e,t){var n=this,o=[],r={},i=this._pageContext.getService("IVssContributionService"),s=i.getSharedData("_menuItems");if(s){var p=s[this._menuId];p&&p.length>0&&(p.forEach(function(e){e.onClick=e.command?n.onMenuItem:void 0,o.push(e)}),e(this.prepareMenuItems(o)))}var d=i.getContributionChildren(this._menuId,"ms.vss-web.menu-item");if(d)for(var c=0;c<d.length;c++){var u=d[c],m=i.getContribution(u);m&&(o.push(this.createMenuItem(m,u)),r[u]=u)}var l=i.getContributionsByType("ms.vss-web.menu-item");if(l)for(var h in l)if(!r[h]){var f=l[h];f.menuId===this._menuId&&(o.push(this.createMenuItem(f,h)),r[h]=h)}o.length>0&&e(this.prepareMenuItems(o));var v=i.getContributionChildren(this._menuId,"ms.vss-web.menu-provider")||[],y={};for(c=0;c<v.length;c++)y[v[c]]=v[c];var C=i.getContributionsByType("ms.vss-web.menu-provider");if(C)for(var g in C){if(!y[g])C[g].menuId===this._menuId&&(v.push(g),y[g]=g)}if(v&&v.length>0)for(var x=v.slice(0),I=function(o){i.getService(o,!0).then(function(r){if(r){var i=function(r,i){e(n.prepareMenuItems(r),i);var s=x.indexOf(o);s>-1&&(x.splice(s,1),0===x.length&&t())};if("function"==typeof r.loadItems)r.loadItems(i);else if("function"==typeof r.getMenuItems){var s=function(e){for(var t=[],r=function(r){var i;i=a.ObservableLike.getValue(e)[r];var s={key:o+r.toString(),name:i.text,groupId:i.groupId,iconProps:b.contributionIconToIconProps(n._pageContext,i.id,i.icon),onClick:function(e,t){i.action&&i.action(n._data)}};t.push(s)},i=0;i<e.length;i++)r(i);return t},p=r.getMenuItems(n._data||{});p instanceof Promise?p.then(function(e){i(s(e),[])}):i(s(p),[])}}})},P=0,_=v;P<_.length;P++){I(u=_[P])}else t()},e.prototype.createMenuItem=function(e,t){return{command:e.command,href:e.href,iconProps:e.iconProps||b.contributionIconToIconProps(this._pageContext,e.id,e.icon),key:t,name:e.name,rank:e.rank,onClick:e.command?this.onMenuItem:void 0,groupKey:e.groupKey}},e.prototype.prepareMenuItems=function(t){for(var n=0,o=t;n<o.length;n++){var r=o[n];r.componentType&&(r.onRender=this.ownerDrawMenuItem);var i=r.menuId;i&&(r.subMenuProps||(r.subMenuProps={}),r.subMenuProps.providers=[new e(this._pageContext,i)])}return t},e}();t.ContributedMenuItemProvider.ContributedMenuItemProvider=o}(),function(e){I=t.ResponsiveLayoutResponsiveLayout={},Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this,t)||this;return n.adjustedIndex=0,n.updateLayout=function(){var e=p.findDOMNode(n);if(e&&e.children.length){var t=n.adjustedIndex,o=e.getBoundingClientRect(),r=0,i=0,s=!1;n.adjustDetails&&e.children.length===n.adjustDetails.length||(n.appliedAdjustments=[],n.adjustDetails=[],n.adjustments=n.props.adjustments.slice(0,n.props.adjustments.length),n.adjustments.sort(function(e,t){var n=(e.priority||Number.MAX_VALUE)-(t.priority||Number.MAX_VALUE);return 0===n&&(n=t.index-e.index),n}),s=!0);for(var a=0;a<e.children.length;a++){var d=e.children[a].getBoundingClientRect();s?n.adjustDetails.push({adjustmentIndex:-1,clientRect:d}):n.adjustDetails[a].clientRect=d,n.props.ignoredChildren[a]&&(i+=1===n.props.orientation?d.height:d.width)}r=1===n.props.orientation?n.adjustDetails[n.adjustDetails.length-1].clientRect.bottom-n.adjustDetails[0].clientRect.top:n.adjustDetails[n.adjustDetails.length-1].clientRect.right-n.adjustDetails[0].clientRect.left,r-=Math.floor(i);var c=1===n.props.orientation?o.height:o.width;if(c<=r)for(var u={},m=c-r;m<0&&n.adjustedIndex<n.adjustments.length;){var l=n.adjustments[n.adjustedIndex],h=n.adjustDetails[l.index],f=void 0;f=1===n.props.orientation?h.clientRect.height-(u[l.index]||0):h.clientRect.width-(u[l.index]||0),l.approxSize?f-=l.approxSize:h.hidden=!0,h.adjustmentIndex++,m+=f,n.appliedAdjustments[n.adjustedIndex]=f,u[l.index]=f+(u[l.index]||0),n.adjustedIndex++}else if(c>r)for(m=c-r;n.adjustedIndex>0&&n.appliedAdjustments[n.adjustedIndex-1]<m;){l=n.adjustments[--n.adjustedIndex];(h=n.adjustDetails[l.index]).adjustmentIndex--,m-=n.appliedAdjustments[n.adjustedIndex],h.hidden=!1}t!=n.adjustedIndex&&(n.props.onLayoutChange&&n.props.onLayoutChange(n.adjustedIndex-1),window.setTimeout(function(){n.forceUpdate()},0))}},n.addEventListener(window,"resize",function(){n.updateLayout()}),n}return __extends(t,e),t.prototype.render=function(){var e=this,t=s.Children.only(this.props.children);return s.cloneElement(t,t.props,s.Children.map(t.props.children,function(t,n){if(e.adjustDetails&&e.adjustDetails[n]){if(e.adjustDetails[n].hidden)return s.createElement("div",{key:"PH"+n,className:"responsive-placeholder"});if(e.adjustDetails[n].adjustmentIndex>=0){var o=t,r=Object.assign({},o.props,{adjustmentIndex:e.adjustDetails[n].adjustmentIndex});return s.cloneElement(o,r,o.props&&o.props.children)}}return t}))},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.updateLayout()},t.prototype.componentDidUpdate=function(t,n){e.prototype.componentDidUpdate.call(this,t,n),this.updateLayout()},t.prototype.resetLayout=function(){delete this.adjustDetails,this.adjustedIndex=0},t}(n.VssComponent);t.ResponsiveLayoutResponsiveLayout.ResponsiveLayout=o}(),function(e){P=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(n){for(var o in n)t[e].hasOwnProperty(o)||(t[e][o]=n[o])}(I)}("ResponsiveLayout"),function(e){_=t.CommandBarCommandBarFlyout={},Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.apply(this,arguments)||this;return t.onDismiss=function(){t.props.onDismiss&&t.props.onDismiss()},t}return __extends(t,e),t.prototype.render=function(){var e=this,t=s.Children.map(this.props.children,function(t,n){return t&&s.cloneElement(t,Object.assign({},t.props,{onDismiss:e.onDismiss}),t.props.children)});return s.createElement(c.Callout,{ariaLabel:this.props.ariaLabel,className:n.css("command-bar-flyout",this.props.className),contentClassName:n.css("command-bar-flyout-content relative scroll-hidden",this.props.contentClassName),contentJustification:3,contentLocation:2,contentOrientation:0,id:this.props.id,escDismiss:this.props.escDismiss,lightDismiss:this.props.lightDismiss,modal:this.props.modal,onDismiss:this.onDismiss},s.createElement(d.FocusZone,{circularNavigation:!0,defaultActiveElement:this.props.defaultActiveElement||".command-bar-flyout-focus-element",focusOnMount:!0,handleTabKey:!0,includeDefaults:!0},s.createElement("div",{"aria-label":this.props.ariaLabel,className:"flex flex-column flex-grow scroll-hidden"},s.createElement("div",{className:"command-bar-flyout-focus-element",role:"presentation",tabIndex:-1}),t)))},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.calloutDismissed&&this.calloutDismissed()},t}(n.VssComponent);t.CommandBarCommandBarFlyout.CommandBarFlyout=o,n.VssComponent.register("commandBarFlyout",o)}(),function(e){S=t.CommandBarCommandBar={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.stateComponents={},o.components={},o.childCount=0,o.expand=function(e,t,n){if(t){if((!o.expanded||o.expandedKey!==e)&&o.components[e])return o.focusedKey&&o.focusedKey!==e&&o.focusComponent(o.components[e]),o.expandedReason=n,o.expandedKey=e,o.expanded=!0,o.forceUpdate(),!0}else if(o.expandedKey===e&&o.expanded)return o.expandedReason=void 0,o.expandedKey=void 0,o.expanded=void 0,o.forceUpdate(),!0;return!1},o.onBlur=function(e){o.componentElement&&o.componentElement.contains(e.srcElement)&&o.setTimeout(function(){o.processFocusChange=!0,o.forceUpdate()})},o.onFocus=function(e){if(o.focusElement===document.activeElement){var t=o.componentElement.querySelector("[tabIndex='-2']");t&&t.focus()}else o.componentElement&&o.componentElement.contains(e.target)&&(o.processFocusChange=!0,o.forceUpdate())},o.onKeyDown=function(e){if(!e.defaultPrevented&&o.focusedKey)for(var t=void 0,n=parseInt(o.focusedKey),r=n,i=!1,s=1===o.props.orientation?38:37,a=1===o.props.orientation?40:39;e.which===s?(-1==--n&&(n=o.childCount-1),i=!0):e.which===a&&++n===o.childCount&&(n=0),n!==r;)if((t=o.components[n])&&o.focusComponent(t,i)){e.preventDefault();break}},o.onKeyDownBody=function(e){o.setTimeout(function(){o.onKeyDown(e)},0)},o.processItems(t),o}return __extends(t,e),t.prototype.render=function(){var e=this;this.componentDetails?this.childCount=this.componentDetails.length:this.props.children&&(this.childCount=s.Children.count(this.props.children));var t,o=[];if(this.componentDetails?this.componentDetails.forEach(function(t,r){o.push({groupKey:t.componentProperties&&t.componentProperties.groupKey,element:s.createElement(n.WrappedComponent,Object.assign({wrappedType:t.componentType},Object.assign(e.getItemProps(r.toString()),t.componentProperties,{key:r.toString()})))})},this):this.props.children&&s.Children.forEach(this.props.children,function(t,n){var r;t||(t=s.createElement("div",{className:"commandbar-item-placeholder"}),r={}),r="string"==typeof t.type?{ref:function(t){e.components[n.toString()]=t}}:e.getItemProps(n.toString()),o.push({groupKey:t.props&&(t.props.groupKey||t.props["data-groupKey"]),element:s.cloneElement(t,Object.assign(r,t.props),t.props.children)})}),this.props.groups){for(var r={},a=0,p=this.props.groups;a<p.length;a++){var d=p[a];r[d.key]=d}for(var c=[],u=void 0,m=function(e){var t=void 0;if(e.groupKey&&(t=r[e.groupKey]),u&&t===u.group)u.items.push(e.element);else{var n=void 0;t&&(n=c.filter(function(e){return e.group===t})[0]),n?u=n:(u={group:t,items:[]},c.push(u)),u.items.push(e.element)}},l=0,h=o;l<h.length;l++){m(h[l])}t=[];for(var f=!1,v=!1,y=0,C=0,g=c;C<g.length;C++){var b=g[C];b.group?(f&&b.group.useSeparators&&t.push(s.createElement(i,{key:"group-separator-"+(++y).toString()})),t.push(s.createElement("div",{key:"group-"+b.group.key,className:b.group.className,ref:b.group.ref},b.items)),b.group.useSeparators?(v=!0,f=!1):f=!0):(v&&t.push(s.createElement(i,{key:"group-separator-"+(++y).toString()})),t.push.apply(t,b.items),f=!0)}}else t=o.map(function(e){return e.element});var x=s.createElement("div",{"aria-label":this.props["aria-label"],className:n.css("commandbar",this.props.className,this.props.componentRegion?"region-"+this.props.componentRegion:"",1===this.props.orientation?"flex-column":"flex-row",this.focusedKey?"focus":""),"data-renderedregion":this.props.componentRegion?this.props.componentRegion:null,ref:function(t){e.componentElement=t},role:"menubar",onFocus:this.onFocus,onKeyDown:function(t){e.onKeyDown(t.nativeEvent)}},s.createElement("div",{key:"focus.element",ref:function(t){e.focusElement=t},onFocus:this.onFocus,tabIndex:this.focusedKey?-1:0}),t);return this.responsiveProps&&(x=s.createElement(P.ResponsiveLayout,Object.assign({ref:function(t){e.responsiveLayout=t},orientation:1===this.props.orientation?1:0},this.responsiveProps),x)),x},t.prototype.componentDidUpdate=function(t,n){if(e.prototype.componentDidUpdate.call(this,t,n),this.processFocusChange){var o=!1;for(var r in this.components){var i=this.components[r];if(i){var s=p.findDOMNode(i);if(s&&document.activeElement&&m.contains(s,document.activeElement)){this.focusedKey!==r?"-2"===document.activeElement.getAttribute("tabIndex")&&(this.addEventListener(document.body,"blur",this.onBlur,!0),-1===navigator.userAgent.toLowerCase().indexOf("trident")&&this.addEventListener(document.body,"keydown",this.onKeyDownBody),this.expanded&&this.expand(r,!0,"focus"),o=!0,this.focusedKey=r,this.forceUpdate()):o=!0;break}}}o||(this.expandedKey&&this.expand(this.expandedKey,!1,"blur"),this.focusedKey&&(this.focusedKey=void 0,this.removeEventListener(document.body,"blur",this.onBlur,!0),this.removeEventListener(document.body,"keydown",this.onKeyDownBody),this.forceUpdate())),delete this.processFocusChange}},t.prototype.componentWillReceiveProps=function(t){if(e.prototype.componentWillReceiveProps.call(this,t),this.processItems(t),this.focusedKey&&(t.children||this.componentDetails)){var n=this.components[this.focusedKey];if(n){var o=!1;if(t.children)s.Children.map(this.props.children,function(e,t){(e.key===n.props.key||e.key===n.props.navigationId||n.props.contributedNavigation&&e.key===n.props.contributedNavigation.id)&&(o=!0)});else if(this.componentDetails)for(var r=0;r<this.componentDetails.length;r++){var i=this.componentDetails[r];if(i.componentProperties&&i.componentProperties.key===n.props.key){o=!0;break}}if(!o)for(var a=void 0,p=parseInt(this.focusedKey),d=p;!((a=this.components[p])&&this.focusComponent(a)||(-1==--p&&(p=this.childCount-1),p===d)););}}this.components={},this.stateComponents={}},t.prototype.focus=function(e){this.focusComponent(this.components[e.toString()])},t.prototype.resetLayout=function(){this.responsiveLayout&&this.responsiveLayout.resetLayout()},t.prototype.processItems=function(e){var t;if(e.componentRegion){var n=this.context.pageContext.getService("IVssLayoutManager");this.componentDetails=n.getComponentsForRegion(e.componentRegion)}else e.items?this.componentDetails=e.items:this.componentDetails=void 0;if(e.responsiveProps){this.responsiveProps={adjustments:[],ignoredChildren:e.responsiveProps.ignoredChildren.slice(0,e.responsiveProps.ignoredChildren.length),onLayoutChange:e.responsiveProps.onLayoutChange};for(var o=0;o<e.responsiveProps.adjustments.length;o++)this.responsiveProps.adjustments[o]=Object.assign({},e.responsiveProps.adjustments[o]),this.responsiveProps.adjustments[o].index++;(t=this.responsiveProps.ignoredChildren).splice.apply(t,[0,0].concat([!0]))}},t.prototype.focusComponent=function(e,t){var n=p.findDOMNode(e);if(n){var o=void 0;if("-2"===n.getAttribute("tabIndex"))o=n;else if(t){var r=n.querySelectorAll("[tabIndex='-2']");o=r.item(r.length-1)}else o=n.querySelector("[tabIndex='-2']");if(o)return o.focus(),!0}return!1},t.prototype.getItemProps=function(e){var t=this;return{itemKey:e,expand:this.expand,expandOnHover:!0,expanded:this.expandedKey===e,expandedReason:this.expandedReason,mouseHoverDelayMs:this.expanded?0:200,ref:function(n){t.components[e]=t.stateComponents[e]||n},selected:this.focusedKey===e,shouldFocusOnMount:!!this.focusedKey}},t}(n.VssComponent);r.componentType="commandBar",t.CommandBarCommandBar.CommandBarComponent=r,n.VssComponent.register(r.componentType,r),n.VssComponent.register("commandbar",r);var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return s.createElement("div",{className:"flex separator",role:"separator"},s.createElement("div",{className:n.css("flex-cell","separator-item",this.props.className)}))},t}(s.Component);i.componentType="commandBarSeperator",t.CommandBarCommandBar.CommandBarSeperatorComponent=i,n.VssComponent.register("commandBarSeparator",i),n.VssComponent.register(i.componentType,i);var a=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.onSearchExpanded=function(){o.setState({searchExpanded:!0})},o.onSearchCollapsed=function(){o.setState({searchExpanded:!1})},window.addEventListener("searchExpanded",o.onSearchExpanded),window.addEventListener("searchCollapsed",o.onSearchCollapsed),o.state={searchExpanded:!1},o}return __extends(t,e),t.prototype.componentWillUnmount=function(){window.removeEventListener("searchExpanded",this.onSearchExpanded),window.removeEventListener("searchCollapsed",this.onSearchCollapsed)},t.prototype.render=function(){return this.state.searchExpanded?null:s.createElement(i,Object.assign({},this.props))},t}(s.Component);a.componentType="verticalHeaderCommandBarSeperator",t.CommandBarCommandBar.VerticalHeaderCommandBarSeparatorComponent=a,n.VssComponent.register("verticalHeaderCommandBarSeperator",a),n.VssComponent.register(a.componentType,a);var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return s.createElement("div",{"aria-label":this.props["aria-label"],className:n.css("commandbar-item",this.props.className,this.props.selected||this.props.expanded?" selected":""),id:this.props.id,role:"menuitem",tabIndex:this.props.noTabIndex?void 0:this.props.selected?0:-2},this.props.children)},t}(n.VssComponent);t.CommandBarCommandBar.CommandBarChildComponent=d;var c=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.onDivClick=function(e){if(!e.isDefaultPrevented()){if(o.props.telemetrySource)o.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","Command",Object.assign({},o.props.telemetryProperties||{},{source:o.props.telemetrySource}));o.props.onClick&&o.props.onClick(e)}},o.onDivKeyDown=function(e){e.isDefaultPrevented()||32!==e.which&&13!==e.which||o.onDivClick(e)},o.computeHref(t),o}return __extends(t,e),t.prototype.render=function(){var e=!!this.href,t=n.css("commandbar-item commandbar-item-command",this.props.className),o={"aria-label":this.props["aria-label"],id:this.props.id,role:"menuitem",tabIndex:this.props.noTabIndex?void 0:this.props.selected?0:-2},r=[];return this.props.iconName&&r.push(s.createElement(l.Icon,{key:"icon",className:"commandbar-item-icon",iconName:this.props.iconName})),this.props.text&&r.push(s.createElement("span",{key:"text",className:"commandbar-item-text"},this.props.text)),r.splice(r.length,0,this.props.children),e?s.createElement(u.FPSLinkComponent,Object.assign({},o,{className:n.css("commandbar-item-link",t,this.props.selected||this.props.expanded?" selected":""),href:this.href,supportsFPS:!0===this.props.supportsFPS,title:this.props.title,onClick:this.props.onClick,onMouseDown:function(e){e.preventDefault()},telemetrySource:this.props.telemetrySource||"commandBarCommand",telemetryProperties:this.props.telemetryProperties,navigationId:this.props.navigationId}),r):s.createElement("div",Object.assign({},o,{className:n.css("commandbar-item-button cursor-pointer",t,this.props.selected?"selected":""),role:"button",title:this.props.title,onClick:this.onDivClick,onKeyDown:this.onDivKeyDown,onMouseDown:function(e){e.preventDefault()}}),r)},t.prototype.componentWillReceiveProps=function(t){e.prototype.componentWillReceiveProps.call(this,t),this.computeHref(t)},t.prototype.computeHref=function(e){e.href?this.href=e.href:e.routeId?this.href=o.routeUrl(this.context.pageContext,e.routeId,e.routeValues||{}):this.href=void 0},t}(n.VssComponent);c.componentType="commandBarCommand",t.CommandBarCommandBar.CommandBarCommandComponent=c,n.VssComponent.register("commandBarLink",c),n.VssComponent.register(c.componentType,c);var h=function(e){function t(){var t=e.apply(this,arguments)||this;return t.onKeyDown=function(e){if(t.element&&t.element.contains(e.target)&&!e.defaultPrevented){var n=t.props.expandKey||40;(13===e.which||e.which===n||e.shiftKey&&121===e.which)&&(t.props.expand&&t.props.itemKey&&t.props.expand(t.props.itemKey,!0,e.type),e.preventDefault())}},t.onMouseEnter=function(e){if(t.props.expandOnHover&&t.props.expand){var n=e.type;t.hoverTimeout&&t.clearTimeout(t.hoverTimeout),t.hoverTimeout=t.setTimeout(function(){t.props.expand&&t.props.itemKey&&t.props.expand(t.props.itemKey,!0,n)},t.props.mouseHoverDelayMs)}},t.onMouseLeave=function(e){t.hoverTimeout&&(t.clearTimeout(t.hoverTimeout),delete t.hoverTimeout)},t.onClick=function(e){t.element&&t.element.contains(e.target)&&t.props.expand&&t.props.itemKey&&!e.defaultPrevented&&t.props.expand(t.props.itemKey,!t.props.expanded,e.type)},t.touchEnd=function(e){t.props.expand&&t.props.itemKey&&!t.props.expanded&&(t.props.expand(t.props.itemKey,!0,e.type),e.preventDefault())},t}return __extends(t,e),t.prototype.render=function(){var e=this;return s.createElement("div",{"aria-controls":this.props.expanded?this.props.calloutId:void 0,"aria-expanded":this.props.expanded,"aria-haspopup":!0,"aria-label":this.props["aria-label"],"aria-owns":this.props.expanded?this.props.calloutId:void 0,className:n.css("commandbar-item cursor-pointer",this.props.className,this.props.selected||this.props.expanded?"selected":"",this.props.expanded?"expanded":""),id:this.props.id,ref:function(t){return e.element=t},role:"menuitem",tabIndex:this.props.noTabIndex?void 0:this.props.selected?0:-2,onClick:this.onClick,onMouseDown:function(t){e.element&&e.element.contains(t.target)&&t.preventDefault()},onKeyDown:this.onKeyDown,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onTouchEnd:this.touchEnd},this.props.iconName&&s.createElement(l.Icon,{iconName:this.props.iconName}),this.props.children)},t}(n.VssComponent);t.CommandBarCommandBar.CommandBarExpandableComponent=h;var f=function(e){function t(t){var n=e.call(this,t)||this;return t.menuProps&&(n.menuId=t.menuProps.id),n.menuId=n.menuId||"menu"+n.componentId,n}return __extends(t,e),t.prototype.render=function(){var e=this,t=this.props.expanded?this.getMenuProps():null;return s.createElement(h,Object.assign({},this.props,{calloutId:this.props.expanded?this.menuId:void 0,className:n.css("commandbar-item-menu",this.props.className),id:"cmec"+this.componentId}),this.props.children,this.props.expanded?s.createElement(n.WrappedComponent,{wrappedType:"contextualMenu",wrappedRef:function(t){e.menuComponent=t},wrappedProps:t,dependencies:["ms.vss-features.ui-content"]}):null)},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.expanded&&this.forceUpdate()},t.prototype.getMenuProps=function(){var e=this,t=[];return this.props.menuId&&t.push(new x.ContributedMenuItemProvider(this.context.pageContext,this.props.menuId)),this.props.menuProps&&this.props.menuProps.providers&&t.push.apply(t,this.props.menuProps.providers),Object.assign({gapSpace:0,id:this.menuId,items:this.props.items||[],providers:t,bounds:{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight}},this.props.menuProps,{mouseLeaveDelayMs:this.props.expandedReason&&"mouseenter"===this.props.expandedReason?this.props.mouseLeaveDelayMs:0,onDismiss:function(t){e.props.expand&&e.props.itemKey&&e.props.expand(e.props.itemKey,!1,t&&t.type)},shouldFocusOnMount:this.props.shouldFocusOnMount,target:"#cmec"+this.componentId})},t}(n.VssComponent);f.defaultProps=Object.assign({mouseLeaveDelayMs:500,mouseHoverDelayMs:200},n.VssComponent.defaultProps),t.CommandBarCommandBar.CommandBarMenuComponent=f,n.VssComponent.register("commandBarMenu",f);var v=function(e){function t(){var t=e.apply(this,arguments)||this;return t.onDismiss=function(){t.props.expand&&t.props.itemKey&&t.props.expand(t.props.itemKey,!1)},t}return __extends(t,e),t.prototype.render=function(){return s.createElement(h,Object.assign({},this.props,{expandOnHover:!1,calloutId:this.props.expanded?"flyout"+this.componentId:void 0,className:n.css("commandbar-item-flyout",this.props.className),id:"cpec"+this.componentId}),this.props.children,this.props.expanded?s.createElement(_.CommandBarFlyout,Object.assign({},this.props.commandBarFlyoutProps,{id:"flyout"+this.componentId,onDismiss:this.onDismiss,openingElement:"#cpec"+this.componentId}),s.createElement(n.WrappedComponent,Object.assign({},this.props.wrappedComponent,{expandedReason:this.props.expandedReason}))):null)},t}(n.VssComponent);t.CommandBarCommandBar.CommandBarFlyoutComponent=v,n.VssComponent.register("commandBarFlyoutComponent",v)}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(n){for(var o in n)t[e].hasOwnProperty(o)||(t[e][o]=n[o])}(S)}("CommandBar"),function(e){E=t.ContributedContentComponent={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedContentComponent.ContributedContentComponent=function(e){var t=Object.assign({},e.componentProperties,e.contribution.componentProperties,{className:h.css(e.className,e.componentProperties&&e.componentProperties.className,e.contribution.componentProperties&&e.contribution.componentProperties.className)}),o=(e.dependencies||[]).concat(e.contribution.dependencies||[]);return e.contribution.uri?s.createElement(n.WrappedComponent,{dependencies:o.concat(["ms.vss-web.ext-content"]),wrappedType:"ExternalContent",wrappedProps:Object.assign({},t,{contributionId:e.contributionId})}):e.contribution.componentType?s.createElement(n.WrappedComponent,{dependencies:o,wrappedType:e.contribution.componentType,wrappedProps:t}):null}}(),function(e){t.ContributedPivotBarActionProvider={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._pageContext=e.context,this._targetId=e.targetId,this._contributionType=e.contributionType||"ms.vss-web.action",this._getContext=e.getContext}return e.prototype.loadItems=function(e){var t=this,n=this._pageContext.getService("IVssContributionService"),o=n.getContributionChildren(this._targetId,this._contributionType),r=[];if(o)for(var i=function(e){var o=n.getContribution(e);if(o){var i={key:e,name:o.text?o.text:o.title,iconProps:o.iconProps||b.contributionIconToIconProps(s._pageContext,e,o.icon),important:o.important,command:o.command,registeredObjectId:o.registeredObjectId,uri:o.uri,onClick:function(o,r){var s;if(i)if(t._getContext&&(s=t._getContext(i)),i.command)n.executeCommandEx(e,i.command,s);else{var a={serviceName:i.registeredObjectId||i.key,uri:i.uri,configuration:s};n.getServiceEx(i.key,a,!0).then(function(e){e&&e.execute&&e.execute(s)})}}};r.push(i)}},s=this,a=0,p=o;a<p.length;a++){i(p[a])}e(r),(n.getContributionChildren(this._targetId,"ms.vss-web.action-provider")||[]).forEach(function(o){n.getService(o,!0).then(function(n){if(n){var r=t._getContext?t._getContext({key:o},!0):void 0;if(n.loadItems)n.loadItems(function(t,n){e(t,n)},r);else if(n.getMenuItems){var i=function(e){for(var n=[],r=0;r<e.length;r++){var i=e[r],s=t._convertContributedMenuToPivotAction(i,o,r.toString());n.push(s)}return n},s=n.getMenuItems(r||{});s instanceof Promise?s.then(function(t){e(i(t),[])}):e(i(s),[])}}})})},e.prototype._convertContributedMenuToPivotAction=function(e,t,n){var o=this,r={key:t+n,name:e.text?e.text:e.title,iconProps:b.contributionIconToIconProps(this._pageContext,this._targetId,e.icon),separator:e.separator,disabled:e.disabled,href:e.href,onClick:function(n,r){if(e.action){var i=o._getContext?o._getContext({key:t},!0):void 0;e.action(i)}}};if(e.childItems&&e.childItems instanceof Array){var i=[];e.childItems.forEach(function(e,r){i.push(o._convertContributedMenuToPivotAction(e,t,n+"."+r.toString()))}),r.children=i}return r},e}();t.ContributedPivotBarActionProvider.ContributedPivotBarActionProvider=n}(),function(e){function o(e,t,n){var o={id:t.id||t.itemKey||"",text:t.text||t.name||"",itemKey:t.itemKey,groupKey:t.groupKey,order:t.order,render:n,hidden:t.hidden,iconProps:t.iconProps};if(t.routeId){var r=e.getService("IVssLocationService");o.url=r.routeUrl(t.routeId,t.routeValues)}return t.fpsRequired&&(o.onBeforePivotChange=function(t,n,o){return!o||(v.FastPageSwitch(e,o,!0),t&&t.preventDefault(),!1)}),o}t.ContributedPivotBarItemProvider={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedPivotBarItemProvider.createPivotBarItem=o;var r=function(){function e(e){this._pageContext=e.pageContext,e.tabGroupIds?this._tabGroupIds=e.tabGroupIds:e.contributions&&(this._contributions=e.contributions),this._tabType=e.tabType||"ms.vss-web.tab",this._getContext=e.getContext,this._additionalProps=e.props,this._dependencies=e.dependencies||[],this._loadingComponent=e.loadingComponent,this._getMutatedPivotBarItem=e.getMutatedPivotBarItem,this._loadedPivots=[]}return e.prototype.loadItems=function(e){for(var t=this,n=this._pageContext.getService("IVssContributionService"),o=[],r=0,i=this._getContributions(n);r<i.length;r++){var s=i[r],a=s.id,p=s.pivotContribution;if(p&&(this._getMutatedPivotBarItem&&(p=this._getMutatedPivotBarItem(s,p)),p)){var d=this._getRenderMethod(p,a);if(d){var c=this._makeContributedPivotBarItem(p,a,d);-1===this._loadedPivots.indexOf(c.id)&&(this._loadedPivots.push(c.id),o.push(c))}else console.warn("Cannot render contributed pivot "+a+".")}}o.length>0&&e(o);var u=[];(this._tabGroupIds||[]).forEach(function(e){u=u.concat(n.getContributionChildren(e,"ms.vss-web.tab-provider")||[])}),u.forEach(function(o){n.getService(o).then(function(n){if(n){var r=t._getContext?t._getContext(o,!0):void 0;n.loadItems(function(n){for(var o=[],r=0,i=n;r<i.length;r++){var s=i[r];-1===t._loadedPivots.indexOf(s.id)&&(t._loadedPivots.push(s.id),o.push(s))}o.length>0&&e(o)},r)}})})},e.prototype._getContributions=function(e){return this._tabGroupIds?this._queryContributions(e):this._contributions?this._contributions:[]},e.prototype._queryContributions=function(e){for(var t=[],n=0,o=this._tabGroupIds;n<o.length;n++){var r=o[n],i=e.getContributionChildren(r,this._tabType);if(i){var s=i.map(function(t){return{id:t,pivotContribution:e.getContribution(t)}}).filter(function(e){return!!e.pivotContribution});s.length>0&&t.push.apply(t,s)}}return t},e.prototype._makeContributedPivotBarItem=function(e,t,n){var r=o(this._pageContext,e,n);return r.id=t,r.sourceContribution=Object.assign({id:t},e),r},e.prototype._getRenderMethod=function(e,t){var n=this,o=e.moduleContent;if(o)return e.fpsRequired?function(e){return n._renderExternalHub(o,e)}:function(t){return n._renderByContributionId(o,t,e.dependencies)};if(e.uri&&f.isFeatureEnabled(this._pageContext,"ms.vss-web.ext-nav-new-platform-feature",!1))return function(o){return n._renderExternalContent(e.id||t,o,e.dependencies,e.componentProperties)};if(e.id||e.uri||e.content)return function(o){return n._renderByContributionId(e.id||t,o,e.dependencies)};if(e.componentType){var r=e.componentType;return function(o){return n._renderComponent(e,t,r,o)}}return null},e.prototype._renderComponent=function(e,t,o,r){var i=e.componentProperties?Object.assign({},e.componentProperties):{};return i=Object.assign({},i,this._additionalProps,this._getContext?Object.assign({},this._getContext(t)):{},{className:h.css(i.className,r)}),s.createElement(n.WrappedComponent,{dependencies:this._dependencies.concat(e.dependencies||[]),key:t,wrappedProps:i,wrappedType:o})},e.prototype._renderExternalContent=function(e,t,o,r){return s.createElement(n.WrappedComponent,{dependencies:this._dependencies.concat(o||[]).concat(["ms.vss-web.ext-content"]),key:e,wrappedType:"ExternalContent",wrappedProps:Object.assign({contributionId:e},r,this._additionalProps,{initialHandshakeData:this._getContext?Object.assign({},this._getContext(e)):{},className:h.css(t,"flex-grow")})})},e.prototype._renderExternalHub=function(e,t){return s.createElement(n.WrappedComponent,{key:e,dependencies:["ms.vss-web.legacy-content","ms.vss-web.legacy-vss-ui-content"],wrappedType:"legacy",wrappedProps:{className:t,componentType:"legacyHubShimComponent",modules:["VSSPreview/Flux/Components/ExternalHubShim"],contributionId:e}})},e.prototype._renderByContributionId=function(e,t,o){var r=void 0;return this._getContext&&(r=this._getContext(e)),s.createElement(n.WrappedComponent,{key:e,dependencies:["ms.vss-web.legacy-content","ms.vss-web.legacy-vss-ui-content"],wrappedType:"legacy",wrappedProps:{componentType:"vssLegacyContributionContentHost",modules:["VSSPreview/Providers/ContentHost"],dependentContributionIds:this._dependencies.concat(o||[]),wrappedProps:{className:t,context:r,contribution:e,loadingComponent:this._loadingComponent},loadingComponent:this._loadingComponent}})},e}();t.ContributedPivotBarItemProvider.ContributedPivotBarItemProvider=r}(),function(e){t.ContributedTabProvider={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var n=e.call(this,void 0)||this;return n.pageContext=t.pageContext,n.tabGroupIds=t.tabGroupIds||[],n.defaultRouteId=t.defaultRouteId,n.updateUrlOnPivotChange=t.updateUrlOnPivotChange,n.additionalProps=t.props||{},n.routeValues=t.routeValues||{},n.providerData=[],n.loadItems(),n}return __extends(t,e),t.prototype.dispose=function(){this.providerData.forEach(function(e){e.provider.unsubscribe(e.processProvider),"function"==typeof e.provider.dispose&&e.provider.dispose()})},t.prototype.loadItems=function(){var e=this,t=this.pageContext.getService("IVssContributionService"),n=this.tabGroupIds,o=[];(n||[]).forEach(function(e){o=o.concat(t.getContributionChildren(e,"ms.vss-web.tab-provider")||[])});var r=t.getContributionChildren(n[0],"ms.vss-web.tab"),i=r.map(function(e){var n=t.getContribution(e);return n.id?n:Object.assign({},n,{id:e})});i.forEach(function(t,n){if(t){var o=r[n];t.render=function(){return s.createElement(E.ContributedContentComponent,{key:o,className:"flex-grow",contributionId:o,contribution:t,dependencies:t.dependencies,componentProperties:e.additionalProps})},e.addAdditionalProperties(t,o)}});var a=[];if(o&&o.length>0){for(var p=0,d=o;p<d.length;p++){var c,u=d[p];(c=t.getServiceSync(u,!0))?(this.processContributedService(u,c),i.push.apply(i,c.value)):a.push(u)}if(a.length>0)for(var m=function(n){t.getService(n).then(function(t){t&&(e.processContributedService(n,t),e.push.apply(e,t.value))})},l=0,h=a;l<h.length;l++){m(h[l])}}this.push.apply(this,i)},t.prototype.processContributedService=function(e,t){for(var n=this,o={contributionId:e,provider:t,processProvider:function(t){if(t.addedItems){for(var o=0,r=t.addedItems;o<r.length;o++){var i=r[o];n.addAdditionalProperties(i,e)}n.push.apply(n,t.addedItems)}}},r=0,i=t.value;r<i.length;r++){var s=i[r];this.addAdditionalProperties(s,e)}o.provider.subscribe(o.processProvider),this.providerData.push(o)},t.prototype.addAdditionalProperties=function(e,t){var n=this;if(e.routeId){var o=this.pageContext.getService("IVssLocationService");e.url=o.routeUrl(e.routeId,Object.assign({},this.routeValues,e.routeValues))}else if(this.defaultRouteId){o=this.pageContext.getService("IVssLocationService");e.url=o.routeUrl(this.defaultRouteId,{contributionId:t})}e.fpsRequired?e.onBeforeTabChange=function(e,t,o){return!o||(v.FastPageSwitch(n.pageContext,o,!0),e&&e.preventDefault(),!1)}:e.url&&this.updateUrlOnPivotChange&&(e.onBeforeTabChange=function(t,o,r){return n.pageContext.getService("IVssHistoryService").pushState(void 0,e.url&&a.ObservableLike.getValue(e.url)),!0})},t}(a.ObservableArray);t.ContributedTabProvider.ContributedTabProvider=n}(),function(e){w=t.FPSLinkFPSLink={},Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.apply(this,arguments)||this;return t.onClick=function(e){if(t.props.onClick&&t.props.onClick(e),!e.isDefaultPrevented())if(t.props.href&&!1!==t.props.supportsFPS)v.onClickFPS(t.context.pageContext,t.props.href,!0,e,{telemetrySource:t.props.telemetrySource,telemetryProperties:t.props.telemetryProperties,navigationId:t.props.navigationId});else if(t.props.telemetrySource){t.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","Link",Object.assign({},t.props.telemetryProperties||{},{source:t.props.telemetrySource}))}},t}return __extends(t,e),t.prototype.render=function(){var e=Object.assign({},this.props,{onClick:this.onClick});return s.createElement(y.Link,Object.assign({},e))},t}(n.VssComponent);t.FPSLinkFPSLink.FPSLink=o}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(n){for(var o in n)t[e].hasOwnProperty(o)||(t[e][o]=n[o])}(w)}("FPSLink")},["Resources","AssetResolver/AssetResolver","AssetResolver/index","AssetResolver","ContributedIconUtil","ContributedMenuItemProvider","ResponsiveLayout/ResponsiveLayout","ResponsiveLayout","CommandBar/CommandBarFlyout","CommandBar/CommandBar","CommandBar","ContributedContentComponent","ContributedPivotBarActionProvider","ContributedPivotBarItemProvider","ContributedTabProvider","FPSLink/FPSLink","FPSLink"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.frame-content"}}));