"use strict";define("Tfs/Header/Components",["require","exports","react","VSS/Features/PlatformUI/ContributedBreadcrumb","VSSUI/Observer","VSS/Platform/Layout","VSSUI/Breadcrumb","VSSUI/Spinner","VSSUI/Callout","VSS/Platform/Context","VSS/Platform/FPS","VSS/Legacy/Legacy"],function(e,t,o,n,r,a,i,s,c,d,u,l){var p;p=t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.KeyboardShortcuts="Keyboard shortcuts",t.Resources.Loading="Loading...",t.Resources.MoreApplications="More",t.Resources.Marketplace="Marketplace",t.Resources.AppSwitcherHomeLink="Home",function(e){t.ComponentsHeaderBreadcrumbHeaderBreadcrumb={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,o){var r=e.call(this,t,o)||this;return r.onSearchExpanded=function(){r.setState({isVisible:!1})},r.onSearchCollapsed=function(){r.setState({isVisible:!0})},r.onExtraContentSelectionChanged=function(e){r.setState({extraContentSelected:e})},r.onFocusLost=function(){r.setState({extraContentSelected:!1})},r.onFocus=function(){r.setState({extraContentSelected:!0})},r._breadcrumbItemProvider=n.getBreadcrumbItems(r.context.pageContext,"ms.vss-tfs-web.vertical-header-breadcrumb"),r.state={isVisible:!0,breadcrumbItems:r._breadcrumbItemProvider,extraContentSelected:!1},r}return __extends(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.context.pageContext.getService("IVssPerformanceService").endScenario("tfs","WebPlatform.Frame",!1),this.addEventListener(window,"searchExpanded",this.onSearchExpanded),this.addEventListener(window,"searchCollapsed",this.onSearchCollapsed)},t.prototype.render=function(){if(!this.state.isVisible)return o.createElement("div",{className:"flex-grow"});var e=o.createElement(a.RegionComponent,{className:"flex-row",componentRegion:"headerBreadcrumb",childComponentProperties:{selected:this.state.extraContentSelected,onFocusLost:this.onFocusLost,onFocus:this.onFocus}});return o.createElement(r.Observer,{items:this.state.breadcrumbItems},o.createElement(i.Breadcrumb,{excludeTabStop:!0,className:"header-breadcrumb flex-grow",extraContent:e,onExtraContentSelectionChanged:this.onExtraContentSelectionChanged,extraContentSelected:this.state.extraContentSelected}))},t}(a.VssComponent);s.componentType="headerBreadcrumb",a.VssComponent.register(s.componentType,s)}(),function(e){t.ComponentsFpsLoadingFpsLoading={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(o){var n=e.call(this,o)||this;return n.onFpsLoading=function(e){n.lastLoadingEvent=e.detail,n.loadingDelayTimeout||(n.loadingDelayTimeout=n.setTimeout(function(){n.setState({showLoadingIndicator:!0}),n.loadingDelayTimeout=0},t.preProgressDelay))},n.onFpsCompleted=function(e){n.lastLoadingEvent&&n.lastLoadingEvent.data===e.detail.data&&(n.lastLoadingEvent=void 0,n.loadingDelayTimeout&&n.clearTimeout(n.loadingDelayTimeout),n.state.showLoadingIndicator&&n.setState({showLoadingIndicator:!1}))},n.state={},n}return __extends(t,e),t.prototype.render=function(){return this.state.showLoadingIndicator?o.createElement(c.Callout,{className:"fps-loading-content-layer",contentClassName:"fps-loading-content fontSizeM",contentLocation:1,contentJustification:1,contentOrientation:0,modal:!0},o.createElement(s.Spinner,{label:p.Loading,size:"large"})):null},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.addEventListener(document.body,"fpsLoading",this.onFpsLoading),this.addEventListener(document.body,"fpsCompleted",this.onFpsCompleted)},t}(a.VssComponent);n.preProgressDelay=500,t.ComponentsFpsLoadingFpsLoading.FpsLoadingComponent=n,a.VssComponent.register("fpsLoading",n)}(),function(e){t.HeaderBreadcrumbService={},Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.apply(this,arguments)||this;return t._onFPSItemClick=function(e,o,n){u.onClickFPS(t.pageContext,o,!0,e,{telemetrySource:"headerBreadcrumb",navigationId:n})},t}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t),this.loadItems()},t.prototype.loadItems=function(){this._addCollectionItem(),this._addProjectItem(),this._addHubItems()},t.prototype._addCollectionItem=function(){var e=this.pageContext.getService("IVssPageService").getData();e&&this.push({key:"Collection",text:e.hostName,href:e.hostPath,rank:10})},t.prototype._addProjectItem=function(){var e=this,t=this.pageContext.getService("ITfsPageService").getData();if(t&&t.project){var o=t.project.url;this.push({key:"Project",text:t.project.name,href:o,onClick:function(t){e._onFPSItemClick(t,o||"","ms.vss-web.home-hub-group")},rank:20})}},t.prototype._addHubItems=function(){var e=this,t=this.pageContext.getService("IVssNavigationService"),o=t.getDisplayedNavigation(),n=t.getNavigation(o[2]),r=t.getNavigation(o[3]);void 0!==n&&n.name&&this.push({key:"HubGroup",text:n.name,href:n.href,onClick:function(t){e._onFPSItemClick(t,n.href||"",n.id)},rank:30}),void 0!==r&&r.parentId&&r.name&&this.push({key:"Hub",text:r.name,href:r.href,onClick:function(t){e._onFPSItemClick(t,r.href||"",r.id)},rank:40})},t}(d.VssObservableArrayService);d.Services.add("header-breadcrumb-service",{serviceFactory:o})}(),function(e){t.LegacyProfileDialogService={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.show=function(){this.pageContext.getService("IVssLayoutManager").renderCallout(function(e){return o.createElement(a.WrappedComponent,{wrappedType:"legacy",dependencies:["ms.vss-web.legacy-content"],wrappedProps:{componentType:"legacyProfileDialog",modules:["Admin/Scripts/LegacyProfileDialogComponent"]}},null)})},t}(d.VssService);d.Services.add("LegacyProfileDialogService",{serviceFactory:n})}(),function(e){t.ShortcutMenuProvider={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){var t=e.apply(this,arguments)||this;return t.menuItems=[],t.getMenuItems=function(){return t.menuItems},t}return __extends(t,e),t.prototype._serviceStart=function(t){var o=this;e.prototype._serviceStart.call(this,t);var n=this.pageContext.getService("ITfsPageService").getData();this._shortcutsAvailable=!!n&&!!n.project,this._shortcutsAvailable&&this.menuItems.push({id:"tfsShortcutKeys",text:p.KeyboardShortcuts,rank:550,groupKey:"other-actions",onActivate:function(){o.showDialog()}})},t.prototype.showDialog=function(){this.pageContext.getService("IVssLayoutManager").renderCallout(function(e){var t={modules:["VSS/Controls/KeyboardShortcuts"],wrappedType:"shortcutDialog",wrappedProps:{onDismiss:e}};return o.createElement(l.LegacyComponent,t)})},t}(d.VssService);t.ShortcutMenuProvider.ShortcutMenuProviderService=n,d.Services.add("ms.vss-tfs-web.shortcut-menu-provider",{serviceFactory:n})}()},["Resources","Components/HeaderBreadcrumb/HeaderBreadcrumb","Components/FpsLoading/FpsLoading","HeaderBreadcrumbService","LegacyProfileDialogService","ShortcutMenuProvider"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.header-async-content"}}));