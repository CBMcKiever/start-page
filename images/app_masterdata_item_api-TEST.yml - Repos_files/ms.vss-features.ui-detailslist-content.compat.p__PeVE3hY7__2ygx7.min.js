"use strict";define("VSSUI",["require","exports","react","OfficeFabric/DetailsList","OfficeFabric/Utilities","OfficeFabric/FocusZone","OfficeFabric/Selection"],function(e,t,s,n,i,o,r){var l,a,c,p,d,u,m,h,v;!function(e){l=t.ComponentsVssDetailsListVssDetailsList={},Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function i(s){var i=e.call(this,s)||this;return i.standardPresentationStyle=127,i._onItemContextMenu=function(e,s,n){var o=n;if(o){var r=o.target;if(r&&("A"===r.nodeName||t.UtilitiesInternal.closest(r,"A")))return!0}if(i.props.shouldDisplayActions&&!i.props.shouldDisplayActions(e))return!0;if(!o)return i.setState({activatedItem:e,target:void 0});var l=null;if(0===o.button||!(o.clientX>0&&o.clientY>0)){var a=o.target,c=t.UtilitiesInternal.closest(a,'[role="row"]');l=c?c.querySelector("."+t.ComponentsContextualMenuButtonContextualMenuButton.ContextualMenuButton.ButtonContainerClassName):null}i.setState({activatedItem:e,target:l||o})},i._onDismiss=function(){i.setState({activatedItem:void 0,target:void 0})},i._onEllipsisClick=function(e){var t=Number(e.currentTarget.dataset.index),s=i.props.selectionMode===n.SelectionMode.multiple,o=i.state.selection;o.setChangeEvents(!1);var r=e.ctrlKey||e.metaKey;if(s&&e.shiftKey){var l=!r;o.selectToIndex(t,l)}else if(s){!o.isIndexSelected(t)&&!r&&o.setAllSelected(!1),o.setIndexSelected(t,!0,!0)}else o.setAllSelected(!1),o.setIndexSelected(t,!0,!0);o.setChangeEvents(!0)},i.state={},i}return __extends(i,e),i.prototype.componentWillMount=function(){var e=this._buildClassNames(this.props),t=this._buildColumns(this.props),s=this._buildSelection(this.props);this.overrideSelectedIndex=!1,this.setState({classNames:e,columns:t,selection:s})},i.prototype.componentDidMount=function(){this.overrideSelectedIndex=!0},i.prototype.componentWillReceiveProps=function(e){var t={};this.props.className===e.className&&this.props.presentationStyles===e.presentationStyles&&this.props.usePresentationStyles===e.usePresentationStyles&&this.props.rowStyle===e.rowStyle||(t.classNames=this._buildClassNames(e)),this.props.columns===e.columns&&this.props.actionsColumnKey===e.actionsColumnKey||(t.columns=this._buildColumns(e)),this.props.selection!==e.selection&&(t.selection=this._buildSelection(e)),this.setState(t)},i.prototype.render=function(){var e=this.props.checkboxVisibility,t=void 0===e?n.CheckboxVisibility.hidden:e,i=this.state,o=i.classNames,r=i.columns,l=Object.assign({},this.props),a=this._hasActions(this.props);l.className=o,l.checkboxVisibility=t,l.checkboxCellClassName="vss-DetailsList--cellCheck",l.columns=r,a&&(l.onItemContextMenu=this._onItemContextMenu);var c=s.createElement(n.DetailsList,Object.assign({},l,{initialFocusedIndex:this.overrideSelectedIndex?void 0:l.initialFocusedIndex,selection:this.state.selection,componentRef:this._resolveRef("detailsList")}));return a?s.createElement("div",{className:"vss-DetailsList--contextmenu-wrapper"},c,this._getContextMenu()):c},i.prototype._createActionsColumn=function(e){var n=this,i=Object.assign({},e);return i.onRender=function(i,o,r){var l=null;e.onRender?l=e.onRender(i,o,r):n.props.onRenderItemColumn&&(l=n.props.onRenderItemColumn(i,o,r));var a=!0;return n.props.shouldDisplayActions&&(a=n.props.shouldDisplayActions(i)),a?s.createElement("div",{className:"actions-column-wrapper"},s.createElement("div",{className:"original-content"},l),s.createElement(t.ContextualMenuButton.MoreActionsButton,{allocateSpaceWhileHidden:n.props.allocateSpaceForActionsButtonWhileHidden,className:"vss-DetailsList--contextual-menu-button",getItems:n.props.getMenuItems&&function(){return n.props.getMenuItems(i)},getItemProviders:n.props.getMenuItemProviders&&function(){return n.props.getMenuItemProviders(i)},onDismiss:n._onDismiss,dataIndex:o,onClick:n._onEllipsisClick})):l},i},i.prototype._hasActions=function(e){return!(!e.actionsColumnKey||!e.getMenuItems&&!e.getMenuItemProviders)},i.prototype._buildSelection=function(e){return e.selection||new n.Selection({getKey:e.getKey})},i.prototype._buildColumns=function(e){var t=e.actionsColumnKey,s=e.columns;if(this._hasActions(e)&&s){for(var n=[],i=0,o=s;i<o.length;i++){var r=o[i];r.key===t&&(r=this._createActionsColumn(r)),n.push(r)}return n}return s},i.prototype._buildClassNames=function(e){var s=e.usePresentationStyles,n=e.className,i=e.rowStyle,o=e.hideGroupExpansion,r=e.presentationStyles,l="";if(s||r){void 0===r&&(r=this.standardPresentationStyle);var a=["vss-DetailsList--layout"];n&&a.push(n),1&r&&a.push("hideActionsButton"),2&r&&a.push("singleLine"),4&r&&a.push("flexCellLayout"),8&r&&a.push("paddingInCells"),16&r&&a.push("colors"),32&r&&a.push("linkStyles"),64&r&&a.push("headerRowStyles"),l=a.join(" ")}else l=t.Util.css("vss-DetailsList",n,1===i&&"vss-DetailsList--twoLine");return l=t.Util.css(l,o&&"noGroupExpand")},i.prototype._getContextMenu=function(){var e=this.state,n=e.activatedItem,i=e.target;if(n){var o=this.props,r=o.getMenuItems,l=o.getMenuItemProviders,a=r?r(n):void 0,c=l?l(n):void 0;if(a||c)return s.createElement(t.VssContextualMenu.VssContextualMenu,{items:a,providers:c,onDismiss:this._onDismiss,shouldFocusOnMount:!0,target:i,gapSpace:0})}},i}(i.BaseComponent);t.ComponentsVssDetailsListVssDetailsList.VssDetailsList=o}(),function(e){a=t.ComponentsVssDetailsListVssDetailsListGroupHeader={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.render=function(){var e=this.props,n=e.text,i=e.textCssClassName,r=e.onRenderContent;return s.createElement("div",{className:"vss-DetailsList--groupHeader","data-is-focusable":"true"},s.createElement(o.FocusZone,{direction:o.FocusZoneDirection.horizontal},r?r():s.createElement("div",{className:t.Util.css("vss-DetailsList--groupHeaderText",i)},n)))},n}(i.BaseComponent);t.ComponentsVssDetailsListVssDetailsListGroupHeader.VssDetailsListGroupHeader=n}(),function(e){c=t.ComponentsVssDetailsListVssDetailsListTitleCell={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.render=function(){var e=this.props,n=e.secondaryText,i=e.onRenderSecondaryText,o=e.ariaLabel,r=e.iconProps;return n||i?s.createElement("div",{className:t.Util.css("vss-DetailsList--titleCellTwoLine",!r&&"noIcon"),"aria-label":o},this._renderIcon(),s.createElement("div",{className:"vss-DetailsList--titleCellTwoLineText"},this._renderPrimaryText(),this._renderSecondaryText()),this._renderIndicators()):s.createElement("div",{className:"vss-DetailsList--titleCellOneLine","aria-label":o},this._renderIcon(),this._renderPrimaryText(),this._renderIndicators())},n.prototype._renderPrimaryText=function(){var e=this.props,n=e.primaryText,i=e.primaryAction,o=e.primaryTarget,r=e.disabled,l=e.onRenderPrimaryText,a=this.props.primaryActionRole,c=l?l():i?"function"==typeof i?s.createElement(t.Link.Link,{className:t.Util.css("vss-DetailsList--titleCellText",r&&"disabled"),role:a||"button",href:"#",onClick:i},n):s.createElement(t.Link.Link,{className:t.Util.css("vss-DetailsList--titleCellText",r&&"disabled"),role:a||"link",href:i,target:o},n):s.createElement("span",{className:t.Util.css("vss-DetailsList--titleCellText",r&&"disabled")},n);return s.createElement("div",{className:"vss-DetailsList--titleCellPrimary"},c)},n.prototype._renderSecondaryText=function(){var e=this.props,n=e.secondaryText,i=e.disabled,o=e.onRenderSecondaryText,r=o?o():s.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:n},s.createElement("div",{className:"flex flex-grow text-ellipsis"},s.createElement("span",{className:t.Util.css("vss-DetailsList--titleCellText",i&&"disabled")},n)));return r?s.createElement("div",{className:"vss-DetailsList--titleCellSecondary"},r):null},n.prototype._renderIcon=function(){var e=this.props,n=e.iconProps,i=e.disabled;return n?s.createElement(t.VssIcon.VssIcon,Object.assign({},n,{className:t.Util.css("vss-DetailsList--titleCellIcon",n.className,i&&"disabled",3===n.iconType&&"vss-DetailsList--titleCellIcon--image")})):null},n.prototype._renderIndicators=function(){var e=this.props.indicators?this.props.indicators.map(function(e){return e.getItemIndicator()}):[];return e&&e.length>0?s.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:e}):null},n}(i.BaseComponent);t.ComponentsVssDetailsListVssDetailsListTitleCell.VssDetailsListTitleCell=n}(),function(e){function s(s){for(var n in s)t[e].hasOwnProperty(n)||(t[e][n]=s[n])}p=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),s(l),s(a),s(c)}("ComponentsVssDetailsListindex"),function(e){d=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var n in s)t[e].hasOwnProperty(n)||(t[e][n]=s[n])}(p)}("VssDetailsList"),function(e){u=t.ComponentsTreeTreeList={},Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function n(t){var n=e.call(this,t)||this;return n.newlySelectedItem=void 0,n.onRenderRow=function(e,t){var i=e.item;return i.isExpandable?s.createElement(a,{expanded:i.isExpanded,treeListItem:i,rowProps:e,collapse:n.onCollapse,expand:n.onExpand,onKeyDown:n.props.onRowKeyDown}):t(e)},n.onCollapse=function(e){return!!e.isExpanded&&(n.props.onItemToggled(e),!0)},n.onExpand=function(e){return!e.isExpanded&&(n.props.onItemToggled(e),!0)},n.onSelectionChanged=function(){var e=n.selection.getSelection(),t=[];if(e&&e.length>0){for(var s=0,i=e;s<i.length;s++){var o=i[s];t.push(o.treeItem.item),n.newlySelectedItem=o}n.itemsToSelect=void 0}n.props.onSelectedItemsChanged&&n.props.onSelectedItemsChanged(t)},n.onItemToggled=function(e,t){e.isExpanded?t?n.props.onItemToggled(e):n.canCollapse(e)?n.props.onItemToggled(e):n.newlySelectedItem=void 0:n.props.onItemToggled(e)},n.canCollapse=function(e){return n.selection.mode===r.SelectionMode.none||n.newlySelectedItem!==e},n.selection=new r.Selection({onSelectionChanged:n.onSelectionChanged,selectionMode:t.selectionMode,getKey:function(e){return e.treeItem.id}}),n}return __extends(n,e),n.prototype.setSelectedItemsById=function(e){this.selection.setAllSelected(!1),this.itemsToSelect=e,this.setSelection()},n.prototype.render=function(){var e=this,n=this.props,i=n.className,o=n.treeListItems,r=n.primaryTreeColumnKey,a=n.actionsColumnKey,c=n.onPrimaryCellClick,p=n.getMenuItemProviders,u=n.getMenuItems,m=n.allocateSpaceForActionsButtonWhileHidden,h=n.isHeaderVisible,v=n.initialFocusedIndex,f=n.onItemInvoked,I=n.onRowDidMount,y=n.checkboxVisibility,C=this.props.columns.slice(),g=0;if(void 0!==r)for(var L=0;L<C.length;L++)if(C[L].key===r){g=L;break}var x=C[g].onRender;return C[g]=Object.assign({},C[g],{onRender:function(t,n,i){return s.createElement(l,{onItemToggled:e.onItemToggled,treeListItem:t,index:n,column:i,onColumnRender:x,indentPaddingInPixels:20,onClick:c})}}),s.createElement("div",{role:"treegrid"},s.createElement(d.VssDetailsList,{className:t.Util.css("tree-list",i),isHeaderVisible:h,items:o,initialFocusedIndex:v,columns:C,actionsColumnKey:a,getMenuItems:u,allocateSpaceForActionsButtonWhileHidden:m,getMenuItemProviders:p,onRenderRow:this.onRenderRow,usePresentationStyles:!0,setKey:"0",selection:this.selection,selectionPreservedOnEmptyClick:!0,onRowDidMount:I,onItemInvoked:f,checkboxVisibility:y}))},n.prototype.componentDidUpdate=function(){this.setSelection()},n.prototype.setSelection=function(){if(this.itemsToSelect){for(var e=[],t=0,s=this.itemsToSelect;t<s.length;t++){var n=s[t];this.selection.setKeySelected(n,!0,!1),this.selection.isKeySelected(n)||e.push(n)}0===e.length&&(e=void 0),this.itemsToSelect=e}},n}(i.BaseComponent);t.ComponentsTreeTreeList.TreeList=o;var l=function(e){function n(){var t=e.apply(this,arguments)||this;return t.onExpandCollapseButtonClicked=function(e){e.stopPropagation(),t.props.onItemToggled(t.props.treeListItem,!0)},t.onCellClicked=function(e){t.props.onClick?t.props.onClick(e,t.props.treeListItem.treeItem.item):t.props.onItemToggled(t.props.treeListItem,!1)},t}return __extends(n,e),n.prototype.render=function(){var e=this.props.treeListItem,n=this.props.indentPaddingInPixels*e.indentLevel,i=e.isLoading&&s.createElement(t.Spinner.Spinner,{size:"xsmall",className:"tree-list-spinner"}),o=s.createElement(t.Icon.Icon,{className:t.Util.css("tree-chevron",!e.isExpandable&&"invisible"),iconName:e.isExpanded?"ChevronDownSmall":"ChevronRightSmall",onClick:this.onExpandCollapseButtonClicked});return s.createElement("div",{className:"tree-column-wrapper",onClick:this.onCellClicked,style:{paddingLeft:n+"px"}},i||o,this.props.onColumnRender(this.props.treeListItem,this.props.index,this.props.column))},n}(s.Component),a=function(e){function t(){var t=e.apply(this,arguments)||this;return t.onKeyDown=function(e){39===e.which?t.props.expand(t.props.treeListItem)&&(e.preventDefault(),e.stopPropagation()):37===e.which?null!==t.rowComponent&&null!==t.detailsElement&&document.activeElement!=t.detailsElement?t.rowComponent.focus():t.props.collapse(t.props.treeListItem)&&(e.preventDefault(),e.stopPropagation()):t.props.onKeyDown&&t.props.onKeyDown(e,t.props.rowProps.item.treeItem.item)},t}return __extends(t,e),t.prototype.render=function(){var e=this;return s.createElement("div",{onKeyDown:this.onKeyDown,ref:function(t){e.rowElement=t}},s.createElement(n.DetailsRow,Object.assign({},this.props.rowProps,{"aria-expanded":this.props.expanded,ref:function(t){e.rowComponent=t}})))},t.prototype.componentDidMount=function(){this.detailsElement=null,null!==this.rowElement&&(this.detailsElement=this.rowElement.querySelector("[tabIndex='0']")||this.rowElement.children[0])},t}(s.Component)}(),function(e){m=t.ComponentsTreeTree={},Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var s=e.call(this,t)||this;s.onItemToggled=function(e){if(e.isExpandable){e.isExpanded=!e.isExpanded;var t=s.props.treeItemProvider;if(e.isExpanded)s.buildTree(t,e.treeItem.item),s.forceUpdate();else{for(var n=[],i=void 0,o=0,r=s.state.treeListItems;o<r.length;o++){var l=r[o];l===e?(i=e.indentLevel,n.push(l)):(void 0===i||i>=l.indentLevel)&&(n.push(l),i=void 0)}e.isLoading=!1,s.setState({treeListItems:n})}}},s.childrenMap={};var n=s.props.columns.slice(),i=s.buildColumns(n);return s.state={treeListItems:[],treeListItemColumns:i},s.buildTree(t.treeItemProvider,void 0),s}return __extends(t,e),t.prototype.setSelectedItemsById=function(e){this.treeList&&this.treeList.setSelectedItemsById(e)},t.prototype.componentWillReceiveProps=function(e){if(this.props.columns!==e.columns){var t=e.columns.slice(),s=this.buildColumns(t);this.setState({treeListItemColumns:s})}this.props.treeItemProvider!==e.treeItemProvider&&(this.childrenMap={},this.buildTree(e.treeItemProvider,void 0))},t.prototype.render=function(){var e=this,t=this.state,n=t.treeListItems,i=t.treeListItemColumns;return s.createElement(u.TreeList,Object.assign({},this.props,{componentRef:function(t){return e.treeList=t},treeListItems:n,columns:i,onItemToggled:this.onItemToggled}))},t.prototype.buildColumns=function(e){return e.map(function(e){return Object.assign({},e,{onRender:function(t){return e.onRender(t.treeItem)}})})},t.prototype.buildTree=function(e,t){var s=this,n=Promise.resolve(e.getChildren(t)),i=void 0!==t&&e.getTreeListItem(t);i&&(i.isLoading=!0),n.then(function(n){for(var o=[],r=void 0!==t?i.indentLevel+1:0,l=0,a=n;l<a.length;l++){var c=a[l];o.push(s.addTreeItems(e,c,r))}Promise.all(o).then(function(e){var n=[].concat.apply([],e),o=[];if(void 0===t)o=n;else for(var r=0,l=s.state.treeListItems;r<l.length;r++){var a=l[r];o.push(a),t===a.treeItem.item&&(o=o.concat(n))}(!i||i&&i.isExpanded&&i.isLoading)&&(i&&(i.isLoading=!1),s.setState({treeListItems:o}))})})},t.prototype.addTreeItems=function(e,t,s){var n=this,i=[],o=this.getOrCreateTreeListItem(e,t,s);if(i.push(o),o.isExpanded){var r=this.childrenMap[o.treeItem.id];return void 0!==r?(o.isLoading=!1,Promise.resolve(r)):Promise.resolve(e.getChildren(t)).then(function(t){for(var r=[],l=0,a=t;l<a.length;l++){var c=a[l];r.push(n.addTreeItems(e,c,s+1))}return Promise.all(r).then(function(e){var t=[].concat.apply(i,e);return n.childrenMap[o.treeItem.id]=t,t})})}return Promise.resolve(i)},t.prototype.getOrCreateTreeListItem=function(e,t,s){var n=e.getTreeListItem(t);if(!n){var i=e.getTreeItem(t);n={treeItem:i,indentLevel:s,isExpandable:i.isExpandable,isExpanded:!!i.defaultIsExpanded,isLoading:!1},e.setTreeListItem(t,n)}return n},t}(i.BaseComponent);t.ComponentsTreeTree.Tree=n}(),function(e){h=t.ComponentsTreeTreeItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){this.treeListItemMap=new Map}return e.prototype.setTreeListItem=function(e,t){this.treeListItemMap.set(e,t)},e.prototype.getTreeListItem=function(e){return this.treeListItemMap.get(e)},e}();t.ComponentsTreeTreeItemProvider.TreeItemProvider=s}(),function(e){function s(s){for(var n in s)t[e].hasOwnProperty(n)||(t[e][n]=s[n])}v=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),s(m),s(h),s(u)}("ComponentsTreeindex"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var n in s)t[e].hasOwnProperty(n)||(t[e][n]=s[n])}(v)}("Tree")},["Components/VssDetailsList/VssDetailsList","Components/VssDetailsList/VssDetailsListGroupHeader","Components/VssDetailsList/VssDetailsListTitleCell","Components/VssDetailsList/index","VssDetailsList","Components/Tree/TreeList","Components/Tree/Tree","Components/Tree/TreeItemProvider","Components/Tree/index","Tree"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-detailslist-content"}}));