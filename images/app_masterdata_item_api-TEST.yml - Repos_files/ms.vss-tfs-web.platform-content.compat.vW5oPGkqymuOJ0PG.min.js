"use strict";define("Tfs/Platform",["require","exports","react","VSS/Platform/Layout","VSSUI/Button","VSSUI/Link","VSS/Features/PlatformUI/ContributedTab","VSSUI/Tabs","VSS/Core/Observable","VSS/Platform/Context","VSS/Platform/Feature","VSS/Platform/Util/Cookie","VSS/Platform/UserClaims","VSS/Platform/Util/Storage","VSS/Core/Util/String","VSS/Platform/Location","VSS/Platform/FPS","VSSUI/VssPersona","VSS/Platform/RestClientBase"],function(e,t,r,i,o,n,s,a,u,c,p,d,l,v,g,f,h,m,_){var b,S;b=t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.ManageUserSettings="Manage the currently logged in user settings",t.Resources.MoreMenu="More ...",t.Resources.Pin="Pin",t.Resources.RecentProjectTeams="Recent project/teams",t.Resources.Unpin="Unpin",t.Resources.UnpinnedItems="Unpinned items",t.Resources.DocumentTitle="{0} - {1}",t.Resources.ApplicationTitleHosted="Azure DevOps Services",t.Resources.ApplicationTitleOnPrem="Azure DevOps Server",t.Resources.DevSuite="Dev Suite",t.Resources.Favorites="Favorites",t.Resources.Create="Create",t.Resources.Help="Help",t.Resources.Settings="Settings",t.Resources.ProjectSettings="Project settings",t.Resources.ShowDetails="Show more information",t.Resources.HideDetails="Show less information",t.Resources.ShowFavorites="Show favorites",t.Resources.ShowCreate="Show commonly created items",t.Resources.ShowApplications="Switch to another application",t.Resources.ProjectsAndTeams="Projects & teams",t.Resources.HeaderProjectNameFormat="{0} / {1}",t.Resources.Navigation_Site="Website",t.Resources.Dashboards="Dashboards",t.Resources.Wiki="Wiki",t.Resources.More="More",t.Resources.BrandName="Azure",t.Resources.ProductName="DevOps",t.Resources.BrandWithProductName="Azure DevOps",t.Resources.SuiteNameOnPrem="DevOps",t.Resources.SuiteName="VSTS",t.Resources.MarketPlace="Marketplace",t.Resources.Overview="Overview",t.Resources.UnhandledErrorTitle="An unexpected error has occurred within this region of the page.",t.Resources.UnhandledErrorMessage="You can try reloading this component or refreshing the entire page.",t.Resources.RefreshPageText="Refresh page",t.Resources.ReloadComponentText="Reload component",t.Resources.ShowMoreInfoText="Show more info",t.Resources.SuiteLogoLabel="Azure DevOps organization home page",t.Resources.SuiteLogoLabelOnPrem="Azure DevOps collection home page",t.Resources.Error="Error",t.Resources.Stack="Stack",function(e){t.HeaderActions={},Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderActions.getHeaderActionData=function(e){return e.getService("IVssContributionService").getData("ms.vss-tfs-web.header-action-data")}}(),t.Constants={},Object.defineProperty(t,"__esModule",{value:!0}),(t.Constants.WebPlatformFeatureFlags||(t.Constants.WebPlatformFeatureFlags={})).UseNewBranding="VisualStudio.Services.WebPlatform.UseNewBranding",(S=t.Constants.ClassNames||(t.Constants.ClassNames={})).MainCommandLink="suite-logo",S.NavigationProfileMenu="navigation-profile-menu",function(e){t.ErrorHandling={},Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var r=e.call(this,t)||this;return r.state={hideInfo:!0},r}return __extends(t,e),t.prototype.render=function(){var e=this;return r.createElement("div",{className:"flex flex-column tfs-unhandled-error"},r.createElement("div",{className:"tfs-unhandled-error--title"},b.UnhandledErrorTitle),r.createElement("div",null,b.UnhandledErrorMessage),r.createElement("div",{className:"tfs-unhandled-error--buttons flex flex-noshrink justify-start"},r.createElement(o.Button,{primary:!0,onClick:function(){window.location.reload()}},b.RefreshPageText),r.createElement(o.Button,{onClick:function(){e.props.reloadComponent()}},b.ReloadComponentText)),r.createElement("div",{className:"tfs-unhandled-error--moreInfo"},this.state.hideInfo?r.createElement(n.Link,{onClick:function(t){e.setState({hideInfo:!1}),t.preventDefault()}},b.ShowMoreInfoText):r.createElement("div",null,r.createElement("div",{className:"tfs-unhandled-error--title"},b.Error,": ",this.props.error.message),r.createElement("div",{className:"tfs-unhandled-error--stack"},r.createElement("div",{className:"tfs-unhandled-error--title"},b.Stack),this.props.errorInfo.componentStack.trim()))))},t}(i.VssComponent);i.Components.add("tfs.page-error-handler",s)}(),function(e){t.MyWorkFlyout={},Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(r,i){var o=e.call(this,r,i)||this;if(o._onTabClicked=function(e){var r;t._defaultTabKey=e,o.context.pageContext.getService("ISettingsService").setEntries(((r={})[t.DefaultPivotStorageKey]=e,r),0),o._selectedTabId.value=e},o._tabs=s.getTabs(i.pageContext,"ms.vss-tfs-web.my-work-pivot"),!t._defaultTabKey){var n=i.pageContext.getService("ISettingsService");t._defaultTabKey=n.getEntry(t.DefaultPivotStorageKey,0)}return o._selectedTabId=new u.ObservableValue(t._defaultTabKey||"work-items"),o}return __extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:i.css("flex-column flex-grow scroll-hidden",this.props.className)},r.createElement(a.TabProvider,{selectedTabId:this._selectedTabId,providers:this._tabs},r.createElement(a.TabBar,{className:"flyout-my-work-tabs",onSelectedTabChanged:this._onTabClicked,disableSticky:!0}),r.createElement(a.TabContent,null)))},t}(i.VssComponent);o.componentType="vertical-header-my-work-flyout",o.DefaultPivotStorageKey="navigation/myworkdefaultpivot",i.VssComponent.register(o.componentType,o)}(),function(e){t.NavigationSettings={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t);var r=t.getService("IVssContributionService");this._prefs=r.getData("ms.vss-tfs-web.navigation-settings-data-provider")||{},this._prefs.user||(this._prefs.user={})},t.prototype.setUserSetting=function(e,t){this._prefs.user[e]=t;var r={};return r["Navigation/"+e]=t,this.pageContext.getService("ISettingsService").setEntries(r,0)},t.prototype.getUserSetting=function(e,t){var r=this._prefs.user[e];return null!=r?r:t},t}(c.VssService);c.Services.add("ITfsNavigationSettingsService",{serviceFactory:r})}(),function(e){t.Page={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=e.apply(this,arguments)||this;return t.addTelemetryProperties=function(e){var r=t.getData();r&&r.project&&(e.properties.dataspaceId=r.project.id,e.properties.dataspaceType="Project",e.properties.dataspaceVisibility=r.project.visibility.toString(),e.properties.navigationMode=p.isFeatureEnabled(t.pageContext,"ms.vss-tfs-web.vertical-navigation",!1)?"vertical":"horizontal")},t}return __extends(t,e),t.prototype._serviceStart=function(t){var r=this;e.prototype._serviceStart.call(this,t);var i=t.getService("IVssTelemetryService");i.subscribe(this.addTelemetryProperties,"publish"),this._removeSubscriptions=function(){i.unsubscribe(r.addTelemetryProperties,"publish")}},t.prototype._serviceEnd=function(t){this._removeSubscriptions(),e.prototype._serviceEnd.call(this,t)},t.prototype.getData=function(){return this.pageContext.getService("IVssContributionService").getData("ms.vss-tfs-web.page-data")},t.prototype.getHorizontalNavigationTeamData=function(){return this.pageContext.getService("IVssContributionService").getData("ms.vss-tfs-web.team-context-data-provider")},t}(c.VssService);c.Services.add("ITfsPageService",{serviceFactory:r,options:4});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getProject=function(){var e=this.pageContext.getService("ITfsPageService").getData();return e&&e.project?{id:e.project.id,name:e.project.name}:void 0},t}(c.VssService);c.Services.add("ms.vss-tfs-web.tfs-page-data-service",{serviceFactory:i,options:1}),t.Page.getTFSPageData=function(e){var t=e.getService("ITfsPageService");if(t)return t.getData()}}(),function(e){var r;t.Navigation={},Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.navigationElementModified="navigationElementModified"}(r=t.Navigation.TfsNavigationServiceEventNames||(t.Navigation.TfsNavigationServiceEventNames={}));var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._serviceStart=function(t){e.prototype._serviceStart.call(this,t),this.navigationService=t.getService("IVssNavigationService");var r=t.getService("ITfsNavigationSettingsService");this.pinningPreferences=r.getUserSetting("PinningPreferences")||{},this.pinningPreferences.pinnedHubGroupIds||(this.pinningPreferences.pinnedHubGroupIds=[]),this.pinningPreferences.unpinnedHubGroupIds||(this.pinningPreferences.unpinnedHubGroupIds=[]),this.pinningPreferences.pinnedHubs||(this.pinningPreferences.pinnedHubs={}),this.pinningPreferences.unpinnedHubs||(this.pinningPreferences.unpinnedHubs={});var i=p.isFeatureEnabled(this.pageContext,"ms.vss-tfs-web.vertical-navigation",!1),o=t.getService("IVssNavigationService"),n=o.getDisplayedNavigation();if(i&&n.length>3){var s=n[2],a=o.getNavigation(s);a&&a.name&&(this.titleSuffix=a.name)}if(!this.titleSuffix){var u=this.pageContext.getService("IVssPageService").getData();this.titleSuffix=u&&u.isHosted?b.ApplicationTitleHosted:b.ApplicationTitleOnPrem}var c=o.getPageTitle();if(c&&this.setPageTitle(c),n.length>3){var d=o.getNavigation(n[3]);d&&0==(32&d.flags)&&this.setMostRecentHubForHubGroup(n[2],n[3])}},t.prototype.getMostRecentHubForHubGroup=function(e){var t,r=v.tryGetLocalStorageValue("lastHub/"+e.id,null);return r&&e.children&&(t=e.children.filter(function(e){return e.id===r})[0],"ms.vss-dashboards-web.dashboards-hub"===r&&(t=this.navigationService.getNavigation(r))),t},t.prototype.isNavigationPinned=function(e){var t=this.navigationService.getNavigation(e);if(t){if(t.children&&t.children.length>0)return-1===this.pinningPreferences.unpinnedHubGroupIds.indexOf(e);if(t.parentId)return-1===(this.pinningPreferences.unpinnedHubs[t.parentId]||[]).indexOf(e)}return!0},t.prototype.navigationsPinnable=function(){return void 0===this.userCanPin&&(this.userCanPin=l.userHasClaim(this.pageContext,"member")),this.userCanPin},t.prototype.setMostRecentHubForHubGroup=function(e,t){v.trySetLocalStorageValue("lastHub/"+e,t)},t.prototype.setPageTitle=function(e){document.title=g.format(b.DocumentTitle,e,this.titleSuffix)},t.prototype.updatePinnedState=function(e,t){var i=this.navigationService.getNavigation(e);if(i){if(i.children&&i.children.length>0)-1!==this.pinningPreferences.unpinnedHubGroupIds.indexOf(e)?(this.pinningPreferences.pinnedHubGroupIds.push(e),this._remove(this.pinningPreferences.unpinnedHubGroupIds,e)):(this.pinningPreferences.unpinnedHubGroupIds.push(e),this._remove(this.pinningPreferences.pinnedHubGroupIds,e));else if(i.parentId){var o=this.pinningPreferences.pinnedHubs[i.parentId];o||(o=[],this.pinningPreferences.pinnedHubs[i.parentId]=o);var n=this.pinningPreferences.unpinnedHubs[i.parentId];n||(n=[],this.pinningPreferences.unpinnedHubs[i.parentId]=n),t?(o.push(e),this._remove(n,e)):(this._remove(o,e),n.push(e))}this.pageContext.getService("ITfsNavigationSettingsService").setUserSetting("PinningPreferences",this.pinningPreferences),this._notify({updatedNavigation:i},r.navigationElementModified)}},t.prototype._remove=function(e,t){var r=e.indexOf(t);return r>=0&&e.splice(r,1),r>=0},t.prototype.getNavigationDisplayMode=function(){if(void 0===this.navigationDisplayMode){var e=void 0;if(l.userHasClaim(this.pageContext,"member"))e=this.pageContext.getService("ISettingsService").getEntry("navigation/verticalMenuExpanded",0);if(void 0===e){var t=d.getCookie("vmExpanded");t&&t.length>0&&(e=Number.parseInt(t))}this.navigationDisplayMode=new u.ObservableValue(e||2)}return this.navigationDisplayMode},t.prototype.setNavigationDisplayMode=function(e){(this.navigationDisplayMode?this.navigationDisplayMode.value=e:this.navigationDisplayMode=new u.ObservableValue(e),l.userHasClaim(this.pageContext,"member"))?this.pageContext.getService("ISettingsService").setEntries({"navigation/verticalMenuExpanded":e},0):d.setCookie("vmExpanded",e.toString());this._notify(e,"displayModeChanged")},t.prototype.navigateToNavElement=function(e){var t=this.pageContext.getService("IVssNavigationService").getNavigation(e);t&&t.href&&h.FastPageSwitch(this.pageContext,t.href,!0)},t.prototype.navigateToRoute=function(e,t){var r={};if(t){var i=this.pageContext.getService("ITfsPageService").getData();i&&i.project&&(r.project=i.project.name)}var o=f.routeUrl(this.pageContext,e,r);o&&h.FastPageSwitch(this.pageContext,o,!0)},t.prototype.navigateToHome=function(){var e=p.isFeatureEnabled(this.pageContext,"ms.vss-tfs-web.vertical-navigation")?"ms.vss-tfs-web.suite-me-page-route":"ms.vss-tfs-web.collection-project-hub-route";this.navigateToRoute(e)},t}(c.VssObservableService);c.Services.add("ITfsNavigationService",{serviceFactory:i,options:4}),t.Navigation.isNavigationItemBuiltinOrTrusted=function(e){return void 0!==e.flags&&(1==(1&e.flags)||2==(2&e.flags))&&32!=(32&e.flags)}}(),function(e){t.ProductFeatures={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getProduct=function(e){var t=this.pageContext.getService("IVssContributionService").getData("ms.vss-tfs-web.product-features-data-provider");return t&&t.features?t.features[e]:void 0},t}(c.VssService);c.Services.add("ITfsProductFeaturesService",{serviceFactory:r})}(),function(e){t.ProjectPersona={},Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=e.displayName,i=e.size,o={getDisplayName:function(){return t},getIdentityImageUrl:function(e){}};return r.createElement(m.VssPersona,{cssClass:"project-persona flex-noshrink",size:i,identityDetailsProvider:o})},t}(r.Component);t.ProjectPersona.ProjectPersona=i}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.removeProjectAvatar=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"_apis/projects/{projectId}/avatar",routeValues:{projectId:e}})]})})},t.prototype.setProjectAvatar=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.1",method:"PUT",routeTemplate:"_apis/projects/{projectId}/avatar",routeValues:{projectId:t},body:e})]})})},t.prototype.createConnectedService=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:t},body:e})]})})},t.prototype.getConnectedServiceDetails=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:e,name:t}})]})})},t.prototype.getConnectedServices=function(e,t){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(i){return r={kind:t},[2,this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:e},queryParams:r})]})})},t.prototype.createIdentityMru=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t},body:e})]})})},t.prototype.deleteIdentityMru=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t}})]})})},t.prototype.getIdentityMru=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:e}})]})})},t.prototype.updateIdentityMru=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t},body:e})]})})},t.prototype.getTeamMembersWithExtendedProperties=function(e,t,r,i){return __awaiter(this,void 0,void 0,function(){var o;return __generator(this,function(n){return o={$top:r,$skip:i},[2,this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/projects/{projectId}/teams/{teamId}/members",routeValues:{projectId:e,teamId:t},queryParams:o})]})})},t.prototype.getProcessById=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/process/processes/{*processId}",routeValues:{processId:e}})]})})},t.prototype.getProcesses=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/process/processes/{*processId}"})]})})},t.prototype.getProjectCollection=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/projectCollections/{collectionId}",routeValues:{collectionId:e}})]})})},t.prototype.getProjectCollections=function(e,t){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(i){return r={$top:e,$skip:t},[2,this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/projectCollections/{collectionId}",queryParams:r})]})})},t.prototype.getProjectHistoryEntries=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(r){return t={minRevision:e},[2,this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/projectHistory",queryParams:t})]})})},t.prototype.getProject=function(e,t,r){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(o){return i={includeCapabilities:t,includeHistory:r},[2,this.beginRequest({apiVersion:"5.1-preview.4",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:e},queryParams:i})]})})},t.prototype.getProjects=function(e,t,r,i,o){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(s){return n={stateFilter:e,$top:t,$skip:r,continuationToken:i,getDefaultTeamImageUrl:o},[2,this.beginRequest({apiVersion:"5.1-preview.4",routeTemplate:"_apis/projects/{*projectId}",queryParams:n})]})})},t.prototype.queueCreateProject=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"5.1-preview.4",method:"POST",routeTemplate:"_apis/projects/{*projectId}",body:e})]})})},t.prototype.queueDeleteProject=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"5.1-preview.4",method:"DELETE",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:e}})]})})},t.prototype.updateProject=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.4",method:"PATCH",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:t},body:e})]})})},t.prototype.getProjectProperties=function(e,t){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(i){return r={keys:t&&t.join(",")},[2,this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/projects/{projectId}/properties",routeValues:{projectId:e},queryParams:r})]})})},t.prototype.setProjectProperties=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"_apis/projects/{projectId}/properties",routeValues:{projectId:e},customHeaders:{"Content-Type":"application/json-patch+json"},body:t})]})})},t.prototype.createOrUpdateProxy=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,this.beginRequest({apiVersion:"5.1-preview.2",method:"PUT",routeTemplate:"_apis/proxies",body:e})]})})},t.prototype.deleteProxy=function(e,t){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(i){return r={proxyUrl:e,site:t},[2,this.beginRequest({apiVersion:"5.1-preview.2",method:"DELETE",routeTemplate:"_apis/proxies",queryParams:r})]})})},t.prototype.getProxies=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(r){return t={proxyUrl:e},[2,this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/proxies",queryParams:t})]})})},t.prototype.getAllTeams=function(e,t,r){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(o){return i={$mine:e,$top:t,$skip:r},[2,this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/teams",queryParams:i})]})})},t.prototype.createTeam=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.2",method:"POST",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:t},body:e})]})})},t.prototype.deleteTeam=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.2",method:"DELETE",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e,teamId:t}})]})})},t.prototype.getTeam=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e,teamId:t}})]})})},t.prototype.getTeams=function(e,t,r,i){return __awaiter(this,void 0,void 0,function(){var o;return __generator(this,function(n){return o={$mine:t,$top:r,$skip:i},[2,this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e},queryParams:o})]})})},t.prototype.updateTeam=function(e,t,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return[2,this.beginRequest({apiVersion:"5.1-preview.2",method:"PATCH",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:t,teamId:r},body:e})]})})},t}(_.RestClientBase);t[e].CoreClientName="ICoreRestClient",t[e].getCoreClient=function(r,i){return r.getRestClient(t[e].CoreClientName,i)},c.RestClients.add(t[e].CoreClientName,{factory:r,options:{serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}("RestClientCore"),function(e){t.SearchGlobalSearchCoordinator={},Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){var t=this.pageContext.getService("ITfsPageService"),r=t.getData(),i={searchText:e.queryText};if(r&&r.project){i.project=r.project.name;var o=t.getHorizontalNavigationTeamData();o&&(i.team=o.name)}var n=f.routeUrl(this.pageContext,"ms.vss-work-web.query-search:route",i);return n&&(e.openInNewWindow?window.open(n):h.FastPageSwitch(this.pageContext,n,!0)),Promise.resolve({searchQuery:e,searchResult:new u.ObservableValue(void 0)})},t}(c.VssService);c.Services.add("witsearch-coordinator",{serviceFactory:r});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){var t=this.pageContext.getService("ITfsPageService"),r=t.getData(),i=t.getHorizontalNavigationTeamData(),o="ms.vss-tfs-web.wiki-project-search-provider"===e.providerId||"ms.vss-tfs-web.wiki-collection-search-provider"===e.providerId,n={text:e.queryText,type:e.type},s=this.getSearchRouteId(e.providerId,o,!1);r&&r.project&&(s=this.getSearchRouteId(e.providerId,o,!0),n.project=r.project.name,i&&(n.team=i.name));var a="",c={"ms.vss-wiki-web.wiki-hub-group":"wiki","ms.vss-code-web.code-hub-group":"code","ms.vss-work-web.work-hub-group":"workitems","ms.vss-build-web.build-release-hub-group":"buildrelease","ms.vss-test-web.test-hub-group":"test","ms.vss-tfs-web.project-team-hidden-hub-group":"projects-team","ms.vss-web.home-hub-group":"dashboard","ms.vss-web.project-admin-hub-group":"projects-admin","ms.vss-tfs-web.collection-project-hub-group":"apps-projects","ms.vss-tfs-web.collection-favorites-hub-group":"apps-favorites","ms.vss-tfs-web.collection-work-hub-group":"apps-workitems","ms.vss-tfs-web.collection-pullrequests-hub-group":"apps-pullrequests","ms.vss-tfs-web.collection-rooms-new-account-nav-hub-group":"apps-rooms","ms.vss-tfs-web.collection-users-new-account-nav-hub-group":"apps-users","ms.vss-web.collection-admin-hub-group":"apps-admin"},p=this.pageContext.getService("IVssNavigationService").getDisplayedNavigation(),d=p.length>1&&p[2];if(a=d?c[d]?c[d]:"custom":"search",r&&(i?a+="-Team":r.project?a+="-Project":a+="-Collection"),n.lp=encodeURIComponent(a),!o){var l="";if(e.filters)for(var v in e.filters){var g=e.filters[v];g&&(l+=v+"{"+g[0]+"}")}n.filters=l}var m=f.routeUrl(this.pageContext,s,n)+"";return m&&(e.openInNewWindow?window.open(m):h.FastPageSwitch(this.pageContext,m,!0)),Promise.resolve({searchQuery:e,searchResult:new u.ObservableValue(void 0)})},t.prototype.getSearchRouteId=function(e,t,r){var i=p.isFeatureFlagEnabled(this.pageContext,"WebAccess.Search.EnableNewRoute",!1);return p.isFeatureEnabled(this.pageContext,"ms.vss-search-web.enable-search-lwp",!1)?r?"ms.vss-search-web.project-route":"ms.vss-search-web.collection-route":t?r?i?"ms.vss-search-platform.search-project-route":"ms.vss-search-platform.wikisearch-project-route":i?"ms.vss-search-platform.search-collection-route":"ms.vss-search-platform.wikisearch-collection-route":r?"ms.vss-search-platform.search-project-route":"ms.vss-search-platform.search-collection-route"},t}(c.VssService);c.Services.add("tfssearch-coordinator",{serviceFactory:i})}(),function(e){t.ShortcutService={},Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.openShortcutDialog=function(){this.pageContext.getService("IVssLayoutManager").renderCallout(function(e){return r.createElement(i.WrappedComponent,{wrappedType:"shortcutDialog",onDismiss:function(){e()}},null)})},t}(c.VssService);c.Services.add("ITfsShortcutService",{serviceFactory:o})}()},["Resources","HeaderActions","Constants","ErrorHandling","MyWorkFlyout","NavigationSettings","Page","Navigation","ProductFeatures","ProjectPersona","RestClient/Core","Search/GlobalSearchCoordinator","ShortcutService"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.platform-content"}}));